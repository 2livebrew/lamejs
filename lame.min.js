function lamejs(){function Y(b){return new Int32Array(b)}function L(b){return new Float32Array(b)}function ta(b){if(1==b.length)return L(b[0]);var k=b[0];b=b.slice(1);for(var r=[],E=0;E<k;E++)r.push(ta(b));return r}function fb(b){if(1==b.length)return Y(b[0]);var k=b[0];b=b.slice(1);for(var r=[],E=0;E<k;E++)r.push(fb(b));return r}function uc(b){if(1==b.length)return new Int16Array(b[0]);var k=b[0];b=b.slice(1);for(var r=[],E=0;E<k;E++)r.push(uc(b));return r}function ic(b){if(1==b.length)return Array(b[0]);
var k=b[0];b=b.slice(1);for(var r=[],E=0;E<k;E++)r.push(ic(b));return r}function la(b){this.ordinal=b}function H(b){this.ordinal=b}function oa(b){this.ordinal=function(){return b}}function Ec(){this.getLameVersion=function(){return"3.98.4"};this.getLameShortVersion=function(){return"3.98.4"};this.getLameVeryShortVersion=function(){return"LAME3.98r"};this.getPsyVersion=function(){return"0.93"};this.getLameUrl=function(){return"http://www.mp3dev.org/"};this.getLameOsBitness=function(){return"32bits"}}
function Fc(){function b(d,m,a,e,g,h,p,c,f,x,q,w,z,y,t){this.vbr_q=d;this.quant_comp=m;this.quant_comp_s=a;this.expY=e;this.st_lrm=g;this.st_s=h;this.masking_adj=p;this.masking_adj_short=c;this.ath_lower=f;this.ath_curve=x;this.ath_sensitivity=q;this.interch=w;this.safejoint=z;this.sfb21mod=y;this.msfix=t}function k(d,b,a,e,m,h,p,c,f,x,q,w,z,y){this.quant_comp=b;this.quant_comp_s=a;this.safejoint=e;this.nsmsfix=m;this.st_lrm=h;this.st_s=p;this.nsbass=c;this.scale=f;this.masking_adj=x;this.ath_lower=
q;this.ath_curve=w;this.interch=z;this.sfscale=y}function r(d,b,a){var e=d.VBR==H.vbr_rh?m:ua,g=d.VBR_q_frac,h=e[b],e=e[b+1];h.st_lrm+=g*(e.st_lrm-h.st_lrm);h.st_s+=g*(e.st_s-h.st_s);h.masking_adj+=g*(e.masking_adj-h.masking_adj);h.masking_adj_short+=g*(e.masking_adj_short-h.masking_adj_short);h.ath_lower+=g*(e.ath_lower-h.ath_lower);h.ath_curve+=g*(e.ath_curve-h.ath_curve);h.ath_sensitivity+=g*(e.ath_sensitivity-h.ath_sensitivity);h.interch+=g*(e.interch-h.interch);h.msfix+=g*(e.msfix-h.msfix);e=
h.vbr_q;0>e&&(e=0);9<e&&(e=9);d.VBR_q=e;d.VBR_q_frac=0;0!=a?d.quant_comp=h.quant_comp:0<Math.abs(d.quant_comp- -1)||(d.quant_comp=h.quant_comp);0!=a?d.quant_comp_short=h.quant_comp_s:0<Math.abs(d.quant_comp_short- -1)||(d.quant_comp_short=h.quant_comp_s);0!=h.expY&&(d.experimentalY=0!=h.expY);0!=a?d.internal_flags.nsPsy.attackthre=h.st_lrm:0<Math.abs(d.internal_flags.nsPsy.attackthre- -1)||(d.internal_flags.nsPsy.attackthre=h.st_lrm);0!=a?d.internal_flags.nsPsy.attackthre_s=h.st_s:0<Math.abs(d.internal_flags.nsPsy.attackthre_s-
-1)||(d.internal_flags.nsPsy.attackthre_s=h.st_s);0!=a?d.maskingadjust=h.masking_adj:0<Math.abs(d.maskingadjust-0)||(d.maskingadjust=h.masking_adj);0!=a?d.maskingadjust_short=h.masking_adj_short:0<Math.abs(d.maskingadjust_short-0)||(d.maskingadjust_short=h.masking_adj_short);0!=a?d.ATHlower=-h.ath_lower/10:0<Math.abs(10*-d.ATHlower-0)||(d.ATHlower=-h.ath_lower/10);0!=a?d.ATHcurve=h.ath_curve:0<Math.abs(d.ATHcurve- -1)||(d.ATHcurve=h.ath_curve);0!=a?d.athaa_sensitivity=h.ath_sensitivity:0<Math.abs(d.athaa_sensitivity-
-1)||(d.athaa_sensitivity=h.ath_sensitivity);0<h.interch&&(0!=a?d.interChRatio=h.interch:0<Math.abs(d.interChRatio- -1)||(d.interChRatio=h.interch));0<h.safejoint&&(d.exp_nspsytune|=h.safejoint);0<h.sfb21mod&&(d.exp_nspsytune|=h.sfb21mod<<20);0!=a?d.msfix=h.msfix:0<Math.abs(d.msfix- -1)||(d.msfix=h.msfix);0==a&&(d.VBR_q=b,d.VBR_q_frac=g)}function E(d,b,a){var e=A.nearestBitrateFullIndex(b);d.VBR=H.vbr_abr;d.VBR_mean_bitrate_kbps=b;d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,320);d.VBR_mean_bitrate_kbps=
Math.max(d.VBR_mean_bitrate_kbps,8);d.brate=d.VBR_mean_bitrate_kbps;320<d.VBR_mean_bitrate_kbps&&(d.disable_reservoir=!0);0<g[e].safejoint&&(d.exp_nspsytune|=2);0<g[e].sfscale&&(d.internal_flags.noise_shaping=2);if(0<Math.abs(g[e].nsbass)){var m=int(4*g[e].nsbass);0>m&&(m+=64);d.exp_nspsytune|=m<<2}0!=a?d.quant_comp=g[e].quant_comp:0<Math.abs(d.quant_comp- -1)||(d.quant_comp=g[e].quant_comp);0!=a?d.quant_comp_short=g[e].quant_comp_s:0<Math.abs(d.quant_comp_short- -1)||(d.quant_comp_short=g[e].quant_comp_s);
0!=a?d.msfix=g[e].nsmsfix:0<Math.abs(d.msfix- -1)||(d.msfix=g[e].nsmsfix);0!=a?d.internal_flags.nsPsy.attackthre=g[e].st_lrm:0<Math.abs(d.internal_flags.nsPsy.attackthre- -1)||(d.internal_flags.nsPsy.attackthre=g[e].st_lrm);0!=a?d.internal_flags.nsPsy.attackthre_s=g[e].st_s:0<Math.abs(d.internal_flags.nsPsy.attackthre_s- -1)||(d.internal_flags.nsPsy.attackthre_s=g[e].st_s);0!=a?d.scale=g[e].scale:0<Math.abs(d.scale- -1)||(d.scale=g[e].scale);0!=a?d.maskingadjust=g[e].masking_adj:0<Math.abs(d.maskingadjust-
0)||(d.maskingadjust=g[e].masking_adj);0<g[e].masking_adj?0!=a?d.maskingadjust_short=.9*g[e].masking_adj:0<Math.abs(d.maskingadjust_short-0)||(d.maskingadjust_short=.9*g[e].masking_adj):0!=a?d.maskingadjust_short=1.1*g[e].masking_adj:0<Math.abs(d.maskingadjust_short-0)||(d.maskingadjust_short=1.1*g[e].masking_adj);0!=a?d.ATHlower=-g[e].ath_lower/10:0<Math.abs(10*-d.ATHlower-0)||(d.ATHlower=-g[e].ath_lower/10);0!=a?d.ATHcurve=g[e].ath_curve:0<Math.abs(d.ATHcurve- -1)||(d.ATHcurve=g[e].ath_curve);0!=
a?d.interChRatio=g[e].interch:0<Math.abs(d.interChRatio- -1)||(d.interChRatio=g[e].interch);return b}var A;this.setModules=function(d){A=d};var m=[new b(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new b(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new b(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new b(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new b(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new b(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2E-4,0,0,1.95),new b(6,9,9,1,6.6,145,.67,.65,-14.7,
6.5,-19,4E-4,0,0,2.3),new b(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6E-4,0,0,2.7),new b(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7E-4,0,0,0),new b(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8E-4,0,0,0),new b(10,9,9,1,6.6,145,2,2,-36,12,-25,8E-4,0,0,0)],ua=[new b(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new b(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new b(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new b(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new b(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new b(5,
9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2E-4,0,0,1.95),new b(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4E-4,0,0,2),new b(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6E-4,0,0,2),new b(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7E-4,0,0,2),new b(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8E-4,0,0,2),new b(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8E-4,0,0,2)],g=[new k(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new k(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new k(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new k(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),
new k(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new k(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new k(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8E-4,1),new k(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8E-4,1),new k(80,9,9,0,0,6.6,145,0,.95,0,0,8,7E-4,1),new k(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6E-4,1),new k(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5E-4,1),new k(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2E-4,1),new k(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new k(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new k(224,9,9,1,1.25,5.2,
125,0,.98,-6,9,2,0,0),new k(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new k(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(d,b,a){switch(b){case W.R3MIX:b=W.V3;d.VBR=H.vbr_mtrh;break;case W.MEDIUM:b=W.V4;d.VBR=H.vbr_rh;break;case W.MEDIUM_FAST:b=W.V4;d.VBR=H.vbr_mtrh;break;case W.STANDARD:b=W.V2;d.VBR=H.vbr_rh;break;case W.STANDARD_FAST:b=W.V2;d.VBR=H.vbr_mtrh;break;case W.EXTREME:b=W.V0;d.VBR=H.vbr_rh;break;case W.EXTREME_FAST:b=W.V0;d.VBR=H.vbr_mtrh;break;case W.INSANE:return b=
320,d.preset=b,E(d,b,a),d.VBR=H.vbr_off,b}d.preset=b;switch(b){case W.V9:return r(d,9,a),b;case W.V8:return r(d,8,a),b;case W.V7:return r(d,7,a),b;case W.V6:return r(d,6,a),b;case W.V5:return r(d,5,a),b;case W.V4:return r(d,4,a),b;case W.V3:return r(d,3,a),b;case W.V2:return r(d,2,a),b;case W.V1:return r(d,1,a),b;case W.V0:return r(d,0,a),b}if(8<=b&&320>=b)return E(d,b,a);d.preset=0;return b}}function da(){function b(m,k,g,d,n,a){for(;0!=n--;)g[d]=1E-10+m[k+0]*a[0]-g[d-1]*a[1]+m[k-1]*a[2]-g[d-2]*
a[3]+m[k-2]*a[4]-g[d-3]*a[5]+m[k-3]*a[6]-g[d-4]*a[7]+m[k-4]*a[8]-g[d-5]*a[9]+m[k-5]*a[10]-g[d-6]*a[11]+m[k-6]*a[12]-g[d-7]*a[13]+m[k-7]*a[14]-g[d-8]*a[15]+m[k-8]*a[16]-g[d-9]*a[17]+m[k-9]*a[18]-g[d-10]*a[19]+m[k-10]*a[20],++d,++k}function k(b,k,g,d,n,a){for(;0!=n--;)g[d]=b[k+0]*a[0]-g[d-1]*a[1]+b[k-1]*a[2]-g[d-2]*a[3]+b[k-2]*a[4],++d,++k}function r(b){return b*b}var E=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9.291677959E-5,13.05504219327545,
-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,1.2025322027E-4,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,
-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,
-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-8.28086748E-6,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,
.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,
.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,
.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],A=[[.98621192462708,-1.97223372919527,-1.97242384925416,
.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,
.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(b,k){var g;a:{for(g=0;g<MAX_ORDER;g++)b.linprebuf[g]=b.lstepbuf[g]=b.loutbuf[g]=b.rinprebuf[g]=b.rstepbuf[g]=b.routbuf[g]=0;switch(0|k){case 48E3:b.reqindex=0;break;case 44100:b.reqindex=1;break;case 32E3:b.reqindex=2;break;case 24E3:b.reqindex=3;break;case 22050:b.reqindex=
4;break;case 16E3:b.reqindex=5;break;case 12E3:b.reqindex=6;break;case 11025:b.reqindex=7;break;case 8E3:b.reqindex=8;break;default:g=INIT_GAIN_ANALYSIS_ERROR;break a}b.sampleWindow=0|(1*k+20-1)/20;b.lsum=0;b.rsum=0;b.totsamp=0;Qa.ill(b.A,0);g=INIT_GAIN_ANALYSIS_OK}if(g!=INIT_GAIN_ANALYSIS_OK)return INIT_GAIN_ANALYSIS_ERROR;b.linpre=MAX_ORDER;b.rinpre=MAX_ORDER;b.lstep=MAX_ORDER;b.rstep=MAX_ORDER;b.lout=MAX_ORDER;b.rout=MAX_ORDER;Qa.fill(b.B,0);return INIT_GAIN_ANALYSIS_OK};this.AnalyzeSamples=function(m,
u,g,d,n,a,e){var J,h,p,c,f,x;if(0==a)return GAIN_ANALYSIS_OK;x=0;c=a;switch(e){case 1:d=u;n=g;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}a<MAX_ORDER?(K.arraycopy(u,g,m.linprebuf,MAX_ORDER,a),K.arraycopy(d,n,m.rinprebuf,MAX_ORDER,a)):(K.arraycopy(u,g,m.linprebuf,MAX_ORDER,MAX_ORDER),K.arraycopy(d,n,m.rinprebuf,MAX_ORDER,MAX_ORDER));for(;0<c;){f=c>m.sampleWindow-m.totsamp?m.sampleWindow-m.totsamp:c;x<MAX_ORDER?(e=m.linpre+x,J=m.linprebuf,h=m.rinpre+x,p=m.rinprebuf,f>MAX_ORDER-x&&(f=MAX_ORDER-
x)):(e=g+x,J=u,h=n+x,p=d);b(J,e,m.lstepbuf,m.lstep+m.totsamp,f,E[m.reqindex]);b(p,h,m.rstepbuf,m.rstep+m.totsamp,f,E[m.reqindex]);k(m.lstepbuf,m.lstep+m.totsamp,m.loutbuf,m.lout+m.totsamp,f,A[m.reqindex]);k(m.rstepbuf,m.rstep+m.totsamp,m.routbuf,m.rout+m.totsamp,f,A[m.reqindex]);e=m.lout+m.totsamp;J=m.loutbuf;h=m.rout+m.totsamp;p=m.routbuf;for(var q=f%8;0!=q--;)m.lsum+=r(J[e++]),m.rsum+=r(p[h++]);for(q=f/8;0!=q--;)m.lsum+=r(J[e+0])+r(J[e+1])+r(J[e+2])+r(J[e+3])+r(J[e+4])+r(J[e+5])+r(J[e+6])+r(J[e+
7]),e+=8,m.rsum+=r(p[h+0])+r(p[h+1])+r(p[h+2])+r(p[h+3])+r(p[h+4])+r(p[h+5])+r(p[h+6])+r(p[h+7]),h+=8;c-=f;x+=f;m.totsamp+=f;m.totsamp==m.sampleWindow&&(e=10*da.STEPS_per_dB*Math.log10((m.lsum+m.rsum)/m.totsamp*.5+1E-37),e=0>=e?0:0|e,e>=m.A.length&&(e=m.A.length-1),m.A[e]++,m.lsum=m.rsum=0,K.arraycopy(m.loutbuf,m.totsamp,m.loutbuf,0,MAX_ORDER),K.arraycopy(m.routbuf,m.totsamp,m.routbuf,0,MAX_ORDER),K.arraycopy(m.lstepbuf,m.totsamp,m.lstepbuf,0,MAX_ORDER),K.arraycopy(m.rstepbuf,m.totsamp,m.rstepbuf,
0,MAX_ORDER),m.totsamp=0);if(m.totsamp>m.sampleWindow)return GAIN_ANALYSIS_ERROR}a<MAX_ORDER?(K.arraycopy(m.linprebuf,a,m.linprebuf,0,MAX_ORDER-a),K.arraycopy(m.rinprebuf,a,m.rinprebuf,0,MAX_ORDER-a),K.arraycopy(u,g,m.linprebuf,MAX_ORDER-a,a),K.arraycopy(d,n,m.rinprebuf,MAX_ORDER-a,a)):(K.arraycopy(u,g+a-MAX_ORDER,m.linprebuf,0,MAX_ORDER),K.arraycopy(d,n+a-MAX_ORDER,m.rinprebuf,0,MAX_ORDER));return GAIN_ANALYSIS_OK};this.GetTitleGain=function(b){var k;k=b.A;var g=b.A.length,d,n=0;for(d=0;d<g;d++)n+=
k[d];if(0==n)k=GAIN_NOT_ENOUGH_SAMPLES;else{n=0|Math.ceil(n*(1-.95));for(d=g;0<d--&&!(0>=(n-=k[d])););k=64.82-d/da.STEPS_per_dB}for(g=0;g<b.A.length;g++)b.B[g]+=b.A[g],b.A[g]=0;for(g=0;g<MAX_ORDER;g++)b.linprebuf[g]=b.lstepbuf[g]=b.loutbuf[g]=b.rinprebuf[g]=b.rstepbuf[g]=b.routbuf[g]=0;b.totsamp=0;b.lsum=b.rsum=0;return k}}function ra(){function V(a,d,h){for(;0<h;){var b;0==q&&(q=8,x++,a.header[a.w_ptr].write_timing==f&&(b=a,K.arraycopy(b.header[b.w_ptr].buf,0,c,x,b.sideinfo_len),x+=b.sideinfo_len,
f+=8*b.sideinfo_len,b.w_ptr=b.w_ptr+1&ga.MAX_HEADER_BUF-1),c[x]=0);b=Math.min(h,q);h-=b;q-=b;c[x]|=d>>h<<q;f+=b}}function k(a,c){var d=a.internal_flags,b;8<=c&&(V(d,76,8),c-=8);8<=c&&(V(d,65,8),c-=8);8<=c&&(V(d,77,8),c-=8);8<=c&&(V(d,69,8),c-=8);if(32<=c){var l=h.getLameShortVersion();if(32<=c)for(b=0;b<l.length&&8<=c;++b)c-=8,V(d,l.charAt(b),8)}for(;1<=c;--c)V(d,d.ancillary_flag,1),d.ancillary_flag^=a.disable_reservoir?0:1}function r(a,c,d){for(var b=a.header[a.h_ptr].ptr;0<d;){var l=Math.min(d,
8-(b&7));d-=l;a.header[a.h_ptr].buf[b>>3]|=c>>d<<8-(b&7)-l;b+=l}a.header[a.h_ptr].ptr=b}function E(a,c){a<<=8;for(var d=0;8>d;d++)a<<=1,c<<=1,0!=((c^a)&65536)&&(c^=32773);return c}function A(a,c){var d=u.ht[c.count1table_select+32],b,l=0,h=c.big_values,f=c.big_values;for(b=(c.count1-c.big_values)/4;0<b;--b){var p=0,q=0,x;x=c.l3_enc[h+0];0!=x&&(q+=8,0>c.xr[f+0]&&p++);x=c.l3_enc[h+1];0!=x&&(q+=4,p*=2,0>c.xr[f+1]&&p++);x=c.l3_enc[h+2];0!=x&&(q+=2,p*=2,0>c.xr[f+2]&&p++);x=c.l3_enc[h+3];0!=x&&(q++,p*=
2,0>c.xr[f+3]&&p++);h+=4;f+=4;V(a,p+d.table[q],d.hlen[q]);l+=d.hlen[q]}return l}function m(a,c,d,b,l){var h=u.ht[c],f=0;if(0==c)return f;for(;d<b;d+=2){var p=0,q=0,x=h.xlen,e=h.xlen,g=0,F=l.l3_enc[d],I=l.l3_enc[d+1];0!=F&&(0>l.xr[d]&&g++,p--);15<c&&(14<F&&(g|=F-15<<1,q=x,F=15),14<I&&(e=I-15,g<<=x,g|=e,q+=x,I=15),e=16);0!=I&&(g<<=1,0>l.xr[d+1]&&g++,p--);F=F*e+I;q-=p;p+=h.hlen[F];V(a,h.table[F],p);V(a,g,q);f+=p+q}return f}function ua(a,c){var d=3*a.scalefac_band.s[3];d>c.big_values&&(d=c.big_values);
var b=m(a,c.table_select[0],0,d,c);return b+=m(a,c.table_select[1],d,c.big_values,c)}function g(a,c){var d,b,l,h;d=c.big_values;b=c.region0_count+1;l=a.scalefac_band.l[b];b+=c.region1_count+1;h=a.scalefac_band.l[b];l>d&&(l=d);h>d&&(h=d);b=m(a,c.table_select[0],0,l,c);b+=m(a,c.table_select[1],l,h,c);return b+=m(a,c.table_select[2],h,d,c)}function d(){this.total=0}function n(c,d){var b=c.internal_flags,h,l,p,q;q=b.w_ptr;p=b.h_ptr-1;-1==p&&(p=ga.MAX_HEADER_BUF-1);h=b.header[p].write_timing-f;d.total=
h;0<=h&&(l=1+p-q,p<q&&(l=1+p-q+ga.MAX_HEADER_BUF),h-=8*l*b.sideinfo_len);b=a.getframebits(c);h+=b;d.total+=b;d.total=0!=d.total%8?1+d.total/8:d.total/8;d.total+=x+1;0>h&&K.err.println("strange error flushing buffer ... \n");return h}var a=this,e=null,J=null,h=null,p=null;this.setModules=function(a,c,d,b){e=a;J=c;h=d;p=b};var c=null,f=0,x=0,q=0;this.getframebits=function(a){var c=a.internal_flags;return 8*(0|72E3*(a.version+1)*(0!=c.bitrate_index?u.bitrate_table[a.version][c.bitrate_index]:a.brate)/
a.out_samplerate+c.padding)};this.CRC_writeheader=function(a,c){var d;d=E(c[2]&255,65535);d=E(c[3]&255,d);for(var b=6;b<a.sideinfo_len;b++)d=E(c[b]&255,d);c[4]=byte(d>>8);c[5]=byte(d&255)};this.flush_bitstream=function(a){var c=a.internal_flags,b,h;b=c.l3_side;0>(h=n(a,new d))||(k(a,h),c.ResvSize=0,b.main_data_begin=0,c.findReplayGain&&(b=e.GetTitleGain(c.rgdata),c.RadioGain=Math.floor(10*b+.5)|0),c.findPeakSample&&(c.noclipGainChange=Math.ceil(200*Math.log10(c.PeakSample/32767))|0,0<c.noclipGainChange?
EQ(a.scale,1)||EQ(a.scale,0)?c.noclipScale=Math.floor(32767/c.PeakSample*100)/100:c.noclipScale=-1:c.noclipScale=-1))};this.add_dummy_byte=function(a,d,b){a=a.internal_flags;for(var h;0<b--;){h=d;for(var l=8;0<l;){var p;0==q&&(q=8,x++,c[x]=0);p=Math.min(l,q);l-=p;q-=p;c[x]|=h>>l<<q;f+=p}for(h=0;h<ga.MAX_HEADER_BUF;++h)a.header[h].write_timing+=8}};this.format_bitstream=function(a){var c=a.internal_flags,h;h=c.l3_side;var p=this.getframebits(a);k(a,h.resvDrain_pre);var l=a.internal_flags,q,v,x;q=l.l3_side;
l.header[l.h_ptr].ptr=0;Qa.fill(l.header[l.h_ptr].buf,0,l.sideinfo_len,0);16E3>a.out_samplerate?r(l,4094,12):r(l,4095,12);r(l,a.version,1);r(l,1,2);r(l,a.error_protection?0:1,1);r(l,l.bitrate_index,4);r(l,l.samplerate_index,2);r(l,l.padding,1);r(l,a.extension,1);r(l,a.mode.ordinal(),2);r(l,l.mode_ext,2);r(l,a.copyright,1);r(l,a.original,1);r(l,a.emphasis,2);a.error_protection&&r(l,0,16);if(1==a.version){r(l,q.main_data_begin,9);2==l.channels_out?r(l,q.private_bits,3):r(l,q.private_bits,5);for(x=0;x<
l.channels_out;x++)for(v=0;4>v;v++)r(l,q.scfsi[x][v],1);for(v=0;2>v;v++)for(x=0;x<l.channels_out;x++){var e=q.tt[v][x];r(l,e.part2_3_length+e.part2_length,12);r(l,e.big_values/2,9);r(l,e.global_gain,8);r(l,e.scalefac_compress,4);e.block_type!=b.NORM_TYPE?(r(l,1,1),r(l,e.block_type,2),r(l,e.mixed_block_flag,1),14==e.table_select[0]&&(e.table_select[0]=16),r(l,e.table_select[0],5),14==e.table_select[1]&&(e.table_select[1]=16),r(l,e.table_select[1],5),r(l,e.subblock_gain[0],3),r(l,e.subblock_gain[1],
3),r(l,e.subblock_gain[2],3)):(r(l,0,1),14==e.table_select[0]&&(e.table_select[0]=16),r(l,e.table_select[0],5),14==e.table_select[1]&&(e.table_select[1]=16),r(l,e.table_select[1],5),14==e.table_select[2]&&(e.table_select[2]=16),r(l,e.table_select[2],5),r(l,e.region0_count,4),r(l,e.region1_count,3));r(l,e.preflag,1);r(l,e.scalefac_scale,1);r(l,e.count1table_select,1)}}else for(r(l,q.main_data_begin,8),r(l,q.private_bits,l.channels_out),x=v=0;x<l.channels_out;x++)e=q.tt[v][x],r(l,e.part2_3_length+e.part2_length,
12),r(l,e.big_values/2,9),r(l,e.global_gain,8),r(l,e.scalefac_compress,9),e.block_type!=b.NORM_TYPE?(r(l,1,1),r(l,e.block_type,2),r(l,e.mixed_block_flag,1),14==e.table_select[0]&&(e.table_select[0]=16),r(l,e.table_select[0],5),14==e.table_select[1]&&(e.table_select[1]=16),r(l,e.table_select[1],5),r(l,e.subblock_gain[0],3),r(l,e.subblock_gain[1],3),r(l,e.subblock_gain[2],3)):(r(l,0,1),14==e.table_select[0]&&(e.table_select[0]=16),r(l,e.table_select[0],5),14==e.table_select[1]&&(e.table_select[1]=16),
r(l,e.table_select[1],5),14==e.table_select[2]&&(e.table_select[2]=16),r(l,e.table_select[2],5),r(l,e.region0_count,4),r(l,e.region1_count,3)),r(l,e.scalefac_scale,1),r(l,e.count1table_select,1);a.error_protection&&CRC_writeheader(l,l.header[l.h_ptr].buf);q=l.h_ptr;l.h_ptr=q+1&ga.MAX_HEADER_BUF-1;l.header[l.h_ptr].write_timing=l.header[q].write_timing+p;l.h_ptr==l.w_ptr&&K.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n");var l=8*c.sideinfo_len,m=0,N=a.internal_flags,D=N.l3_side;if(1==
a.version)for(q=0;2>q;q++)for(x=0;x<N.channels_out;x++){var F=D.tt[q][x],I=wb.slen1_tab[F.scalefac_compress],S=wb.slen2_tab[F.scalefac_compress];for(v=e=0;v<F.sfbdivide;v++)-1!=F.scalefac[v]&&(V(N,F.scalefac[v],I),e+=I);for(;v<F.sfbmax;v++)-1!=F.scalefac[v]&&(V(N,F.scalefac[v],S),e+=S);e=F.block_type==b.SHORT_TYPE?e+ua(N,F):e+g(N,F);e+=A(N,F);m+=e}else for(x=q=0;x<N.channels_out;x++){var F=D.tt[q][x],U=0,S=v=e=0;if(F.block_type==b.SHORT_TYPE){for(;4>S;S++)for(var J=F.sfb_partition_table[S]/3,ma=F.slen[S],
I=0;I<J;I++,v++)V(N,Math.max(F.scalefac[3*v+0],0),ma),V(N,Math.max(F.scalefac[3*v+1],0),ma),V(N,Math.max(F.scalefac[3*v+2],0),ma),U+=3*ma;e+=ua(N,F)}else{for(;4>S;S++)for(J=F.sfb_partition_table[S],ma=F.slen[S],I=0;I<J;I++,v++)V(N,Math.max(F.scalefac[v],0),ma),U+=ma;e+=g(N,F)}e+=A(N,F);m+=U+e}l+=m;k(a,h.resvDrain_post);l+=h.resvDrain_post;h.main_data_begin+=(p-l)/8;n(a,new d)!=c.ResvSize&&K.err.println("Internal buffer inconsistency. flushbits <> ResvSize");8*h.main_data_begin!=c.ResvSize&&(K.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",
8*h.main_data_begin,c.ResvSize,h.resvDrain_post,h.resvDrain_pre,8*c.sideinfo_len,l-h.resvDrain_post-8*c.sideinfo_len,l,l%8,p),K.err.println("This is a fatal error.  It has several possible causes:"),K.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),K.err.println(" 9%%  Your system is overclocked"),K.err.println(" 1%%  bug in LAME encoding library"),c.ResvSize=8*h.main_data_begin);if(1E9<f){for(a=0;a<ga.MAX_HEADER_BUF;++a)c.header[a].write_timing-=f;f=0}return 0};
this.copy_buffer=function(a,d,b,h,l){var f=x+1;if(0>=f)return 0;if(0!=h&&f>h)return-1;K.arraycopy(c,0,d,b,f);x=-1;q=0;if(0!=l&&(h=Y(1),h[0]=a.nMusicCRC,p.updateMusicCRC(h,d,b,f),a.nMusicCRC=h[0],0<f&&(a.VBR_seek_table.nBytesWritten+=f),a.decode_on_the_fly)){h=ta([2,1152]);l=f;for(var v=-1,g;0!=v;)if(v=J.hip_decode1_unclipped(a.hip,d,b,l,h[0],h[1]),l=0,-1==v&&(v=0),0<v){if(a.findPeakSample){for(g=0;g<v;g++)h[0][g]>a.PeakSample?a.PeakSample=h[0][g]:-h[0][g]>a.PeakSample&&(a.PeakSample=-h[0][g]);if(1<
a.channels_out)for(g=0;g<v;g++)h[1][g]>a.PeakSample?a.PeakSample=h[1][g]:-h[1][g]>a.PeakSample&&(a.PeakSample=-h[1][g])}if(a.findReplayGain&&e.AnalyzeSamples(a.rgdata,h[0],0,h[1],0,v,a.channels_out)==da.GAIN_ANALYSIS_ERROR)return-6}}return f};this.init_bit_stream_w=function(a){c=new Int8Array(W.LAME_MAXMP3BUFFER);a.h_ptr=a.w_ptr=0;a.header[a.h_ptr].write_timing=0;x=-1;f=q=0}}function Gc(){var b;this.setModules=function(k){b=k};this.ResvFrameBegin=function(k,r){var E=k.internal_flags,A,m=E.l3_side,
u=b.getframebits(k);r.bits=(u-8*E.sideinfo_len)/E.mode_gr;var g=2048*E.mode_gr-8;320<k.brate?A=8*int(1E3*k.brate/(k.out_samplerate/1152)/8+.5):(A=11520,k.strict_ISO&&(A=8*int(32E4/(k.out_samplerate/1152)/8+.5)));E.ResvMax=A-u;E.ResvMax>g&&(E.ResvMax=g);if(0>E.ResvMax||k.disable_reservoir)E.ResvMax=0;u=r.bits*E.mode_gr+Math.min(E.ResvSize,E.ResvMax);u>A&&(u=A);m.resvDrain_pre=0;null!=E.pinfo&&(E.pinfo.mean_bits=r.bits/2,E.pinfo.resvsize=E.ResvSize);return u};this.ResvMaxBits=function(b,r,V,A){var m=
b.internal_flags,u=m.ResvSize,g=m.ResvMax;0!=A&&(u+=r);0!=(m.substep_shaping&1)&&(g*=.9);V.bits=r;10*u>9*g?(A=u-9*g/10,V.bits+=A,m.substep_shaping|=128):(A=0,m.substep_shaping&=127,b.disable_reservoir||0!=(m.substep_shaping&1)||(V.bits-=.1*r));b=u<6*m.ResvMax/10?u:6*m.ResvMax/10;b-=A;0>b&&(b=0);return b};this.ResvAdjust=function(b,r){b.ResvSize-=r.part2_3_length+r.part2_length};this.ResvFrameEnd=function(b,r){var V,A=b.l3_side;b.ResvSize+=r*b.mode_gr;var m=0;A.resvDrain_post=0;A.resvDrain_pre=0;0!=
(V=b.ResvSize%8)&&(m+=V);V=b.ResvSize-m-b.ResvMax;0<V&&(m+=V);V=Math.min(8*A.main_data_begin,m)/8;A.resvDrain_pre+=8*V;m-=8*V;b.ResvSize-=8*V;A.main_data_begin-=V;A.resvDrain_post+=m;b.ResvSize-=m}}function ob(){function b(a,d){var c=a[d+0]&255,c=c<<8|a[d+1]&255,c=c<<8,c=c|a[d+2]&255,c=c<<8;return c|=a[d+3]&255}function k(a,b,c){a[b+0]=c>>24&255;a[b+1]=c>>16&255;a[b+2]=c>>8&255;a[b+3]=c&255}function r(a,b,c){a[b+0]=c>>8&255;a[b+1]=c&255}function E(a,b,c){return 255&(a<<b|c&~(-1<<b))}function A(a,
b){var c=a.internal_flags;b[0]=E(b[0],8,255);b[1]=E(b[1],3,7);b[1]=E(b[1],1,16E3>a.out_samplerate?0:1);b[1]=E(b[1],1,a.version);b[1]=E(b[1],2,1);b[1]=E(b[1],1,a.error_protection?0:1);b[2]=E(b[2],4,c.bitrate_index);b[2]=E(b[2],2,c.samplerate_index);b[2]=E(b[2],1,0);b[2]=E(b[2],1,a.extension);b[3]=E(b[3],2,a.mode.ordinal());b[3]=E(b[3],2,c.mode_ext);b[3]=E(b[3],1,a.copyright);b[3]=E(b[3],1,a.original);b[3]=E(b[3],2,a.emphasis);b[0]=255;var c=b[1]&241,d;d=1==a.version?128:16E3>a.out_samplerate?32:64;
a.VBR==H.vbr_off&&(d=a.brate);d=a.free_format?0:255&16*L.BitrateIndex(d,a.version,a.out_samplerate);b[1]=1==a.version?255&(c|10):255&(c|2);c=b[2]&13;b[2]=255&(d|c)}function m(a,b){return b=b>>8^J[(b^a)&255]}var L,g,d;this.setModules=function(a,b,c){L=a;g=b;d=c};var n=ob.NUMTOCENTRIES,a=ob.MAXFRAMESIZE,e=n+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,J=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,
2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8E3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16E3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,
59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32E3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,
38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(a){var b=a.internal_flags;var c=b.VBR_seek_table;a=u.bitrate_table[a.version][b.bitrate_index];c.nVbrNumFrames++;c.sum+=a;c.seen++;if(!(c.seen<c.want)&&(c.pos<
c.size&&(c.bag[c.pos]=c.sum,c.pos++,c.seen=0),c.pos==c.size)){for(a=1;a<c.size;a+=2)c.bag[a/2]=c.bag[a];c.want*=2;c.pos/=2}};this.getVbrTag=function(a){var d=new VBRTagData,c=0;d.flags=0;var f=a[c+1]>>3&1,e=a[c+2]>>2&3,q=a[c+3]>>6&3,w=a[c+2]>>4&15,w=u.bitrate_table[f][w];d.samprate=14==a[c+1]>>4?u.samplerate_table[2][e]:u.samplerate_table[f][e];e=c=0!=f?3!=q?c+36:c+21:3!=q?c+21:c+13;if(!(new String(a,e,4(),null)).equals("Xing")&&!(new String(a,e,4(),null)).equals("Info"))return null;c+=4;d.hId=f;
e=d.flags=b(a,c);c+=4;0!=(e&1)&&(d.frames=b(a,c),c+=4);0!=(e&2)&&(d.bytes=b(a,c),c+=4);if(0!=(e&4)){if(null!=d.toc)for(q=0;q<n;q++)d.toc[q]=a[c+q];c+=n}d.vbrScale=-1;0!=(e&8)&&(d.vbrScale=b(a,c),c+=4);d.headersize=72E3*(f+1)*w/d.samprate;c+=21;f=a[c+0]<<4;f+=a[c+1]>>4;w=(a[c+1]&15)<<8;w+=a[c+2]&255;if(0>f||3E3<f)f=-1;if(0>w||3E3<w)w=-1;d.encDelay=f;d.encPadding=w;return d};this.InitVbrTag=function(b){var d=b.internal_flags,c;c=1==b.version?128:16E3>b.out_samplerate?32:64;b.VBR==H.vbr_off&&(c=b.brate);
c=72E3*(b.version+1)*c/b.out_samplerate;var f=d.sideinfo_len+e;d.VBR_seek_table.TotalFrameSize=c;if(c<f||c>a)b.bWriteVbrTag=!1;else for(d.VBR_seek_table.nVbrNumFrames=0,d.VBR_seek_table.nBytesWritten=0,d.VBR_seek_table.sum=0,d.VBR_seek_table.seen=0,d.VBR_seek_table.want=1,d.VBR_seek_table.pos=0,null==d.VBR_seek_table.bag&&(d.VBR_seek_table.bag=new int[400],d.VBR_seek_table.size=400),c=new Int8Array(a),A(b,c),d=d.VBR_seek_table.TotalFrameSize,f=0;f<d;++f)g.add_dummy_byte(b,c[f]&255,1)};this.updateMusicCRC=
function(a,b,c,d){for(var e=0;e<d;++e)a[0]=m(b[c+e],a[0])};this.getLameTagFrame=function(a,b){var c=a.internal_flags;if(!a.bWriteVbrTag||c.Class_ID!=W.LAME_ID||0>=c.VBR_seek_table.pos)return 0;if(b.length<c.VBR_seek_table.TotalFrameSize)return c.VBR_seek_table.TotalFrameSize;Qa.fill(b,0,c.VBR_seek_table.TotalFrameSize,0);A(a,b);var f=new Int8Array(n);if(a.free_format)for(var e=1;e<n;++e)f[e]=255&255*e/100;else{var q=c.VBR_seek_table;if(!(0>=q.pos))for(e=1;e<n;++e){var w=0|Math.floor(e/n*q.pos);w>
q.pos-1&&(w=q.pos-1);w=0|256*q.bag[w]/q.sum;255<w&&(w=255);f[e]=255&w}}w=c.sideinfo_len;a.error_protection&&(w-=2);b[w++]=0;b[w++]=0;b[w++]=0;b[w++]=0;k(b,w,15);w+=4;k(b,w,c.VBR_seek_table.nVbrNumFrames);w+=4;q=c.VBR_seek_table.nBytesWritten+c.VBR_seek_table.TotalFrameSize;k(b,w,0|q);w+=4;K.arraycopy(f,0,b,w,f.length);w+=f.length;a.error_protection&&g.CRC_writeheader(c,b);for(var z=0,e=0;e<w;e++)z=m(b[e],z);var f=w,e=z,y=a.internal_flags,w=0,z=a.encoder_delay,t=a.encoder_padding,l=100-10*a.VBR_q-
a.quality,C=d.getLameVeryShortVersion(),v;v=[1,5,3,2,4,0,3];var aa=0|(255<a.lowpassfreq/100+.5?255:a.lowpassfreq/100+.5),G=0,B=0,N=a.internal_flags.noise_shaping,D=0,F=0,I=0,S=0,D=0,D=0!=(a.exp_nspsytune&1),I=0!=(a.exp_nspsytune&2),U=!1,J=!1,ma=a.internal_flags.nogap_total,V=a.internal_flags.nogap_current,S=a.ATHtype,u=0,E;switch(a.VBR){case vbr_abr:E=a.VBR_mean_bitrate_kbps;break;case vbr_off:E=a.brate;break;default:E=a.VBR_min_bitrate_kbps}v=0+(a.VBR.ordinal()<v.length?v[a.VBR.ordinal()]:0);y.findReplayGain&&
(510<y.RadioGain&&(y.RadioGain=510),-510>y.RadioGain&&(y.RadioGain=-510),B=11264,B=0<=y.RadioGain?B|y.RadioGain:B|512|-y.RadioGain);y.findPeakSample&&(G=Math.abs(0|y.PeakSample/32767*Math.pow(2,23)+.5));-1!=ma&&(0<V&&(J=!0),V<ma-1&&(U=!0));u=S+((D?1:0)<<4)+((I?1:0)<<5)+((U?1:0)<<6)+((J?1:0)<<7);0>l&&(l=0);switch(a.mode){case MONO:D=0;break;case STEREO:D=1;break;case DUAL_CHANNEL:D=2;break;case JOINT_STEREO:D=a.force_ms?4:3;break;default:D=7}I=32E3>=a.in_samplerate?0:48E3==a.in_samplerate?2:48E3<a.in_samplerate?
3:1;if(a.short_blocks==la.short_block_forced||a.short_blocks==la.short_block_dispensed||-1==a.lowpassfreq&&-1==a.highpassfreq||a.scale_left<a.scale_right||a.scale_left>a.scale_right||a.disable_reservoir&&320>a.brate||a.noATH||a.ATHonly||0==S||32E3>=a.in_samplerate)F=1;S=N+(D<<2)+(F<<5)+(I<<6);D=y.nMusicCRC;k(b,f+w,l);w+=4;for(y=0;9>y;y++)b[f+w+y]=255&C.charAt(y);w+=9;b[f+w]=255&v;w++;b[f+w]=255&aa;w++;k(b,f+w,G);w+=4;r(b,f+w,B);w+=2;r(b,f+w,0);w+=2;b[f+w]=255&u;w++;b[f+w]=255<=E?255:255&E;w++;b[f+
w]=255&z>>4;b[f+w+1]=255&(z<<4)+(t>>8);b[f+w+2]=255&t;w+=3;b[f+w]=255&S;w++;b[f+w++]=0;r(b,f+w,a.preset);w+=2;k(b,f+w,q);w+=4;r(b,f+w,D);w+=2;for(q=0;q<w;q++)e=m(b[f+q],e);r(b,f+w,e);return c.VBR_seek_table.TotalFrameSize};this.putVbrTag=function(b,d){if(0>=b.internal_flags.VBR_seek_table.pos)return-1;d.seek(d.length());if(0==d.length())return-1;d.seek(0);var c=new Int8Array(10);d.readFully(c);c=(new String(c,"ISO-8859-1")).startsWith("ID3")?0:((c[6]&127)<<21|(c[7]&127)<<14|(c[8]&127)<<7|c[9]&127)+
c.length;d.seek(c);var c=new Int8Array(a),f=getLameTagFrame(b,c);if(f>c.length)return-1;if(1>f)return 0;d.write(c,0,f);return 0}}function cb(b){this.bits=b}function Gb(){this.bits=this.over_SSD=this.over_count=this.max_noise=this.tot_noise=this.over_noise=0}function Hc(){this.setModules=function(b,k){}}function T(b,k,r,u){this.xlen=b;this.linmax=k;this.table=r;this.hlen=u}function wb(){function V(a){this.bits=0|a}function k(a,c,b,d,f,e){c=.5946/c;for(a>>=1;0!=a--;)f[e++]=c>b[d++]?0:1,f[e++]=c>b[d++]?
0:1}function r(a,c,b,d,f,e){a>>=1;var l=a%2;for(a>>=1;0!=a--;){var h,v,g,p,n,k,r;h=b[d++]*c;v=b[d++]*c;n=0|h;g=b[d++]*c;k=0|v;p=b[d++]*c;r=0|g;h+=m.adj43[n];n=0|p;v+=m.adj43[k];f[e++]=0|h;g+=m.adj43[r];f[e++]=0|v;p+=m.adj43[n];f[e++]=0|g;f[e++]=0|p}0!=l&&(h=b[d++]*c,v=b[d++]*c,h+=m.adj43[0|h],v+=m.adj43[0|v],f[e++]=0|h,f[e++]=0|v)}function E(a,c,b,d){var f,e=c,l=f=0;do{var h=a[e++],v=a[e++];f<h&&(f=h);l<v&&(l=v)}while(e<b);f<l&&(f=l);switch(f){case 0:return f;case 1:e=c;c=0;f=u.ht[1].hlen;do l=2*
a[e+0]+a[e+1],e+=2,c+=f[l];while(e<b);d.bits+=c;return 1;case 2:case 3:e=c;c=g[f-1];f=0;l=u.ht[c].xlen;h=2==c?u.table23:u.table56;do v=a[e+0]*l+a[e+1],e+=2,f+=h[v];while(e<b);a=f&65535;f>>=16;f>a&&(f=a,c++);d.bits+=f;return c;case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:e=c;c=g[f-1];var h=l=f=0,v=u.ht[c].xlen,p=u.ht[c].hlen,m=u.ht[c+1].hlen,n=u.ht[c+2].hlen;do{var k=a[e+0]*v+a[e+1],e=e+2;f+=p[k];l+=m[k];h+=n[k]}while(e<b);a=c;f>l&&(f=l,a++);f>h&&(f=h,a=
c+2);d.bits+=f;return a;default:if(f>pa.IXMAX_VAL)return d.bits=pa.LARGE_BITS,-1;f-=15;for(e=24;32>e&&!(u.ht[e].linmax>=f);e++);for(l=e-8;24>l&&!(u.ht[l].linmax>=f);l++);f=l;h=65536*u.ht[f].xlen+u.ht[e].xlen;l=0;do v=a[c++],p=a[c++],0!=v&&(14<v&&(v=15,l+=h),v*=16),0!=p&&(14<p&&(p=15,l+=h),v+=p),l+=u.largetbl[v];while(c<b);a=l&65535;l>>=16;l>a&&(l=a,f=e);d.bits+=l;return f}}function A(a,c,d,f,e,h,l,g){for(var v=c.big_values,p=2;p<b.SBMAX_l+1;p++){var m=a.scalefac_band.l[p];if(m>=v)break;var n=e[p-
2]+c.count1bits;if(d.part2_3_length<=n)break;n=new V(n);m=E(f,m,v,n);n=n.bits;d.part2_3_length<=n||(d.assign(c),d.part2_3_length=n,d.region0_count=h[p-2],d.region1_count=p-2-h[p-2],d.table_select[0]=l[p-2],d.table_select[1]=g[p-2],d.table_select[2]=m)}}var m=null;this.qupvt=null;this.setModules=function(a){m=this.qupvt=a};var L=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],g=[1,2,5,7,7,10,10,13,13,13,13,
13,13,13,13];this.noquant_count_bits=function(a,c,d){var f=c.l3_enc,e=Math.min(576,c.max_nonzero_coeff+2>>1<<1);null!=d&&(d.sfb_count1=0);for(;1<e&&0==(f[e-1]|f[e-2]);e-=2);c.count1=e;for(var h=0,l=0;3<e;e-=4){var p;if(1<((f[e-1]|f[e-2]|f[e-3]|f[e-4])&2147483647))break;p=2*(2*(2*f[e-4]+f[e-3])+f[e-2])+f[e-1];h+=u.t32l[p];l+=u.t33l[p]}p=h;c.count1table_select=0;h>l&&(p=l,c.count1table_select=1);c.count1bits=p;c.big_values=e;if(0==e)return p;c.block_type==b.SHORT_TYPE?(h=3*a.scalefac_band.s[3],h>c.big_values&&
(h=c.big_values),l=c.big_values):c.block_type==b.NORM_TYPE?(h=c.region0_count=a.bv_scf[e-2],l=c.region1_count=a.bv_scf[e-1],l=a.scalefac_band.l[h+l+2],h=a.scalefac_band.l[h+1],l<e&&(p=new V(p),c.table_select[2]=E(f,l,e,p),p=p.bits)):(c.region0_count=7,c.region1_count=b.SBMAX_l-1-7-1,h=a.scalefac_band.l[8],l=e,h>l&&(h=l));h=Math.min(h,e);l=Math.min(l,e);0<h&&(p=new V(p),c.table_select[0]=E(f,0,h,p),p=p.bits);h<l&&(p=new V(p),c.table_select[1]=E(f,h,l,p),p=p.bits);2==a.use_best_huffman&&(c.part2_3_length=
p,best_huffman_divide(a,c),p=c.part2_3_length);if(null!=d&&c.block_type==b.NORM_TYPE){for(f=0;a.scalefac_band.l[f]<c.big_values;)f++;d.sfb_count1=f}return p};this.count_bits=function(a,c,d,f){var e=d.l3_enc,h=pa.IXMAX_VAL/m.IPOW20(d.global_gain);if(d.xrpow_max>h)return pa.LARGE_BITS;var h=m.IPOW20(d.global_gain),l,p,v=0,g,n=0,B=0,J=0,D=0,F=e,I=0,S=c,U=0;g=null!=f&&d.global_gain==f.global_gain;p=d.block_type==b.SHORT_TYPE?38:21;for(l=0;l<=p;l++){var V=-1;if(g||d.block_type==b.NORM_TYPE)V=d.global_gain-
(d.scalefac[l]+(0!=d.preflag?m.pretab[l]:0)<<d.scalefac_scale+1)-8*d.subblock_gain[d.window[l]];if(g&&f.step[l]==V)0!=n&&(r(n,h,S,U,F,I),n=0),0!=B&&(k(B,h,S,U,F,I),B=0);else{var ma=d.width[l];v+d.width[l]>d.max_nonzero_coeff&&(l=d.max_nonzero_coeff-v+1,Qa.fill(e,d.max_nonzero_coeff,576,0),ma=l,0>ma&&(ma=0),l=p+1);0==n&&0==B&&(F=e,I=D,S=c,U=J);null!=f&&0<f.sfb_count1&&l>=f.sfb_count1&&0<f.step[l]&&V>=f.step[l]?(0!=n&&(r(n,h,S,U,F,I),n=0,F=e,I=D,S=c,U=J),B+=ma):(0!=B&&(k(B,h,S,U,F,I),B=0,F=e,I=D,S=
c,U=J),n+=ma);if(0>=ma){0!=B&&(k(B,h,S,U,F,I),B=0);0!=n&&(r(n,h,S,U,F,I),n=0);break}}l<=p&&(D+=d.width[l],J+=d.width[l],v+=d.width[l])}0!=n&&r(n,h,S,U,F,I);0!=B&&k(B,h,S,U,F,I);if(0!=(a.substep_shaping&2))for(h=0,p=.634521682242439/m.IPOW20(d.global_gain+d.scalefac_scale),v=0;v<d.sfbmax;v++)if(g=d.width[v],0==a.pseudohalf[v])h+=g;else for(n=h,h+=g;n<h;++n)e[n]=c[n]>=p?e[n]:0;return this.noquant_count_bits(a,d,f)};this.best_huffman_divide=function(a,c){var d=new jc,f=c.l3_enc,e=Y(23),h=Y(23),l=Y(23),
p=Y(23);if(c.block_type!=b.SHORT_TYPE||1!=a.mode_gr){d.assign(c);if(c.block_type==b.NORM_TYPE){for(var v=c.big_values,g=0;22>=g;g++)e[g]=pa.LARGE_BITS;for(g=0;16>g;g++){var n=a.scalefac_band.l[g+1];if(n>=v)break;for(var m=0,k=new V(m),r=E(f,0,n,k),m=k.bits,F=0;8>F;F++){var I=a.scalefac_band.l[g+F+2];if(I>=v)break;k=m;k=new V(k);I=E(f,n,I,k);k=k.bits;e[g+F]>k&&(e[g+F]=k,h[g+F]=g,l[g+F]=r,p[g+F]=I)}}A(a,d,c,f,e,h,l,p)}v=d.big_values;if(!(0==v||1<(f[v-2]|f[v-1])||(v=c.count1+2,576<v))){d.assign(c);d.count1=
v;for(n=g=0;v>d.big_values;v-=4)m=2*(2*(2*f[v-4]+f[v-3])+f[v-2])+f[v-1],g+=u.t32l[m],n+=u.t33l[m];d.big_values=v;d.count1table_select=0;g>n&&(g=n,d.count1table_select=1);d.count1bits=g;d.block_type==b.NORM_TYPE?A(a,d,c,f,e,h,l,p):(d.part2_3_length=g,g=a.scalefac_band.l[8],g>v&&(g=v),0<g&&(e=new V(d.part2_3_length),d.table_select[0]=E(f,0,g,e),d.part2_3_length=e.bits),v>g&&(e=new V(d.part2_3_length),d.table_select[1]=E(f,g,v,e),d.part2_3_length=e.bits),c.part2_3_length>d.part2_3_length&&c.assign(d))}}};
var d=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],n=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],a=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],e=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];wb.slen1_tab=a;wb.slen2_tab=e;this.best_scalefac_store=function(c,f,h,p){var g=p.tt[f][h],t,l,C,v=0;for(t=l=0;t<g.sfbmax;t++){C=g.width[t];l+=C;for(C=-C;0>C&&0==g.l3_enc[C+l];C++);0==C&&(g.scalefac[t]=v=-2)}if(0==g.scalefac_scale&&0==g.preflag){for(t=l=0;t<g.sfbmax;t++)0<g.scalefac[t]&&(l|=g.scalefac[t]);if(0==(l&1)&&0!=l){for(t=0;t<g.sfbmax;t++)0<g.scalefac[t]&&
(g.scalefac[t]>>=1);g.scalefac_scale=v=1}}if(0==g.preflag&&g.block_type!=b.SHORT_TYPE&&2==c.mode_gr){for(t=11;t<b.SBPSY_l&&!(g.scalefac[t]<m.pretab[t]&&-2!=g.scalefac[t]);t++);if(t==b.SBPSY_l){for(t=11;t<b.SBPSY_l;t++)0<g.scalefac[t]&&(g.scalefac[t]-=m.pretab[t]);g.preflag=v=1}}for(t=0;4>t;t++)p.scfsi[h][t]=0;if(2==c.mode_gr&&1==f&&p.tt[0][h].block_type!=b.SHORT_TYPE&&p.tt[1][h].block_type!=b.SHORT_TYPE){f=p.tt[1][h];l=p.tt[0][h];for(v=0;v<u.scfsi_band.length-1;v++){for(t=u.scfsi_band[v];t<u.scfsi_band[v+
1]&&!(l.scalefac[t]!=f.scalefac[t]&&0<=f.scalefac[t]);t++);if(t==u.scfsi_band[v+1]){for(t=u.scfsi_band[v];t<u.scfsi_band[v+1];t++)f.scalefac[t]=-1;p.scfsi[h][v]=1}}for(t=p=h=0;11>t;t++)-1!=f.scalefac[t]&&(p++,h<f.scalefac[t]&&(h=f.scalefac[t]));for(C=l=0;t<b.SBPSY_l;t++)-1!=f.scalefac[t]&&(C++,l<f.scalefac[t]&&(l=f.scalefac[t]));for(v=0;16>v;v++)h<d[v]&&l<n[v]&&(t=a[v]*p+e[v]*C,f.part2_length>t&&(f.part2_length=t,f.scalefac_compress=v));v=0}for(t=0;t<g.sfbmax;t++)-2==g.scalefac[t]&&(g.scalefac[t]=
0);0!=v&&(2==c.mode_gr?this.scale_bitcount(g):this.scale_bitcount_lsf(c,g))};var J=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],h=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],p=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(a){var c,f=0,e=0,g,t=a.scalefac;if(a.block_type==b.SHORT_TYPE)g=J,0!=a.mixed_block_flag&&(g=h);else if(g=p,0==a.preflag){for(c=11;c<b.SBPSY_l&&!(t[c]<m.pretab[c]);c++);if(c==b.SBPSY_l)for(a.preflag=1,c=11;c<b.SBPSY_l;c++)t[c]-=m.pretab[c]}for(c=
0;c<a.sfbdivide;c++)f<t[c]&&(f=t[c]);for(;c<a.sfbmax;c++)e<t[c]&&(e=t[c]);a.part2_length=pa.LARGE_BITS;for(c=0;16>c;c++)f<d[c]&&e<n[c]&&a.part2_length>g[c]&&(a.part2_length=g[c],a.scalefac_compress=c);return a.part2_length==pa.LARGE_BITS};var c=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(a,d){var e,h,g,p,l,n,v,k=Y(4),r=d.scalefac;e=0!=d.preflag?2:0;for(n=0;4>n;n++)k[n]=0;if(d.block_type==b.SHORT_TYPE){h=1;var J=m.nr_of_sfb_block[e][h];for(g=
v=0;4>g;g++)for(p=J[g]/3,n=0;n<p;n++,v++)for(l=0;3>l;l++)r[3*v+l]>k[g]&&(k[g]=r[3*v+l])}else for(h=0,J=m.nr_of_sfb_block[e][h],g=v=0;4>g;g++)for(p=J[g],n=0;n<p;n++,v++)r[v]>k[g]&&(k[g]=r[v]);p=!1;for(g=0;4>g;g++)k[g]>c[e][g]&&(p=!0);if(!p){d.sfb_partition_table=m.nr_of_sfb_block[e][h];for(g=0;4>g;g++)d.slen[g]=f[k[g]];h=d.slen[0];g=d.slen[1];k=d.slen[2];l=d.slen[3];switch(e){case 0:d.scalefac_compress=(5*h+g<<4)+(k<<2)+l;break;case 1:d.scalefac_compress=400+(5*h+g<<2)+k;break;case 2:d.scalefac_compress=
500+3*h+g;break;default:K.err.printf("intensity stereo not implemented yet\n")}}if(!p)for(g=d.part2_length=0;4>g;g++)d.part2_length+=d.slen[g]*d.sfb_partition_table[g];return p};var f=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(a){for(var c=2;576>=c;c+=2){for(var d=0,b;a.scalefac_band.l[++d]<c;);for(b=L[d][0];a.scalefac_band.l[b+1]>c;)b--;0>b&&(b=L[d][0]);a.bv_scf[c-2]=b;for(b=L[d][1];a.scalefac_band.l[b+a.bv_scf[c-2]+2]>c;)b--;0>b&&(b=L[d][1]);a.bv_scf[c-1]=b}}}function Fa(V,k,r,
u){this.l=Y(1+b.SBMAX_l);this.s=Y(1+b.SBMAX_s);this.psfb21=Y(1+b.PSFB21);this.psfb12=Y(1+b.PSFB12);var A=this.l,m=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],K.arraycopy(this.arrL,0,A,0,Math.min(this.arrL.length,this.l.length)),K.arraycopy(this.arrS,0,m,0,Math.min(this.arrS.length,this.s.length)),K.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),K.arraycopy(this.arr12,0,this.psfb12,
0,Math.min(this.arr12.length,this.psfb12.length)))}function Ic(){this.sfb_count1=this.global_gain=0;this.step=Y(39);this.noise=L(39);this.noise_log=L(39)}function jc(){this.xr=L(576);this.l3_enc=Y(576);this.scalefac=Y(Ca.SFBMAX);this.mixed_block_flag=this.block_type=this.scalefac_compress=this.global_gain=this.count1=this.big_values=this.part2_3_length=this.xrpow_max=0;this.table_select=Y(3);this.subblock_gain=Y(4);this.sfbdivide=this.psymax=this.sfbmax=this.psy_lmax=this.sfb_smin=this.sfb_lmax=this.part2_length=
this.count1table_select=this.scalefac_scale=this.preflag=this.region1_count=this.region0_count=0;this.width=Y(Ca.SFBMAX);this.window=Y(Ca.SFBMAX);this.count1bits=0;this.sfb_partition_table=null;this.slen=Y(4);this.max_nonzero_coeff=0;var b=this;this.assign=function(k){b.xr=new Float32Array(k.xr);b.l3_enc=new Int32Array(k.l3_enc);b.scalefac=new Int32Array(k.scalefac);b.xrpow_max=k.xrpow_max;b.part2_3_length=k.part2_3_length;b.big_values=k.big_values;b.count1=k.count1;b.global_gain=k.global_gain;b.scalefac_compress=
k.scalefac_compress;b.block_type=k.block_type;b.mixed_block_flag=k.mixed_block_flag;b.table_select=new Int32Array(k.table_select);b.subblock_gain=new Int32Array(k.subblock_gain);b.region0_count=k.region0_count;b.region1_count=k.region1_count;b.preflag=k.preflag;b.scalefac_scale=k.scalefac_scale;b.count1table_select=k.count1table_select;b.part2_length=k.part2_length;b.sfb_lmax=k.sfb_lmax;b.sfb_smin=k.sfb_smin;b.psy_lmax=k.psy_lmax;b.sfbmax=k.sfbmax;b.psymax=k.psymax;b.sfbdivide=k.sfbdivide;b.width=
new Int32Array(k.width);b.window=new Int32Array(k.window);b.count1bits=k.count1bits;b.sfb_partition_table=k.sfb_partition_table.slice(0);b.slen=new Int32Array(k.slen);b.max_nonzero_coeff=k.max_nonzero_coeff}}function Jc(){function u(b){this.ordinal=b}function k(b){for(var d=0;d<b.sfbmax;d++)if(0==b.scalefac[d]+b.subblock_gain[b.window[d]])return!1;return!0}var r;this.rv=null;var E;this.qupvt=null;var A,m=new Hc,ua;this.setModules=function(b,d,n,a){r=b;this.rv=E=d;this.qupvt=A=n;ua=a;m.setModules(A,
ua)};this.ms_convert=function(b,d){for(var n=0;576>n;++n){var a=b.tt[d][0].xr[n],e=b.tt[d][1].xr[n];b.tt[d][0].xr[n]=.5*(a+e)*X.SQRT2;b.tt[d][1].xr[n]=.5*(a-e)*X.SQRT2}};this.init_xrpow=function(b,d,n){var a=0,e=0|d.max_nonzero_coeff;d.xrpow_max=0;Qa.fill(n,e,576,0);for(var m=a=0;m<=e;++m){var h=Math.abs(d.xr[m]),a=a+h;n[m]=Math.sqrt(h*Math.sqrt(h));n[m]>d.xrpow_max&&(d.xrpow_max=n[m])}if(1E-20<a){n=0;0!=(b.substep_shaping&2)&&(n=1);for(e=0;e<d.psymax;e++)b.pseudohalf[e]=n;return!0}Qa.fill(d.l3_enc,
0,576,0);return!1};this.init_outer_loop=function(g,d){d.part2_3_length=0;d.big_values=0;d.count1=0;d.global_gain=210;d.scalefac_compress=0;d.table_select[0]=0;d.table_select[1]=0;d.table_select[2]=0;d.subblock_gain[0]=0;d.subblock_gain[1]=0;d.subblock_gain[2]=0;d.subblock_gain[3]=0;d.region0_count=0;d.region1_count=0;d.preflag=0;d.scalefac_scale=0;d.count1table_select=0;d.part2_length=0;d.sfb_lmax=b.SBPSY_l;d.sfb_smin=b.SBPSY_s;d.psy_lmax=g.sfb21_extra?b.SBMAX_l:b.SBPSY_l;d.psymax=d.psy_lmax;d.sfbmax=
d.sfb_lmax;d.sfbdivide=11;for(var n=0;n<b.SBMAX_l;n++)d.width[n]=g.scalefac_band.l[n+1]-g.scalefac_band.l[n],d.window[n]=3;if(d.block_type==b.SHORT_TYPE){var a=L(576);d.sfb_smin=0;d.sfb_lmax=0;0!=d.mixed_block_flag&&(d.sfb_smin=3,d.sfb_lmax=2*g.mode_gr+4);d.psymax=d.sfb_lmax+3*((g.sfb21_extra?b.SBMAX_s:b.SBPSY_s)-d.sfb_smin);d.sfbmax=d.sfb_lmax+3*(b.SBPSY_s-d.sfb_smin);d.sfbdivide=d.sfbmax-18;d.psy_lmax=d.sfb_lmax;var e=g.scalefac_band.l[d.sfb_lmax];K.arraycopy(d.xr,0,a,0,576);for(n=d.sfb_smin;n<
b.SBMAX_s;n++)for(var m=g.scalefac_band.s[n],h=g.scalefac_band.s[n+1],p=0;3>p;p++)for(var c=m;c<h;c++)d.xr[e++]=a[3*c+p];a=d.sfb_lmax;for(n=d.sfb_smin;n<b.SBMAX_s;n++)d.width[a]=d.width[a+1]=d.width[a+2]=g.scalefac_band.s[n+1]-g.scalefac_band.s[n],d.window[a]=0,d.window[a+1]=1,d.window[a+2]=2,a+=3}d.count1bits=0;d.sfb_partition_table=A.nr_of_sfb_block[0][0];d.slen[0]=0;d.slen[1]=0;d.slen[2]=0;d.slen[3]=0;d.max_nonzero_coeff=575;Qa.fill(d.scalefac,0);n=g.ATH;a=d.xr;if(d.block_type!=b.SHORT_TYPE)for(e=
!1,m=b.PSFB21-1;0<=m&&!e;m--)for(h=g.scalefac_band.psfb21[m],p=g.scalefac_band.psfb21[m+1],c=A.athAdjust(n.adjust,n.psfb21[m],n.floor),1E-12<g.nsPsy.longfact[21]&&(c*=g.nsPsy.longfact[21]),--p;p>=h;p--)if(Math.abs(a[p])<c)a[p]=0;else{e=!0;break}else for(c=0;3>c;c++)for(e=!1,m=b.PSFB12-1;0<=m&&!e;m--){var h=3*g.scalefac_band.s[12]+(g.scalefac_band.s[13]-g.scalefac_band.s[12])*c+(g.scalefac_band.psfb12[m]-g.scalefac_band.psfb12[0]),p=h+(g.scalefac_band.psfb12[m+1]-g.scalefac_band.psfb12[m]),f=A.athAdjust(n.adjust,
n.psfb12[m],n.floor);1E-12<g.nsPsy.shortfact[12]&&(f*=g.nsPsy.shortfact[12]);for(--p;p>=h;p--)if(Math.abs(a[p])<f)a[p]=0;else{e=!0;break}}};u.BINSEARCH_NONE=new u(0);u.BINSEARCH_UP=new u(1);u.BINSEARCH_DOWN=new u(2);this.trancate_smallspectrums=function(g,d,m,a){var e=L(Ca.SFBMAX);if((0!=(g.substep_shaping&4)||d.block_type!=b.SHORT_TYPE)&&0==(g.substep_shaping&128)){A.calc_noise(d,m,e,new Gb,null);for(var k=0;576>k;k++){var h=0;0!=d.l3_enc[k]&&(h=Math.abs(d.xr[k]));a[k]=h}k=0;h=8;d.block_type==b.SHORT_TYPE&&
(h=6);do{var p,c,f,x,q=d.width[h],k=k+q;if(!(1<=e[h]||(Qa.sort(a,k-q,q),ra.EQ(a[k-1],0)))){p=(1-e[h])*m[h];x=c=0;do{var w;for(f=1;x+f<q&&!ra.NEQ(a[x+k-q],a[x+k+f-q]);f++);w=a[x+k-q]*a[x+k-q]*f;if(p<w){0!=x&&(c=a[x+k-q-1]);break}p-=w;x+=f}while(x<q);if(!ra.EQ(c,0)){do Math.abs(d.xr[k-q])<=c&&(d.l3_enc[k-q]=0);while(0<--q)}}}while(++h<d.psymax);d.part2_3_length=ua.noquant_count_bits(g,d,null)}};this.outer_loop=function(g,d,m,a,e,r){var h=g.internal_flags,p=new jc,c=L(576),f=L(Ca.SFBMAX),x=new Gb,q,
w=new Ic,z=9999999,y=!1,t=!1,l=0,C,v,aa=h.CurrentStep[e],G=!1,B=h.OldValue[e];q=u.BINSEARCH_NONE;d.global_gain=B;for(C=r-d.part2_length;;){v=ua.count_bits(h,a,d,null);if(1==aa||v==C)break;v>C?(q==u.BINSEARCH_DOWN&&(G=!0),G&&(aa/=2),q=u.BINSEARCH_UP,v=aa):(q==u.BINSEARCH_UP&&(G=!0),G&&(aa/=2),q=u.BINSEARCH_DOWN,v=-aa);d.global_gain+=v;0>d.global_gain&&(d.global_gain=0,G=!0);255<d.global_gain&&(d.global_gain=255,G=!0)}for(;v>C&&255>d.global_gain;)d.global_gain++,v=ua.count_bits(h,a,d,null);h.CurrentStep[e]=
4<=B-d.global_gain?4:2;h.OldValue[e]=d.global_gain;d.part2_3_length=v;if(0==h.noise_shaping)return 100;A.calc_noise(d,m,f,x,w);x.bits=d.part2_3_length;p.assign(d);e=0;for(K.arraycopy(a,0,c,0,576);!y;){do{C=new Gb;G=255;aa=0!=(h.substep_shaping&2)?20:3;if(h.sfb21_extra){if(1<f[p.sfbmax])break;if(p.block_type==b.SHORT_TYPE&&(1<f[p.sfbmax+1]||1<f[p.sfbmax+2]))break}B=p;v=a;q=g.internal_flags;for(var N=B,D=f,F=v,I=g.internal_flags,S=void 0,S=0==N.scalefac_scale?1.2968395546510096:1.6817928305074292,U=
0,ya=0;ya<N.sfbmax;ya++)U<D[ya]&&(U=D[ya]);ya=I.noise_shaping_amp;3==ya&&(ya=t?2:1);switch(ya){case 2:break;case 1:U=1<U?Math.pow(U,.5):.95*U;break;default:U=1<U?1:.95*U}for(var ma=0,ya=0;ya<N.sfbmax;ya++){var Ea=N.width[ya],ma=ma+Ea;if(!(D[ya]<U)){if(0!=(I.substep_shaping&2)&&(I.pseudohalf[ya]=0==I.pseudohalf[ya]?1:0,0==I.pseudohalf[ya]&&2==I.noise_shaping_amp))break;N.scalefac[ya]++;for(Ea=-Ea;0>Ea;Ea++)F[ma+Ea]*=S,F[ma+Ea]>N.xrpow_max&&(N.xrpow_max=F[ma+Ea]);if(2==I.noise_shaping_amp)break}}if(N=
k(B))B=!1;else if(N=2==q.mode_gr?ua.scale_bitcount(B):ua.scale_bitcount_lsf(q,B)){if(1<q.noise_shaping)if(Qa.fill(q.pseudohalf,0),0==B.scalefac_scale){N=B;for(F=D=0;F<N.sfbmax;F++){S=N.width[F];I=N.scalefac[F];0!=N.preflag&&(I+=A.pretab[F]);D+=S;if(0!=(I&1))for(I++,S=-S;0>S;S++)v[D+S]*=1.2968395546510096,v[D+S]>N.xrpow_max&&(N.xrpow_max=v[D+S]);N.scalefac[F]=I>>1}N.preflag=0;N.scalefac_scale=1;N=!1}else if(B.block_type==b.SHORT_TYPE&&0<q.subblock_gain){b:{N=q;D=B;F=void 0;I=D.scalefac;for(F=0;F<D.sfb_lmax;F++)if(16<=
I[F]){v=!0;break b}for(S=0;3>S;S++){ya=U=0;for(F=D.sfb_lmax+S;F<D.sfbdivide;F+=3)U<I[F]&&(U=I[F]);for(;F<D.sfbmax;F+=3)ya<I[F]&&(ya=I[F]);if(!(16>U&&8>ya)){if(7<=D.subblock_gain[S]){v=!0;break b}D.subblock_gain[S]++;U=N.scalefac_band.l[D.sfb_lmax];for(F=D.sfb_lmax+S;F<D.sfbmax;F+=3)if(ya=D.width[F],ma=I[F],ma-=4>>D.scalefac_scale,0<=ma)I[F]=ma,U+=3*ya;else{I[F]=0;ma=A.IPOW20(210+(ma<<D.scalefac_scale+1));U+=ya*(S+1);for(Ea=-ya;0>Ea;Ea++)v[U+Ea]*=ma,v[U+Ea]>D.xrpow_max&&(D.xrpow_max=v[U+Ea]);U+=ya*
(3-S-1)}ma=A.IPOW20(202);U+=D.width[F]*(S+1);for(Ea=-D.width[F];0>Ea;Ea++)v[U+Ea]*=ma,v[U+Ea]>D.xrpow_max&&(D.xrpow_max=v[U+Ea])}}v=!1}N=v||k(B)}N||(N=2==q.mode_gr?ua.scale_bitcount(B):ua.scale_bitcount_lsf(q,B));B=!N}else B=!0;if(!B)break;0!=p.scalefac_scale&&(G=254);B=r-p.part2_length;if(0>=B)break;for(;(p.part2_3_length=ua.count_bits(h,a,p,w))>B&&p.global_gain<=G;)p.global_gain++;if(p.global_gain>G)break;if(0==x.over_count){for(;(p.part2_3_length=ua.count_bits(h,a,p,w))>z&&p.global_gain<=G;)p.global_gain++;
if(p.global_gain>G)break}A.calc_noise(p,m,f,C,w);C.bits=p.part2_3_length;q=d.block_type!=b.SHORT_TYPE?g.quant_comp:g.quant_comp_short;G=x;B=C;N=p;v=f;D=void 0;switch(q){default:case 9:0<G.over_count?(D=B.over_SSD<=G.over_SSD,B.over_SSD==G.over_SSD&&(D=B.bits<G.bits)):D=0>B.max_noise&&10*B.max_noise+B.bits<=10*G.max_noise+G.bits;break;case 0:D=B.over_count<G.over_count||B.over_count==G.over_count&&B.over_noise<G.over_noise||B.over_count==G.over_count&&ra.EQ(B.over_noise,G.over_noise)&&B.tot_noise<
G.tot_noise;break;case 8:q=B;F=1E-37;for(D=0;D<N.psymax;D++)I=v[D],I=X.FAST_LOG10(.368+.632*I*I*I),F+=I;v=Math.max(1E-20,F);q.max_noise=v;case 1:D=B.max_noise<G.max_noise;break;case 2:D=B.tot_noise<G.tot_noise;break;case 3:D=B.tot_noise<G.tot_noise&&B.max_noise<G.max_noise;break;case 4:D=0>=B.max_noise&&.2<G.max_noise||0>=B.max_noise&&0>G.max_noise&&G.max_noise>B.max_noise-.2&&B.tot_noise<G.tot_noise||0>=B.max_noise&&0<G.max_noise&&G.max_noise>B.max_noise-.2&&B.tot_noise<G.tot_noise+G.over_noise||
0<B.max_noise&&-.05<G.max_noise&&G.max_noise>B.max_noise-.1&&B.tot_noise+B.over_noise<G.tot_noise+G.over_noise||0<B.max_noise&&-.1<G.max_noise&&G.max_noise>B.max_noise-.15&&B.tot_noise+B.over_noise+B.over_noise<G.tot_noise+G.over_noise+G.over_noise;break;case 5:D=B.over_noise<G.over_noise||ra.EQ(B.over_noise,G.over_noise)&&B.tot_noise<G.tot_noise;break;case 6:D=B.over_noise<G.over_noise||ra.EQ(B.over_noise,G.over_noise)&&(B.max_noise<G.max_noise||ra.EQ(B.max_noise,G.max_noise)&&B.tot_noise<=G.tot_noise);
break;case 7:D=B.over_count<G.over_count||B.over_noise<G.over_noise}0==G.over_count&&(D=D&&B.bits<G.bits);q=D?1:0;if(0!=q)z=d.part2_3_length,x=C,d.assign(p),e=0,K.arraycopy(a,0,c,0,576);else if(0==h.full_outer_loop){if(++e>aa&&0==x.over_count)break;if(3==h.noise_shaping_amp&&t&&30<e)break;if(3==h.noise_shaping_amp&&t&&15<p.global_gain-l)break}}while(255>p.global_gain+p.scalefac_scale);3==h.noise_shaping_amp?t?y=!0:(p.assign(d),K.arraycopy(c,0,a,0,576),e=0,l=p.global_gain,t=!0):y=!0}g.VBR==H.vbr_rh||
g.VBR==H.vbr_mtrh?K.arraycopy(c,0,a,0,576):0!=(h.substep_shaping&1)&&trancate_smallspectrums(h,d,m,a);return x.over_count};this.iteration_finish_one=function(b,d,m){var a=b.l3_side,e=a.tt[d][m];ua.best_scalefac_store(b,d,m,a);1==b.use_best_huffman&&ua.best_huffman_divide(b,e);E.ResvAdjust(b,e)};this.VBR_encode_granule=function(b,d,m,a,e,k,h){var p=b.internal_flags,c=new jc,f=L(576),x=h,q=h+1,q=(h+k)/2,w,z=0,y=p.sfb21_extra;Qa.fill(c.l3_enc,0);do p.sfb21_extra=q>x-42?!1:y,w=outer_loop(b,d,m,a,e,q),
0>=w?(z=1,q=d.part2_3_length,c.assign(d),K.arraycopy(a,0,f,0,576),h=q-32,w=h-k,q=(h+k)/2):(k=q+32,w=h-k,q=(h+k)/2,0!=z&&(z=2,d.assign(c),K.arraycopy(f,0,a,0,576)));while(12<w);p.sfb21_extra=y;2==z&&K.arraycopy(c.l3_enc,0,d.l3_enc,0,576)};this.get_framebits=function(b,d){var m=b.internal_flags;m.bitrate_index=m.VBR_min_bitrate;var a=r.getframebits(b);m.bitrate_index=1;for(var a=r.getframebits(b),e=1;e<=m.VBR_max_bitrate;e++)m.bitrate_index=e,a=new cb(a),d[e]=E.ResvFrameBegin(b,a),a=a.bits};this.VBR_old_prepare=
function(g,d,m,a,e,k,h,p,c){var f=g.internal_flags,x;x=0;var q=1,w=0;f.bitrate_index=f.VBR_max_bitrate;var z=E.ResvFrameBegin(g,new cb(0))/f.mode_gr;get_framebits(g,k);for(var y=0;y<f.mode_gr;y++){var t=A.on_pe(g,d,p[y],z,y,0);f.mode_ext==b.MPG_MD_MS_LR&&(ms_convert(f.l3_side,y),A.reduce_side(p[y],m[y],z,t));for(t=0;t<f.channels_out;++t){var l=f.l3_side.tt[y][t];l.block_type!=b.SHORT_TYPE?(x=1.28/(1+Math.exp(3.5-d[y][t]/300))-.05,x=f.PSY.mask_adjust-x):(x=2.56/(1+Math.exp(3.5-d[y][t]/300))-.14,x=
f.PSY.mask_adjust_short-x);f.masking_lower=Math.pow(10,.1*x);init_outer_loop(f,l);c[y][t]=A.calc_xmin(g,a[y][t],l,e[y][t]);0!=c[y][t]&&(q=0);h[y][t]=126;w+=p[y][t]}}for(y=0;y<f.mode_gr;y++)for(t=0;t<f.channels_out;t++)w>k[f.VBR_max_bitrate]&&(p[y][t]*=k[f.VBR_max_bitrate],p[y][t]/=w),h[y][t]>p[y][t]&&(h[y][t]=p[y][t]);return q};this.bitpressure_strategy=function(g,d,m,a){for(var e=0;e<g.mode_gr;e++)for(var k=0;k<g.channels_out;k++){for(var h=g.l3_side.tt[e][k],p=d[e][k],c=0,f=0;f<h.psy_lmax;f++)p[c++]*=
1+.029*f*f/b.SBMAX_l/b.SBMAX_l;if(h.block_type==b.SHORT_TYPE)for(f=h.sfb_smin;f<b.SBMAX_s;f++)p[c++]*=1+.029*f*f/b.SBMAX_s/b.SBMAX_s,p[c++]*=1+.029*f*f/b.SBMAX_s/b.SBMAX_s,p[c++]*=1+.029*f*f/b.SBMAX_s/b.SBMAX_s;a[e][k]=0|Math.max(m[e][k],.9*a[e][k])}};this.VBR_new_prepare=function(g,d,m,a,e,k){var h=g.internal_flags,p=1,c=0,f=0,x;g.free_format?(h.bitrate_index=0,c=new cb(c),x=E.ResvFrameBegin(g,c),c=c.bits,e[0]=x):(h.bitrate_index=h.VBR_max_bitrate,c=new cb(c),E.ResvFrameBegin(g,c),c=c.bits,get_framebits(g,
e),x=e[h.VBR_max_bitrate]);for(e=0;e<h.mode_gr;e++){A.on_pe(g,d,k[e],c,e,0);h.mode_ext==b.MPG_MD_MS_LR&&ms_convert(h.l3_side,e);for(var q=0;q<h.channels_out;++q){var w=h.l3_side.tt[e][q];h.masking_lower=Math.pow(10,.1*h.PSY.mask_adjust);init_outer_loop(h,w);0!=A.calc_xmin(g,m[e][q],w,a[e][q])&&(p=0);f+=k[e][q]}}for(e=0;e<h.mode_gr;e++)for(q=0;q<h.channels_out;q++)f>x&&(k[e][q]*=x,k[e][q]/=f);return p};this.calc_target_bits=function(g,d,m,a,e,k){var h=g.internal_flags,p=h.l3_side,c,f;h.bitrate_index=
h.VBR_max_bitrate;f=new cb(0);k[0]=E.ResvFrameBegin(g,f);h.bitrate_index=1;f=r.getframebits(g)-8*h.sideinfo_len;e[0]=f/(h.mode_gr*h.channels_out);f=g.VBR_mean_bitrate_kbps*g.framesize*1E3;0!=(h.substep_shaping&1)&&(f*=1.09);f/=g.out_samplerate;f-=8*h.sideinfo_len;f/=h.mode_gr*h.channels_out;c=.93+.07*(11-g.compression_ratio)/5.5;.9>c&&(c=.9);1<c&&(c=1);for(g=0;g<h.mode_gr;g++){var x=0;for(e=0;e<h.channels_out;e++){a[g][e]=int(c*f);if(700<d[g][e]){var q=int((d[g][e]-700)/1.4),w=p.tt[g][e];a[g][e]=
int(c*f);w.block_type==b.SHORT_TYPE&&q<f/2&&(q=f/2);q>3*f/2?q=3*f/2:0>q&&(q=0);a[g][e]+=q}a[g][e]>ga.MAX_BITS_PER_CHANNEL&&(a[g][e]=ga.MAX_BITS_PER_CHANNEL);x+=a[g][e]}if(x>ga.MAX_BITS_PER_GRANULE)for(e=0;e<h.channels_out;++e)a[g][e]*=ga.MAX_BITS_PER_GRANULE,a[g][e]/=x}if(h.mode_ext==b.MPG_MD_MS_LR)for(g=0;g<h.mode_gr;g++)A.reduce_side(a[g],m[g],f*h.channels_out,ga.MAX_BITS_PER_GRANULE);for(g=d=0;g<h.mode_gr;g++)for(e=0;e<h.channels_out;e++)a[g][e]>ga.MAX_BITS_PER_CHANNEL&&(a[g][e]=ga.MAX_BITS_PER_CHANNEL),
d+=a[g][e];if(d>k[0])for(g=0;g<h.mode_gr;g++)for(e=0;e<h.channels_out;e++)a[g][e]*=k[0],a[g][e]/=d}}function Kc(){this.scale_right=this.scale_left=this.scale=this.out_samplerate=this.in_samplerate=this.num_channels=this.num_samples=this.class_id=0;this.decode_only=this.bWriteVbrTag=this.analysis=!1;this.quality=0;this.mode=oa.STEREO;this.write_id3tag_automatic=this.decode_on_the_fly=this.findReplayGain=this.free_format=this.force_ms=!1;this.error_protection=this.emphasis=this.extension=this.original=
this.copyright=this.compression_ratio=this.brate=0;this.disable_reservoir=this.strict_ISO=!1;this.quant_comp_short=this.quant_comp=0;this.experimentalY=!1;this.preset=this.exp_nspsytune=this.experimentalZ=0;this.VBR=null;this.maskingadjust_short=this.maskingadjust=this.highpasswidth=this.lowpasswidth=this.highpassfreq=this.lowpassfreq=this.VBR_hard_min=this.VBR_max_bitrate_kbps=this.VBR_min_bitrate_kbps=this.VBR_mean_bitrate_kbps=this.VBR_q=this.VBR_q_frac=0;this.noATH=this.ATHshort=this.ATHonly=
!1;this.athaa_sensitivity=this.athaa_loudapprox=this.athaa_type=this.ATHlower=this.ATHcurve=this.ATHtype=0;this.short_blocks=null;this.useTemporal=!1;this.msfix=this.interChRatio=0;this.tune=!1;this.lame_allocated_gfp=this.frameNum=this.framesize=this.encoder_padding=this.encoder_delay=this.version=this.tune_value_a=0;this.internal_flags=null}function Lc(){this.linprebuf=L(2*da.MAX_ORDER);this.linpre=0;this.lstepbuf=L(da.MAX_SAMPLES_PER_WINDOW+da.MAX_ORDER);this.lstep=0;this.loutbuf=L(da.MAX_SAMPLES_PER_WINDOW+
da.MAX_ORDER);this.lout=0;this.rinprebuf=L(2*da.MAX_ORDER);this.rinpre=0;this.rstepbuf=L(da.MAX_SAMPLES_PER_WINDOW+da.MAX_ORDER);this.rstep=0;this.routbuf=L(da.MAX_SAMPLES_PER_WINDOW+da.MAX_ORDER);this.first=this.freqindex=this.rsum=this.lsum=this.totsamp=this.sampleWindow=this.rout=0;this.A=Y(0|da.STEPS_per_dB*da.MAX_dB);this.B=Y(0|da.STEPS_per_dB*da.MAX_dB)}function Mc(){this.floor=this.decay=this.adjustLimit=this.adjust=this.aaSensitivityP=this.useAdjust=0;this.l=L(b.SBMAX_l);this.s=L(b.SBMAX_s);
this.psfb21=L(b.PSFB21);this.psfb12=L(b.PSFB12);this.cb_l=L(b.CBANDS);this.cb_s=L(b.CBANDS);this.eql_w=L(b.BLKSIZE/2)}function Nc(u){this.quantize=u;this.iteration_loop=function(k,r,u,A){var m=k.internal_flags,V=L(Ca.SFBMAX),g=L(576),d=Y(2),n,a,e=m.l3_side;n=new cb(0);this.quantize.rv.ResvFrameBegin(k,n);n=n.bits;for(var J=0;J<m.mode_gr;J++)for(a=this.quantize.qupvt.on_pe(k,r,d,n,J,J),m.mode_ext==b.MPG_MD_MS_LR&&(this.quantize.ms_convert(m.l3_side,J),this.quantize.qupvt.reduce_side(d,u[J],n,a)),a=
0;a<m.channels_out;a++){var h,p=e.tt[J][a];p.block_type!=b.SHORT_TYPE?(h=0,h=m.PSY.mask_adjust-h):(h=0,h=m.PSY.mask_adjust_short-h);m.masking_lower=Math.pow(10,.1*h);this.quantize.init_outer_loop(m,p);this.quantize.init_xrpow(m,p,g)&&(this.quantize.qupvt.calc_xmin(k,A[J][a],p,V),this.quantize.outer_loop(k,p,V,g,a,d[a]));this.quantize.iteration_finish_one(m,J,a)}this.quantize.rv.ResvFrameEnd(m,n)}}function gb(){this.thm=new Hb;this.en=new Hb}function Oc(){function u(b,g,a){for(var e=10,m=g+238-14-
286,h=-15;0>h;h++){var p,c,f;p=k[e+-10];c=b[m+-224]*p;f=b[g+224]*p;p=k[e+-9];c+=b[m+-160]*p;f+=b[g+160]*p;p=k[e+-8];c+=b[m+-96]*p;f+=b[g+96]*p;p=k[e+-7];c+=b[m+-32]*p;f+=b[g+32]*p;p=k[e+-6];c+=b[m+32]*p;f+=b[g+-32]*p;p=k[e+-5];c+=b[m+96]*p;f+=b[g+-96]*p;p=k[e+-4];c+=b[m+160]*p;f+=b[g+-160]*p;p=k[e+-3];c+=b[m+224]*p;f+=b[g+-224]*p;p=k[e+-2];c+=b[g+-256]*p;f-=b[m+256]*p;p=k[e+-1];c+=b[g+-192]*p;f-=b[m+192]*p;p=k[e+0];c+=b[g+-128]*p;f-=b[m+128]*p;p=k[e+1];c+=b[g+-64]*p;f-=b[m+64]*p;p=k[e+2];c+=b[g+0]*
p;f-=b[m+0]*p;p=k[e+3];c+=b[g+64]*p;f-=b[m+-64]*p;p=k[e+4];c+=b[g+128]*p;f-=b[m+-128]*p;p=k[e+5];c+=b[g+192]*p;f-=b[m+-192]*p;c*=k[e+6];p=f-c;a[30+2*h]=f+c;a[31+2*h]=k[e+7]*p;e+=18;g--;m++}f=b[g+-16]*k[e+-10];c=b[g+-32]*k[e+-2];f+=(b[g+-48]-b[g+16])*k[e+-9];c+=b[g+-96]*k[e+-1];f+=(b[g+-80]+b[g+48])*k[e+-8];c+=b[g+-160]*k[e+0];f+=(b[g+-112]-b[g+80])*k[e+-7];c+=b[g+-224]*k[e+1];f+=(b[g+-144]+b[g+112])*k[e+-6];c-=b[g+32]*k[e+2];f+=(b[g+-176]-b[g+144])*k[e+-5];c-=b[g+96]*k[e+3];f+=(b[g+-208]+b[g+176])*
k[e+-4];c-=b[g+160]*k[e+4];f+=(b[g+-240]-b[g+208])*k[e+-3];c-=b[g+224];b=c-f;g=c+f;f=a[14];c=a[15]-f;a[31]=g+f;a[30]=b+c;a[15]=b-c;a[14]=g-f;c=a[28]-a[0];a[0]+=a[28];a[28]=c*k[e+-36+7];c=a[29]-a[1];a[1]+=a[29];a[29]=c*k[e+-36+7];c=a[26]-a[2];a[2]+=a[26];a[26]=c*k[e+-72+7];c=a[27]-a[3];a[3]+=a[27];a[27]=c*k[e+-72+7];c=a[24]-a[4];a[4]+=a[24];a[24]=c*k[e+-108+7];c=a[25]-a[5];a[5]+=a[25];a[25]=c*k[e+-108+7];c=a[22]-a[6];a[6]+=a[22];a[22]=c*X.SQRT2;c=a[23]-a[7];a[7]+=a[23];a[23]=c*X.SQRT2-a[7];a[7]-=a[6];
a[22]-=a[7];a[23]-=a[22];c=a[6];a[6]=a[31]-c;a[31]+=c;c=a[7];a[7]=a[30]-c;a[30]+=c;c=a[22];a[22]=a[15]-c;a[15]+=c;c=a[23];a[23]=a[14]-c;a[14]+=c;c=a[20]-a[8];a[8]+=a[20];a[20]=c*k[e+-180+7];c=a[21]-a[9];a[9]+=a[21];a[21]=c*k[e+-180+7];c=a[18]-a[10];a[10]+=a[18];a[18]=c*k[e+-216+7];c=a[19]-a[11];a[11]+=a[19];a[19]=c*k[e+-216+7];c=a[16]-a[12];a[12]+=a[16];a[16]=c*k[e+-252+7];c=a[17]-a[13];a[13]+=a[17];a[17]=c*k[e+-252+7];c=-a[20]+a[24];a[20]+=a[24];a[24]=c*k[e+-216+7];c=-a[21]+a[25];a[21]+=a[25];a[25]=
c*k[e+-216+7];c=a[4]-a[8];a[4]+=a[8];a[8]=c*k[e+-216+7];c=a[5]-a[9];a[5]+=a[9];a[9]=c*k[e+-216+7];c=a[0]-a[12];a[0]+=a[12];a[12]=c*k[e+-72+7];c=a[1]-a[13];a[1]+=a[13];a[13]=c*k[e+-72+7];c=a[16]-a[28];a[16]+=a[28];a[28]=c*k[e+-72+7];c=-a[17]+a[29];a[17]+=a[29];a[29]=c*k[e+-72+7];c=X.SQRT2*(a[2]-a[10]);a[2]+=a[10];a[10]=c;c=X.SQRT2*(a[3]-a[11]);a[3]+=a[11];a[11]=c;c=X.SQRT2*(-a[18]+a[26]);a[18]+=a[26];a[26]=c-a[18];c=X.SQRT2*(-a[19]+a[27]);a[19]+=a[27];a[27]=c-a[19];c=a[2];a[19]-=a[3];a[3]-=c;a[2]=
a[31]-c;a[31]+=c;c=a[3];a[11]-=a[19];a[18]-=c;a[3]=a[30]-c;a[30]+=c;c=a[18];a[27]-=a[11];a[19]-=c;a[18]=a[15]-c;a[15]+=c;c=a[19];a[10]-=c;a[19]=a[14]-c;a[14]+=c;c=a[10];a[11]-=c;a[10]=a[23]-c;a[23]+=c;c=a[11];a[26]-=c;a[11]=a[22]-c;a[22]+=c;c=a[26];a[27]-=c;a[26]=a[7]-c;a[7]+=c;c=a[27];a[27]=a[6]-c;a[6]+=c;c=X.SQRT2*(a[0]-a[4]);a[0]+=a[4];a[4]=c;c=X.SQRT2*(a[1]-a[5]);a[1]+=a[5];a[5]=c;c=X.SQRT2*(a[16]-a[20]);a[16]+=a[20];a[20]=c;c=X.SQRT2*(a[17]-a[21]);a[17]+=a[21];a[21]=c;c=-X.SQRT2*(a[8]-a[12]);
a[8]+=a[12];a[12]=c-a[8];c=-X.SQRT2*(a[9]-a[13]);a[9]+=a[13];a[13]=c-a[9];c=-X.SQRT2*(a[25]-a[29]);a[25]+=a[29];a[29]=c-a[25];c=-X.SQRT2*(a[24]+a[28]);a[24]-=a[28];a[28]=c-a[24];c=a[24]-a[16];a[24]=c;c=a[20]-c;a[20]=c;c=a[28]-c;a[28]=c;c=a[25]-a[17];a[25]=c;c=a[21]-c;a[21]=c;c=a[29]-c;a[29]=c;c=a[17]-a[1];a[17]=c;c=a[9]-c;a[9]=c;c=a[25]-c;a[25]=c;c=a[5]-c;a[5]=c;c=a[21]-c;a[21]=c;c=a[13]-c;a[13]=c;c=a[29]-c;a[29]=c;c=a[1]-a[0];a[1]=c;c=a[16]-c;a[16]=c;c=a[17]-c;a[17]=c;c=a[8]-c;a[8]=c;c=a[9]-c;a[9]=
c;c=a[24]-c;a[24]=c;c=a[25]-c;a[25]=c;c=a[4]-c;a[4]=c;c=a[5]-c;a[5]=c;c=a[20]-c;a[20]=c;c=a[21]-c;a[21]=c;c=a[12]-c;a[12]=c;c=a[13]-c;a[13]=c;c=a[28]-c;a[28]=c;c=a[29]-c;a[29]=c;c=a[0];a[0]+=a[31];a[31]-=c;c=a[1];a[1]+=a[30];a[30]-=c;c=a[16];a[16]+=a[15];a[15]-=c;c=a[17];a[17]+=a[14];a[14]-=c;c=a[8];a[8]+=a[23];a[23]-=c;c=a[9];a[9]+=a[22];a[22]-=c;c=a[24];a[24]+=a[7];a[7]-=c;c=a[25];a[25]+=a[6];a[6]-=c;c=a[4];a[4]+=a[27];a[27]-=c;c=a[5];a[5]+=a[26];a[26]-=c;c=a[20];a[20]+=a[11];a[11]-=c;c=a[21];a[21]+=
a[10];a[10]-=c;c=a[12];a[12]+=a[19];a[19]-=c;c=a[13];a[13]+=a[18];a[18]-=c;c=a[28];a[28]+=a[3];a[3]-=c;c=a[29];a[29]+=a[2];a[2]-=c}var k=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,
301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,
-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,
503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,
-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,
12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,
-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,
-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,
-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,
-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,
-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.0178904535*X.SQRT2/2.384E-6,.008938074*X.SQRT2/2.384E-6,.0015673635*X.SQRT2/2.384E-6,.001228571*X.SQRT2/2.384E-6,4.856585E-4*X.SQRT2/2.384E-6,1.09434E-4*X.SQRT2/2.384E-6,5.0783E-5*X.SQRT2/2.384E-6,6.914E-6*X.SQRT2/2.384E-6,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],r=[[2.382191739347913E-13,6.423305872147834E-13,
9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.40084909404969E-13,6.423305872147839E-13,2.382191739347918E-13,5.456116108943412E-12,4.878985199565852E-12,4.240448995017367E-12,3.559909094758252E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558783E-12,8.371015190102974E-13,2.599706096327376E-13,-5.456116108943412E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758252E-12,-2.858043359288076E-12,-2.156177623817898E-12,-1.475637723558783E-12,
-8.371015190102975E-13,-2.599706096327376E-13,-2.382191739347923E-13,-6.423305872147843E-13,-9.400849094049696E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049694E-13,-6.42330587214784E-13,-2.382191739347918E-13],[2.382191739347913E-13,6.423305872147834E-13,9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.400849094049688E-13,6.423305872147841E-13,2.382191739347918E-13,5.456116108943413E-12,4.878985199565852E-12,4.240448995017367E-12,
3.559909094758253E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558782E-12,8.371015190102975E-13,2.599706096327376E-13,-5.461314069809755E-12,-4.921085770524055E-12,-4.343405037091838E-12,-3.732668368707687E-12,-3.093523840190885E-12,-2.430835727329465E-12,-1.734679010007751E-12,-9.74825365660928E-13,-2.797435120168326E-13,0,0,0,0,0,0,-2.283748241799531E-13,-4.037858874020686E-13,-2.146547464825323E-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,
1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,
.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531E-13,4.037858874020686E-13,2.146547464825323E-13,5.461314069809755E-12,4.921085770524055E-12,4.343405037091838E-12,3.732668368707687E-12,3.093523840190885E-12,2.430835727329466E-12,1.734679010007751E-12,9.74825365660928E-13,2.797435120168326E-13,-5.456116108943413E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758253E-12,-2.858043359288075E-12,-2.156177623817898E-12,-1.475637723558782E-12,-8.371015190102975E-13,
-2.599706096327376E-13,-2.382191739347913E-13,-6.423305872147834E-13,-9.400849094049688E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049688E-13,-6.423305872147841E-13,-2.382191739347918E-13]],E=r[b.SHORT_TYPE],A=r[b.SHORT_TYPE],m=r[b.SHORT_TYPE],H=r[b.SHORT_TYPE],g=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(d,k,a){for(var e=286,J=0;J<d.channels_out;J++){for(var h=0;h<d.mode_gr;h++){for(var p,
c=d.l3_side.tt[h][J],f=c.xr,x=0,q=d.sb_sample[J][1-h],w=0,z=0;9>z;z++)for(u(k,e,q[w]),u(k,e+32,q[w+1]),w+=2,e+=64,p=1;32>p;p+=2)q[w-1][p]*=-1;for(p=0;32>p;p++,x+=18){var q=c.block_type,w=d.sb_sample[J][h],y=d.sb_sample[J][1-h];0!=c.mixed_block_flag&&2>p&&(q=0);if(1E-12>d.amp_filter[p])Qa.fill(f,x+0,x+18,0);else{if(1>d.amp_filter[p])for(z=0;18>z;z++)y[z][g[p]]*=d.amp_filter[p];if(q==b.SHORT_TYPE){for(z=-3;0>z;z++){var t=r[b.SHORT_TYPE][z+3];f[x+3*z+9]=w[9+z][g[p]]*t-w[8-z][g[p]];f[x+3*z+18]=w[14-z][g[p]]*
t+w[15+z][g[p]];f[x+3*z+10]=w[15+z][g[p]]*t-w[14-z][g[p]];f[x+3*z+19]=y[2-z][g[p]]*t+y[3+z][g[p]];f[x+3*z+11]=y[3+z][g[p]]*t-y[2-z][g[p]];f[x+3*z+20]=y[8-z][g[p]]*t+y[9+z][g[p]]}z=f;w=x;for(t=0;3>t;t++){var l,C,v,aa,G;v=z[w+6]*r[b.SHORT_TYPE][0]-z[w+15];y=z[w+0]*r[b.SHORT_TYPE][2]-z[w+9];l=v+y;C=v-y;v=z[w+15]*r[b.SHORT_TYPE][0]+z[w+6];y=z[w+9]*r[b.SHORT_TYPE][2]+z[w+0];aa=v+y;G=-v+y;y=2.069978111953089E-11*(z[w+3]*r[b.SHORT_TYPE][1]-z[w+12]);v=2.069978111953089E-11*(z[w+12]*r[b.SHORT_TYPE][1]+z[w+
3]);z[w+0]=1.90752519173728E-11*l+y;z[w+15]=1.90752519173728E-11*-aa+v;C*=1.6519652744032674E-11;aa=9.537625958686404E-12*aa+v;z[w+3]=C-aa;z[w+6]=C+aa;l=9.537625958686404E-12*l-y;G*=1.6519652744032674E-11;z[w+9]=l+G;z[w+12]=l-G;w++}}else{t=L(18);for(z=-9;0>z;z++)l=r[q][z+27]*y[z+9][g[p]]+r[q][z+36]*y[8-z][g[p]],C=r[q][z+9]*w[z+9][g[p]]-r[q][z+18]*w[8-z][g[p]],t[z+9]=l-C*E[3+z+9],t[z+18]=l*E[3+z+9]+C;var z=f,w=x,B=G=aa=v=C=l=y=void 0,N=void 0,D=void 0,F=void 0;C=t[17]-t[9];aa=t[15]-t[11];G=t[14]-t[12];
B=t[0]+t[8];N=t[1]+t[7];D=t[2]+t[6];F=t[3]+t[5];z[w+17]=B+D-F-(N-t[4]);l=(B+D-F)*A[19]+(N-t[4]);y=(C-aa-G)*A[18];z[w+5]=y+l;z[w+6]=y-l;v=(t[16]-t[10])*A[18];N=N*A[19]+t[4];y=C*A[12]+v+aa*A[13]+G*A[14];l=-B*A[16]+N-D*A[17]+F*A[15];z[w+1]=y+l;z[w+2]=y-l;y=C*A[13]-v-aa*A[14]+G*A[12];l=-B*A[17]+N-D*A[15]+F*A[16];z[w+9]=y+l;z[w+10]=y-l;y=C*A[14]-v+aa*A[12]-G*A[13];l=B*A[15]-N+D*A[16]-F*A[17];z[w+13]=y+l;z[w+14]=y-l;F=D=N=B=G=aa=v=C=void 0;C=t[8]-t[0];aa=t[6]-t[2];G=t[5]-t[3];B=t[17]+t[9];N=t[16]+t[10];
D=t[15]+t[11];F=t[14]+t[12];z[w+0]=B+D+F+(N+t[13]);y=(B+D+F)*A[19]-(N+t[13]);l=(C-aa+G)*A[18];z[w+11]=y+l;z[w+12]=y-l;v=(t[7]-t[1])*A[18];N=t[13]-N*A[19];y=B*A[15]-N+D*A[16]+F*A[17];l=C*A[14]+v+aa*A[12]+G*A[13];z[w+3]=y+l;z[w+4]=y-l;y=-B*A[17]+N-D*A[15]-F*A[16];l=C*A[13]+v-aa*A[14]-G*A[12];z[w+7]=y+l;z[w+8]=y-l;y=-B*A[16]+N-D*A[17]-F*A[15];l=C*A[12]-v+aa*A[13]-G*A[14];z[w+15]=y+l;z[w+16]=y-l}}if(q!=b.SHORT_TYPE&&0!=p)for(z=7;0<=z;--z)q=f[x+z]*m[20+z]+f[x+-1-z]*H[28+z],w=f[x+z]*H[28+z]-f[x+-1-z]*m[20+
z],f[x+-1-z]=q,f[x+z]=w}}k=a;e=286;if(1==d.mode_gr)for(h=0;18>h;h++)K.arraycopy(d.sb_sample[J][1][h],0,d.sb_sample[J][0][h],0,32)}}}function b(){var u=b.FFTOFFSET,k=b.MPG_MD_MS_LR,r=null,E=this.psy=null,A=null,m=null;this.setModules=function(b,d,k,a){r=b;E=this.psy=d;A=a;m=k};var ua=new Oc;this.lame_encode_mp3_frame=function(g,d,n,a,e,J){var h=ic([2,2]);h[0][0]=new gb;h[0][1]=new gb;h[1][0]=new gb;h[1][1]=new gb;var p=ic([2,2]);p[0][0]=new gb;p[0][1]=new gb;p[1][0]=new gb;p[1][1]=new gb;var c=[null,
null],f=g.internal_flags,x=ta([2,4]),q=[.5,.5],w=[[0,0],[0,0]],z=[[0,0],[0,0]];c[0]=d;c[1]=n;if(0==f.lame_encode_frame_init){d=g.internal_flags;var y,t;if(0==d.lame_encode_frame_init){n=L(2014);var l=L(2014);d.lame_encode_frame_init=1;for(t=y=0;y<286+576*(1+d.mode_gr);++y)y<576*d.mode_gr?(n[y]=0,2==d.channels_out&&(l[y]=0)):(n[y]=c[0][t],2==d.channels_out&&(l[y]=c[1][t]),++t);for(t=0;t<d.mode_gr;t++)for(y=0;y<d.channels_out;y++)d.l3_side.tt[t][y].block_type=b.SHORT_TYPE;ua.mdct_sub48(d,n,l)}}f.padding=
0;0>(f.slot_lag-=f.frac_SpF)&&(f.slot_lag+=g.out_samplerate,f.padding=1);if(0!=f.psymodel)for(l=[null,null],y=0,t=Y(2),n=0;n<f.mode_gr;n++){for(d=0;d<f.channels_out;d++)l[d]=c[d],y=576+576*n-b.FFTOFFSET;d=g.VBR==H.vbr_mtrh||g.VBR==H.vbr_mt?E.L3psycho_anal_vbr(g,l,y,n,h,p,w[n],z[n],x[n],t):E.L3psycho_anal_ns(g,l,y,n,h,p,w[n],z[n],x[n],t);if(0!=d)return-4;g.mode==oa.JOINT_STEREO&&(q[n]=x[n][2]+x[n][3],0<q[n]&&(q[n]=x[n][3]/q[n]));for(d=0;d<f.channels_out;d++){var C=f.l3_side.tt[n][d];C.block_type=t[d];
C.mixed_block_flag=0}}else for(n=0;n<f.mode_gr;n++)for(d=0;d<f.channels_out;d++)f.l3_side.tt[n][d].block_type=NORM_TYPE,f.l3_side.tt[n][d].mixed_block_flag=0,z[n][d]=w[n][d]=700;0==f.ATH.useAdjust?f.ATH.adjust=1:(d=f.loudness_sq[0][0],x=f.loudness_sq[1][0],2==f.channels_out?(d+=f.loudness_sq[0][1],x+=f.loudness_sq[1][1]):(d+=d,x+=x),2==f.mode_gr&&(d=Math.max(d,x)),d=.5*d*f.ATH.aaSensitivityP,.03125<d?(1<=f.ATH.adjust?f.ATH.adjust=1:f.ATH.adjust<f.ATH.adjustLimit&&(f.ATH.adjust=f.ATH.adjustLimit),
f.ATH.adjustLimit=1):(x=31.98*d+6.25E-4,f.ATH.adjust>=x?(f.ATH.adjust*=.075*x+.925,f.ATH.adjust<x&&(f.ATH.adjust=x)):f.ATH.adjustLimit>=x?f.ATH.adjust=x:f.ATH.adjust<f.ATH.adjustLimit&&(f.ATH.adjust=f.ATH.adjustLimit),f.ATH.adjustLimit=x));ua.mdct_sub48(f,c[0],c[1]);f.mode_ext=b.MPG_MD_LR_LR;if(g.force_ms)f.mode_ext=b.MPG_MD_MS_LR;else if(g.mode==oa.JOINT_STEREO){for(n=l=x=0;n<f.mode_gr;n++)for(d=0;d<f.channels_out;d++)x+=z[n][d],l+=w[n][d];x<=1*l&&(x=f.l3_side.tt[0],d=f.l3_side.tt[f.mode_gr-1],x[0].block_type==
x[1].block_type&&d[0].block_type==d[1].block_type&&(f.mode_ext=b.MPG_MD_MS_LR))}f.mode_ext==k&&(h=p,w=z);if(g.analysis&&null!=f.pinfo)for(n=0;n<f.mode_gr;n++)for(d=0;d<f.channels_out;d++)f.pinfo.ms_ratio[n]=f.ms_ratio[n],f.pinfo.ms_ener_ratio[n]=q[n],f.pinfo.blocktype[n][d]=f.l3_side.tt[n][d].block_type,f.pinfo.pe[n][d]=w[n][d],K.arraycopy(f.l3_side.tt[n][d].xr,0,f.pinfo.xr[n][d],0,576),f.mode_ext==k&&(f.pinfo.ers[n][d]=f.pinfo.ers[n][d+2],K.arraycopy(f.pinfo.energy[n][d+2],0,f.pinfo.energy[n][d],
0,f.pinfo.energy[n][d].length));if(g.VBR==H.vbr_off||g.VBR==H.vbr_abr){for(p=0;18>p;p++)f.nsPsy.pefirbuf[p]=f.nsPsy.pefirbuf[p+1];for(n=z=0;n<f.mode_gr;n++)for(d=0;d<f.channels_out;d++)z+=w[n][d];f.nsPsy.pefirbuf[18]=z;z=f.nsPsy.pefirbuf[9];for(p=0;9>p;p++)z+=(f.nsPsy.pefirbuf[p]+f.nsPsy.pefirbuf[18-p])*b.fircoef[p];z=3350*f.mode_gr*f.channels_out/z;for(n=0;n<f.mode_gr;n++)for(d=0;d<f.channels_out;d++)w[n][d]*=z}f.iteration_loop.iteration_loop(g,w,q,h);r.format_bitstream(g);a=r.copy_buffer(f,a,e,
J,1);g.bWriteVbrTag&&A.addVbrFrame(g);if(g.analysis&&null!=f.pinfo){for(d=0;d<f.channels_out;d++){for(e=0;e<u;e++)f.pinfo.pcmdata[d][e]=f.pinfo.pcmdata[d][e+g.framesize];for(e=u;1600>e;e++)f.pinfo.pcmdata[d][e]=c[d][e-u]}m.set_frame_pinfo(g,h)}f.bitrate_stereoMode_Hist[f.bitrate_index][4]++;f.bitrate_stereoMode_Hist[15][4]++;2==f.channels_out&&(f.bitrate_stereoMode_Hist[f.bitrate_index][f.mode_ext]++,f.bitrate_stereoMode_Hist[15][f.mode_ext]++);for(g=0;g<f.mode_gr;++g)for(c=0;c<f.channels_out;++c)e=
f.l3_side.tt[g][c].block_type|0,0!=f.l3_side.tt[g][c].mixed_block_flag&&(e=4),f.bitrate_blockType_Hist[f.bitrate_index][e]++,f.bitrate_blockType_Hist[f.bitrate_index][5]++,f.bitrate_blockType_Hist[15][e]++,f.bitrate_blockType_Hist[15][5]++;return a}}function Pc(){this.size=this.pos=this.want=this.seen=this.sum=0;this.bag=null;this.TotalFrameSize=this.nBytesWritten=this.nVbrNumFrames=0}function Qc(){this.last_en_subshort=ta([4,9]);this.lastAttacks=Y(4);this.pefirbuf=L(19);this.longfact=L(b.SBMAX_l);
this.shortfact=L(b.SBMAX_s);this.attackthre_s=this.attackthre=0}function Rc(){this.tt=[[null,null],[null,null]];this.resvDrain_post=this.resvDrain_pre=this.private_bits=this.main_data_begin=0;this.scfsi=[Y(4),Y(4)];for(var b=0;2>b;b++)for(var k=0;2>k;k++)this.tt[b][k]=new jc}function Hb(){this.l=L(b.SBMAX_l);this.s=ta([b.SBMAX_s,3]);var u=this;this.assign=function(k){K.arraycopy(k.l,0,u.l,0,b.SBMAX_l);for(var r=0;r<b.SBMAX_s;r++)for(var E=0;3>E;E++)u.s[r][E]=k.s[r][E]}}function ga(){function u(){this.ptr=
this.write_timing=0;this.buf=new Int8Array(40)}this.fill_buffer_resample_init=this.iteration_init_init=this.lame_encode_frame_init=this.Class_ID=0;this.mfbuf=ta([2,ga.MFSIZE]);this.full_outer_loop=this.use_best_huffman=this.subblock_gain=this.noise_shaping_stop=this.psymodel=this.substep_shaping=this.noise_shaping_amp=this.noise_shaping=this.highpass2=this.highpass1=this.lowpass2=this.lowpass1=this.mode_ext=this.samplerate_index=this.bitrate_index=this.VBR_max_bitrate=this.VBR_min_bitrate=this.mf_size=
this.mf_samples_to_encode=this.resample_ratio=this.channels_out=this.channels_in=this.mode_gr=0;this.l3_side=new Rc;this.ms_ratio=L(2);this.slot_lag=this.frac_SpF=this.padding=0;this.tag_spec=null;this.nMusicCRC=0;this.OldValue=Y(2);this.CurrentStep=Y(2);this.masking_lower=0;this.bv_scf=Y(576);this.pseudohalf=Y(Ca.SFBMAX);this.sfb21_extra=!1;this.inbuf_old=Array(2);this.blackfilt=Array(2*ga.BPC+1);this.itime=new Float64Array(2);this.sideinfo_len=0;this.sb_sample=ta([2,2,18,b.SBLIMIT]);this.amp_filter=
L(32);this.header=Array(ga.MAX_HEADER_BUF);this.ResvMax=this.ResvSize=this.ancillary_flag=this.w_ptr=this.h_ptr=0;this.scalefac_band=new Fa;this.minval_l=L(b.CBANDS);this.minval_s=L(b.CBANDS);this.nb_1=ta([4,b.CBANDS]);this.nb_2=ta([4,b.CBANDS]);this.nb_s1=ta([4,b.CBANDS]);this.nb_s2=ta([4,b.CBANDS]);this.s3_ll=this.s3_ss=null;this.decay=0;this.thm=Array(4);this.en=Array(4);this.tot_ener=L(4);this.loudness_sq=ta([2,2]);this.loudness_sq_save=L(2);this.mld_l=L(b.SBMAX_l);this.mld_s=L(b.SBMAX_s);this.bm_l=
Y(b.SBMAX_l);this.bo_l=Y(b.SBMAX_l);this.bm_s=Y(b.SBMAX_s);this.bo_s=Y(b.SBMAX_s);this.npart_s=this.npart_l=0;this.s3ind=fb([b.CBANDS,2]);this.s3ind_s=fb([b.CBANDS,2]);this.numlines_s=Y(b.CBANDS);this.numlines_l=Y(b.CBANDS);this.rnumlines_l=L(b.CBANDS);this.mld_cb_l=L(b.CBANDS);this.mld_cb_s=L(b.CBANDS);this.numlines_l_num1=this.numlines_s_num1=0;this.pe=L(4);this.ms_ener_ratio_old=this.ms_ratio_l_old=this.ms_ratio_s_old=0;this.blocktype_old=Y(2);this.nsPsy=new Qc;this.VBR_seek_table=new Pc;this.PSY=
this.ATH=null;this.nogap_current=this.nogap_total=0;this.findPeakSample=this.findReplayGain=this.decode_on_the_fly=!0;this.AudiophileGain=this.RadioGain=this.PeakSample=0;this.rgdata=null;this.noclipScale=this.noclipGainChange=0;this.bitrate_stereoMode_Hist=fb([16,5]);this.bitrate_blockType_Hist=fb([16,6]);this.hip=this.pinfo=null;this.in_buffer_nsamples=0;this.iteration_loop=this.in_buffer_1=this.in_buffer_0=null;for(var k=0;k<this.en.length;k++)this.en[k]=new Hb;for(k=0;k<this.thm.length;k++)this.thm[k]=
new Hb;for(k=0;k<this.header.length;k++)this.header[k]=new u}function pa(){function u(a,b){var c=A.ATHformula(b,a);return c=Math.pow(10,(c-100)/10+a.ATHlower)}function k(a){this.s=a}var r=null,E=null,A=null;this.setModules=function(a,b,c){r=a;E=b;A=c};this.IPOW20=function(b){return a[b]};var m=pa.IXMAX_VAL+2,ua=pa.Q_MAX,g=pa.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,
6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d;this.sfBandIndex=[new Fa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,6,12,18,24,
30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,4,8,12,16,20,24,30,36,44,
54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Fa([0,12,24,36,48,60,72,88,108,132,160,
192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var n=L(ua+g+1),a=L(ua),e=L(m),J=L(m);this.adj43=J;this.iteration_init=function(d){var p=d.internal_flags,c=p.l3_side;if(0==p.iteration_init_init){p.iteration_init_init=1;c.main_data_begin=0;for(var c=d.internal_flags.ATH.l,f=d.internal_flags.ATH.psfb21,k=d.internal_flags.ATH.s,q=d.internal_flags.ATH.psfb12,w=d.internal_flags,z=d.out_samplerate,y=0;y<b.SBMAX_l;y++){var t=
w.scalefac_band.l[y],l=w.scalefac_band.l[y+1];for(c[y]=$a.MAX_VALUE;t<l;t++){var C=t*z/1152,C=u(d,C);c[y]=Math.min(c[y],C)}}for(y=0;y<b.PSFB21;y++)for(t=w.scalefac_band.psfb21[y],l=w.scalefac_band.psfb21[y+1],f[y]=$a.MAX_VALUE;t<l;t++)C=t*z/1152,C=u(d,C),f[y]=Math.min(f[y],C);for(y=0;y<b.SBMAX_s;y++){t=w.scalefac_band.s[y];l=w.scalefac_band.s[y+1];for(k[y]=$a.MAX_VALUE;t<l;t++)C=t*z/384,C=u(d,C),k[y]=Math.min(k[y],C);k[y]*=w.scalefac_band.s[y+1]-w.scalefac_band.s[y]}for(y=0;y<b.PSFB12;y++){t=w.scalefac_band.psfb12[y];
l=w.scalefac_band.psfb12[y+1];for(q[y]=$a.MAX_VALUE;t<l;t++)C=t*z/384,C=u(d,C),q[y]=Math.min(q[y],C);q[y]*=w.scalefac_band.s[13]-w.scalefac_band.s[12]}if(d.noATH){for(y=0;y<b.SBMAX_l;y++)c[y]=1E-20;for(y=0;y<b.PSFB21;y++)f[y]=1E-20;for(y=0;y<b.SBMAX_s;y++)k[y]=1E-20;for(y=0;y<b.PSFB12;y++)q[y]=1E-20}w.ATH.floor=10*Math.log10(u(d,-1));e[0]=0;for(c=1;c<m;c++)e[c]=Math.pow(c,4/3);for(c=0;c<m-1;c++)J[c]=c+1-Math.pow(.5*(e[c]+e[c+1]),.75);J[c]=.5;for(c=0;c<ua;c++)a[c]=Math.pow(2,-.1875*(c-210));for(c=
0;c<=ua+g;c++)n[c]=Math.pow(2,.25*(c-210-g));r.huffman_init(p);c=d.exp_nspsytune>>2&63;32<=c&&(c-=64);f=Math.pow(10,c/4/10);c=d.exp_nspsytune>>8&63;32<=c&&(c-=64);k=Math.pow(10,c/4/10);c=d.exp_nspsytune>>14&63;32<=c&&(c-=64);q=Math.pow(10,c/4/10);c=d.exp_nspsytune>>20&63;32<=c&&(c-=64);d=q*Math.pow(10,c/4/10);for(c=0;c<b.SBMAX_l;c++)w=6>=c?f:13>=c?k:20>=c?q:d,p.nsPsy.longfact[c]=w;for(c=0;c<b.SBMAX_s;c++)w=5>=c?f:10>=c?k:11>=c?q:d,p.nsPsy.shortfact[c]=w}};this.on_pe=function(a,b,c,d,e,g){var m=a.internal_flags,
k=0,n=Y(2),t,k=new cb(k);a=E.ResvMaxBits(a,d,k,g);var k=k.bits,l=k+a;l>ga.MAX_BITS_PER_GRANULE&&(l=ga.MAX_BITS_PER_GRANULE);for(t=g=0;t<m.channels_out;++t)c[t]=Math.min(ga.MAX_BITS_PER_CHANNEL,k/m.channels_out),n[t]=0|c[t]*b[e][t]/700-c[t],n[t]>3*d/4&&(n[t]=3*d/4),0>n[t]&&(n[t]=0),n[t]+c[t]>ga.MAX_BITS_PER_CHANNEL&&(n[t]=Math.max(0,ga.MAX_BITS_PER_CHANNEL-c[t])),g+=n[t];if(g>a)for(t=0;t<m.channels_out;++t)n[t]=a*n[t]/g;for(t=0;t<m.channels_out;++t)c[t]+=n[t],a-=n[t];for(t=g=0;t<m.channels_out;++t)g+=
c[t];if(g>ga.MAX_BITS_PER_GRANULE)for(t=0;t<m.channels_out;++t)c[t]*=ga.MAX_BITS_PER_GRANULE,c[t]/=g;return l};this.reduce_side=function(a,b,c,d){b=.33*(.5-b)/.5;0>b&&(b=0);.5<b&&(b=.5);b=0|.5*b*(a[0]+a[1]);b>ga.MAX_BITS_PER_CHANNEL-a[0]&&(b=ga.MAX_BITS_PER_CHANNEL-a[0]);0>b&&(b=0);125<=a[1]&&(125<a[1]-b?(a[0]<c&&(a[0]+=b),a[1]-=b):(a[0]+=a[1]-125,a[1]=125));b=a[0]+a[1];b>d&&(a[0]=d*a[0]/b,a[1]=d*a[1]/b)};this.athAdjust=function(a,b,c){b=X.FAST_LOG10_X(b,10);a*=a;var d=0;b-=c;1E-20<a&&(d=1+X.FAST_LOG10_X(a,
10/90.30873362));0>d&&(d=0);b=b*d+(c+90.30873362-94.82444863);return Math.pow(10,.1*b)};this.calc_xmin=function(a,d,c,f){var e=0,g=a.internal_flags,m,k=0,n=0,t=g.ATH,l=c.xr,C=a.VBR==H.vbr_mtrh?1:0,v=g.masking_lower;if(a.VBR==H.vbr_mtrh||a.VBR==H.vbr_mt)v=1;for(m=0;m<c.psy_lmax;m++){var r,G,B,u,D,F;G=a.VBR==H.vbr_rh||a.VBR==H.vbr_mtrh?athAdjust(t.adjust,t.l[m],t.floor):t.adjust*t.l[m];D=c.width[m];B=G/D;u=2.220446049250313E-16;F=D>>1;r=0;do{var I;I=l[k]*l[k];r+=I;u+=I<B?I:B;k++;I=l[k]*l[k];r+=I;u+=
I<B?I:B;k++}while(0<--F);r>G&&n++;m==b.SBPSY_l&&(B=G*g.nsPsy.longfact[m],u<B&&(u=B));0!=C&&(G=u);a.ATHonly||(u=d.en.l[m],0<u&&(B=r*d.thm.l[m]*v/u,0!=C&&(B*=g.nsPsy.longfact[m]),G<B&&(G=B)));0!=C?f[e++]=G:f[e++]=G*g.nsPsy.longfact[m]}r=575;if(c.block_type!=b.SHORT_TYPE)for(G=576;0!=G--&&ra.EQ(l[G],0);)r=G;c.max_nonzero_coeff=r;for(var S=c.sfb_smin;m<c.psymax;S++,m+=3){var U,A;A=a.VBR==H.vbr_rh||a.VBR==H.vbr_mtrh?athAdjust(t.adjust,t.s[S],t.floor):t.adjust*t.s[S];D=c.width[m];for(U=0;3>U;U++){r=0;F=
D>>1;B=A/D;u=2.220446049250313E-16;do I=l[k]*l[k],r+=I,u+=I<B?I:B,k++,I=l[k]*l[k],r+=I,u+=I<B?I:B,k++;while(0<--F);r>A&&n++;S==b.SBPSY_s&&(B=A*g.nsPsy.shortfact[S],u<B&&(u=B));G=0!=C?u:A;a.ATHonly||a.ATHshort||(u=d.en.s[S][U],0<u&&(B=r*d.thm.s[S][U]*v/u,0!=C&&(B*=g.nsPsy.shortfact[S]),G<B&&(G=B)));0!=C?f[e++]=G:f[e++]=G*g.nsPsy.shortfact[S]}a.useTemporal&&(f[e-3]>f[e-3+1]&&(f[e-3+1]+=(f[e-3]-f[e-3+1])*g.decay),f[e-3+1]>f[e-3+2]&&(f[e-3+2]+=(f[e-3+1]-f[e-3+2])*g.decay))}return n};this.calc_noise_core=
function(a,b,c,d){var g=0,m=b.s,k=a.l3_enc;if(m>a.count1)for(;0!=c--;){var n;n=a.xr[m];m++;g+=n*n;n=a.xr[m];m++;g+=n*n}else if(m>a.big_values){var r=L(2);r[0]=0;for(r[1]=d;0!=c--;)n=Math.abs(a.xr[m])-r[k[m]],m++,g+=n*n,n=Math.abs(a.xr[m])-r[k[m]],m++,g+=n*n}else for(;0!=c--;)n=Math.abs(a.xr[m])-e[k[m]]*d,m++,g+=n*n,n=Math.abs(a.xr[m])-e[k[m]]*d,m++,g+=n*n;b.s=m;return g};this.calc_noise=function(a,b,c,e,g){var m=0,w=0,r,y,t=0,l=0,C=0,v=-20,u=0,G=a.scalefac,B=0;for(r=e.over_SSD=0;r<a.psymax;r++){var A=
a.global_gain-(G[B++]+(0!=a.preflag?d[r]:0)<<a.scalefac_scale+1)-8*a.subblock_gain[a.window[r]],D=0;null!=g&&g.step[r]==A?(D=g.noise[r],u+=a.width[r],c[m++]=D/b[w++],D=g.noise_log[r]):(D=n[A+pa.Q_MAX2],y=a.width[r]>>1,u+a.width[r]>a.max_nonzero_coeff&&(y=a.max_nonzero_coeff-u+1,y=0<y?y>>1:0),u=new k(u),D=this.calc_noise_core(a,u,y,D),u=u.s,null!=g&&(g.step[r]=A,g.noise[r]=D),D=c[m++]=D/b[w++],D=X.FAST_LOG10(Math.max(D,1E-20)),null!=g&&(g.noise_log[r]=D));null!=g&&(g.global_gain=a.global_gain);C+=
D;0<D&&(A=Math.max(0|10*D+.5,1),e.over_SSD+=A*A,t++,l+=D);v=Math.max(v,D)}e.over_count=t;e.tot_noise=C;e.over_noise=l;e.max_noise=v;return t};this.set_pinfo=function(a,e,c,f,g){var m=a.internal_flags,k,n,r,t,l=0==e.scalefac_scale?.5:1,C=e.scalefac,v=L(Ca.SFBMAX),u=L(Ca.SFBMAX),G=new Gb;calc_xmin(a,c,e,v);calc_noise(e,v,u,G,null);var B=0;n=e.sfb_lmax;e.block_type!=b.SHORT_TYPE&&0==e.mixed_block_flag&&(n=22);for(k=0;k<n;k++){var A=m.scalefac_band.l[k],D=m.scalefac_band.l[k+1],F=D-A;for(t=0;B<D;B++)t+=
e.xr[B]*e.xr[B];t/=F;r=1E15;m.pinfo.en[f][g][k]=r*t;m.pinfo.xfsf[f][g][k]=r*v[k]*u[k]/F;t=0<c.en.l[k]&&!a.ATHonly?t/c.en.l[k]:0;m.pinfo.thr[f][g][k]=r*Math.max(t*c.thm.l[k],m.ATH.l[k]);m.pinfo.LAMEsfb[f][g][k]=0;0!=e.preflag&&11<=k&&(m.pinfo.LAMEsfb[f][g][k]=-l*d[k]);k<b.SBPSY_l&&(m.pinfo.LAMEsfb[f][g][k]-=l*C[k])}if(e.block_type==b.SHORT_TYPE)for(n=k,k=e.sfb_smin;k<b.SBMAX_s;k++)for(var A=m.scalefac_band.s[k],D=m.scalefac_band.s[k+1],F=D-A,I=0;3>I;I++){t=0;for(r=A;r<D;r++)t+=e.xr[B]*e.xr[B],B++;
t=Math.max(t/F,1E-20);r=1E15;m.pinfo.en_s[f][g][3*k+I]=r*t;m.pinfo.xfsf_s[f][g][3*k+I]=r*v[n]*u[n]/F;t=0<c.en.s[k][I]?t/c.en.s[k][I]:0;if(a.ATHonly||a.ATHshort)t=0;m.pinfo.thr_s[f][g][3*k+I]=r*Math.max(t*c.thm.s[k][I],m.ATH.s[k]);m.pinfo.LAMEsfb_s[f][g][3*k+I]=-2*e.subblock_gain[I];k<b.SBPSY_s&&(m.pinfo.LAMEsfb_s[f][g][3*k+I]-=l*C[n]);n++}m.pinfo.LAMEqss[f][g]=e.global_gain;m.pinfo.LAMEmainbits[f][g]=e.part2_3_length+e.part2_length;m.pinfo.LAMEsfbits[f][g]=e.part2_length;m.pinfo.over[f][g]=G.over_count;
m.pinfo.max_noise[f][g]=10*G.max_noise;m.pinfo.over_noise[f][g]=10*G.over_noise;m.pinfo.tot_noise[f][g]=10*G.tot_noise;m.pinfo.over_SSD[f][g]=G.over_SSD}}function Sc(){function u(b,k,g){var d=0,n,a,e;g<<=1;var r=k+g;n=4;do{var h,p,c,f,x,q,w;w=n>>1;f=n;x=n<<1;q=x+f;n=x<<1;a=k;e=a+w;do{var z,y,t,l;y=b[a+0]-b[a+f];z=b[a+0]+b[a+f];l=b[a+x]-b[a+q];t=b[a+x]+b[a+q];b[a+x]=z-t;b[a+0]=z+t;b[a+q]=y-l;b[a+f]=y+l;y=b[e+0]-b[e+f];z=b[e+0]+b[e+f];l=X.SQRT2*b[e+q];t=X.SQRT2*b[e+x];b[e+x]=z-t;b[e+0]=z+t;b[e+q]=y-
l;b[e+f]=y+l;e+=n;a+=n}while(a<r);p=E[d+0];h=E[d+1];for(c=1;c<w;c++){var C,v;C=1-2*h*h;v=2*h*p;a=k+c;e=k+f-c;do{var A,G,B,N,D;A=v*b[a+f]-C*b[e+f];t=C*b[a+f]+v*b[e+f];y=b[a+0]-t;z=b[a+0]+t;B=b[e+0]-A;G=b[e+0]+A;A=v*b[a+q]-C*b[e+q];t=C*b[a+q]+v*b[e+q];l=b[a+x]-t;t=b[a+x]+t;D=b[e+x]-A;N=b[e+x]+A;A=h*t-p*D;t=p*t+h*D;b[a+x]=z-t;b[a+0]=z+t;b[e+q]=B-A;b[e+f]=B+A;A=p*N-h*l;t=h*N+p*l;b[e+x]=G-t;b[e+0]=G+t;b[a+q]=y-A;b[a+f]=y+A;e+=n;a+=n}while(a<r);C=p;p=C*E[d+0]-h*E[d+1];h=C*E[d+1]+h*E[d+0]}d+=2}while(n<g)}
var k=L(b.BLKSIZE),r=L(b.BLKSIZE_s/2),E=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],A=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,
234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(k,E,g,d,n){for(k=0;3>k;k++){var a=b.BLKSIZE_s/2,e=65535&192*(k+1),J=b.BLKSIZE_s/8-1;do{var h,p,c,f,x,q=A[J<<2]&255;h=r[q]*d[g][n+q+e];x=r[127-q]*d[g][n+q+e+128];p=h-x;h+=x;c=r[q+64]*d[g][n+q+e+64];x=r[63-q]*d[g][n+q+e+192];f=c-x;c+=x;a-=4;E[k][a+0]=h+c;E[k][a+2]=h-c;E[k][a+1]=p+f;E[k][a+3]=p-f;h=r[q+1]*d[g][n+q+e+1];x=r[126-q]*
d[g][n+q+e+129];p=h-x;h+=x;c=r[q+65]*d[g][n+q+e+65];x=r[62-q]*d[g][n+q+e+193];f=c-x;c+=x;E[k][a+b.BLKSIZE_s/2+0]=h+c;E[k][a+b.BLKSIZE_s/2+2]=h-c;E[k][a+b.BLKSIZE_s/2+1]=p+f;E[k][a+b.BLKSIZE_s/2+3]=p-f}while(0<=--J);u(E[k],a,b.BLKSIZE_s/2)}};this.fft_long=function(m,r,g,d,n){m=b.BLKSIZE/8-1;var a=b.BLKSIZE/2;do{var e,E,h,p,c,f=A[m]&255;e=k[f]*d[g][n+f];c=k[f+512]*d[g][n+f+512];E=e-c;e+=c;h=k[f+256]*d[g][n+f+256];c=k[f+768]*d[g][n+f+768];p=h-c;h+=c;a-=4;r[a+0]=e+h;r[a+2]=e-h;r[a+1]=E+p;r[a+3]=E-p;e=
k[f+1]*d[g][n+f+1];c=k[f+513]*d[g][n+f+513];E=e-c;e+=c;h=k[f+257]*d[g][n+f+257];c=k[f+769]*d[g][n+f+769];p=h-c;h+=c;r[a+b.BLKSIZE/2+0]=e+h;r[a+b.BLKSIZE/2+2]=e-h;r[a+b.BLKSIZE/2+1]=E+p;r[a+b.BLKSIZE/2+3]=E-p}while(0<=--m);u(r,a,b.BLKSIZE/2)};this.init_fft=function(m){for(m=0;m<b.BLKSIZE;m++)k[m]=.42-.5*Math.cos(2*Math.PI*(m+.5)/b.BLKSIZE)+.08*Math.cos(4*Math.PI*(m+.5)/b.BLKSIZE);for(m=0;m<b.BLKSIZE_s/2;m++)r[m]=.5*(1-Math.cos(2*Math.PI*(m+.5)/b.BLKSIZE_s))}}function $b(){function u(a,c){for(var d=
0,l=0;l<b.BLKSIZE/2;++l)d+=a[l]*c.ATH.eql_w[l];return d*=q}function k(a,b,c,d,e,f){var g;if(b>a)if(b<a*z)g=b/a;else return a+b;else{if(a>=b*z)return a+b;g=a/b}a+=b;if(6>=d+3){if(g>=w)return a;d=0|X.FAST_LOG10_X(g,16);return a*C[d]}d=0|X.FAST_LOG10_X(g,16);b=0!=f?e.ATH.cb_s[c]*e.ATH.adjust:e.ATH.cb_l[c]*e.ATH.adjust;return a<y*b?a>b?(c=1,13>=d&&(c=v[d]),b=X.FAST_LOG10_X(a/b,10/15),a*((l[d]-c)*b+c)):13<d?a:a*v[d]:a*l[d]}function r(a,b,c){var d;0>a&&(a=0);0>b&&(b=0);if(0>=a)return b;if(0>=b)return a;
d=b>a?b/a:a/b;if(-2<=c&&2>=c){if(d>=w)return a+b;c=0|X.FAST_LOG10_X(d,16);return(a+b)*aa[c]}if(d<z)return a+b;a<b&&(a=b);return a}function E(a,c,d,l,e){var f,g,h=0,k=0;for(f=g=0;f<b.SBMAX_s;++g,++f){for(var v=a.bo_s[f],m=a.npart_s,v=v<m?v:m;g<v;)h+=c[g],k+=d[g],g++;a.en[l].s[f][e]=h;a.thm[l].s[f][e]=k;if(g>=m){++f;break}k=a.PSY.bo_s_weight[f];m=1-k;h=k*c[g];k*=d[g];a.en[l].s[f][e]+=h;a.thm[l].s[f][e]+=k;h=m*c[g];k=m*d[g]}for(;f<b.SBMAX_s;++f)a.en[l].s[f][e]=0,a.thm[l].s[f][e]=0}function A(a,c,d,l){var e,
f,g=0,k=0;for(e=f=0;e<b.SBMAX_l;++f,++e){for(var h=a.bo_l[e],v=a.npart_l,h=h<v?h:v;f<h;)g+=c[f],k+=d[f],f++;a.en[l].l[e]=g;a.thm[l].l[e]=k;if(f>=v){++e;break}k=a.PSY.bo_l_weight[e];v=1-k;g=k*c[f];k*=d[f];a.en[l].l[e]+=g;a.thm[l].l[e]+=k;g=v*c[f];k=v*d[f]}for(;e<b.SBMAX_l;++e)a.en[l].l[e]=0,a.thm[l].l[e]=0}function m(a,b,c){return 1<=c?a:0>=c?b:0<b?Math.pow(a/b,c)*b:0}function W(a,c){for(var d=309.07,l=0;l<b.SBMAX_s-1;l++)for(var e=0;3>e;e++){var f=a.thm.s[l][e];if(0<f){var f=f*c,g=a.en.s[l][e];g>
f&&(d=g>1E10*f?d+23.02585092994046*G[l]:d+G[l]*X.FAST_LOG10(g/f))}}return d}function g(a,c){for(var d=281.0575,l=0;l<b.SBMAX_l-1;l++){var e=a.thm.l[l];if(0<e){var e=e*c,f=a.en.l[l];f>e&&(d=f>1E10*e?d+23.02585092994046*B[l]:d+B[l]*X.FAST_LOG10(f/e))}}return d}function d(a,b,c,d,l){var e,f;for(e=f=0;e<a.npart_l;++e){var g=0,k=0,h;for(h=0;h<a.numlines_l[e];++h,++f){var v=b[f],g=g+v;k<v&&(k=v)}c[e]=g;d[e]=k;l[e]=g*a.rnumlines_l[e]}}function n(a,b,c,d){var l=t.length-1,e=0,f=c[e]+c[e+1];if(0<f){var g=
b[e];g<b[e+1]&&(g=b[e+1]);f=20*(2*g-f)/(f*(a.numlines_l[e]+a.numlines_l[e+1]-1));f|=0;f>l&&(f=l);d[e]=f}else d[e]=0;for(e=1;e<a.npart_l-1;e++)f=c[e-1]+c[e]+c[e+1],0<f?(g=b[e-1],g<b[e]&&(g=b[e]),g<b[e+1]&&(g=b[e+1]),f=20*(3*g-f)/(f*(a.numlines_l[e-1]+a.numlines_l[e]+a.numlines_l[e+1]-1)),f|=0,f>l&&(f=l),d[e]=f):d[e]=0;f=c[e-1]+c[e];0<f?(g=b[e-1],g<b[e]&&(g=b[e]),f=20*(2*g-f)/(f*(a.numlines_l[e-1]+a.numlines_l[e]-1)),f|=0,f>l&&(f=l),d[e]=f):d[e]=0}function a(a,b,c,d,l,e,f){var g=2*e;l=0<e?Math.pow(10,
l):1;for(var k,h,v=0;v<f;++v){var m=a[2][v],p=a[3][v],t=b[0][v],n=b[1][v],r=b[2][v],C=b[3][v];t<=1.58*n&&n<=1.58*t?(k=c[v]*m,h=Math.max(r,Math.min(C,c[v]*p)),k=Math.max(C,Math.min(r,k))):(h=r,k=C);0<e&&(C=d[v]*l,t=Math.min(Math.max(t,C),Math.max(n,C)),r=Math.max(h,C),C=Math.max(k,C),n=r+C,0<n&&t*g<n&&(t=t*g/n,r*=t,C*=t),h=Math.min(r,h),k=Math.min(C,k));h>m&&(h=m);k>p&&(k=p);b[2][v]=h;b[3][v]=k}}function e(a,b){var c;c=0<=a?27*-a:a*b;return-72>=c?0:Math.exp(.2302585093*c)}function J(a){0>a&&(a=0);
a*=.001;return 13*Math.atan(.76*a)+3.5*Math.atan(a*a/56.25)}function h(a,c,d,l,e,f,g,k,h,v,m,p){var t=L(b.CBANDS+1),n=k/(15<p?1152:384),r=Y(b.HBLKSIZE),C;k/=h;var q=0,w=0;for(C=0;C<b.CBANDS;C++){var u,x;u=J(k*q);t[C]=k*q;for(x=q;.34>J(k*x)-u&&x<=h/2;x++);a[C]=x-q;for(w=C+1;q<x;)r[q++]=C;if(q>h/2){q=h/2;++C;break}}t[C]=k*q;for(q=0;q<p;q++)C=v[q],u=v[q+1],C=0|Math.floor(.5+m*(C-.5)),0>C&&(C=0),x=0|Math.floor(.5+m*(u-.5)),x>h/2&&(x=h/2),d[q]=(r[C]+r[x])/2,c[q]=r[x],g[q]=(n*u-t[c[q]])/(t[c[q]+1]-t[c[q]]),
0>g[q]?g[q]=0:1<g[q]&&(g[q]=1),u=J(k*v[q]*m),u=Math.min(u,15.5)/15.5,f[q]=Math.pow(10,1.25*(1-Math.cos(Math.PI*u))-2.5);for(c=q=0;c<w;c++)d=a[c],u=J(k*q),f=J(k*(q+d-1)),l[c]=.5*(u+f),u=J(k*(q-.5)),f=J(k*(q+d-.5)),e[c]=f-u,q+=d;return w}function p(a,c,d,l,f,g){var k=ta([b.CBANDS,b.CBANDS]),h=0;if(g)for(var v=0;v<c;v++)for(g=0;g<c;g++){var m;var p=m=void 0,p=m=void 0;m=d[v]-d[g];m=0<=m?3*m:1.5*m;.5<=m&&2.5>=m?(p=m-.5,p=8*(p*p-2*p)):p=0;m+=.474;m=15.811389+7.5*m-17.5*Math.sqrt(1+m*m);-60>=m?m=0:(m=Math.exp(.2302585093*
(p+m)),m/=.6609193);p=m*l[g];k[v][g]=p*f[v]}else for(g=0;g<c;g++){m=15+Math.min(21/d[g],12);var t;var v=m,C=p=0;t=0;var r=C=void 0;for(t=0;1E-20<e(t,v);--t);C=t;for(r=0;1E-12<Math.abs(r-C);)t=(r+C)/2,0<e(t,v)?r=t:C=t;p=C;for(t=0;1E-20<e(t,v);t+=1);C=0;for(r=t;1E-12<Math.abs(r-C);)t=(r+C)/2,0<e(t,v)?C=t:r=t;for(var C=r,r=0,n=void 0,n=0;1E3>=n;++n)t=p+n*(C-p)/1E3,t=e(t,v),r+=t;t=1001/(r*(C-p));for(v=0;v<c;v++)p=t*e(d[v]-d[g],m)*l[g],k[v][g]=p*f[v]}for(v=0;v<c;v++){for(g=0;g<c&&!(0<k[v][g]);g++);a[v][0]=
g;for(g=c-1;0<g&&!(0<k[v][g]);g--);a[v][1]=g;h+=a[v][1]-a[v][0]+1}d=L(h);for(v=l=0;v<c;v++)for(g=a[v][0];g<=a[v][1];g++)d[l++]=k[v][g];return d}function c(a){a=J(a);a=Math.min(a,15.5)/15.5;return Math.pow(10,1.25*(1-Math.cos(Math.PI*a))-2.5)}function f(a,b){-.3>a&&(a=3410);a=Math.max(.1,a/1E3);return 3.64*Math.pow(a,-.8)-6.8*Math.exp(-.6*Math.pow(a-3.4,2))+6*Math.exp(-.15*Math.pow(a-8.7,2))+.001*(.6+.04*b)*Math.pow(a,4)}var x=new Sc,q=1/217621504/(b.BLKSIZE/2),w,z,y,t=[1,.79433,.63096,.63096,.63096,
.63096,.63096,.25119,.11749],l=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],C=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,
1],v=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],aa=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],G=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],B=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,
85.7,93.4,126.1],N=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_ns=function(a,c,l,e,f,v,h,p,C,r){var q=a.internal_flags,w=ta([2,b.BLKSIZE]),y=ta([2,3,b.BLKSIZE_s]),G=L(b.CBANDS+1),D=L(b.CBANDS+1),B=L(b.CBANDS+2),z=Y(2),aa=Y(2),J,Q,Ga,M,K,Z,fa,ha,T=ta([2,576]),P,ga=Y(b.CBANDS+2),O=Y(b.CBANDS+2);Qa.fill(O,0);J=q.channels_out;a.mode==oa.JOINT_STEREO&&(J=4);P=a.VBR==H.vbr_off?0==q.ResvMax?0:q.ResvSize/q.ResvMax*
.5:a.VBR==H.vbr_rh||a.VBR==H.vbr_mtrh||a.VBR==H.vbr_mt?.6:1;for(Q=0;Q<q.channels_out;Q++){var da=c[Q],ra=l+576-350-21+192;for(M=0;576>M;M++){var Ha,Sa;Ha=da[ra+M+10];for(K=Sa=0;9>K;K+=2)Ha+=N[K]*(da[ra+M+K]+da[ra+M+21-K]),Sa+=N[K+1]*(da[ra+M+K+1]+da[ra+M+21-K-1]);T[Q][M]=Ha+Sa}f[e][Q].en.assign(q.en[Q]);f[e][Q].thm.assign(q.thm[Q]);2<J&&(v[e][Q].en.assign(q.en[Q+2]),v[e][Q].thm.assign(q.thm[Q+2]))}for(Q=0;Q<J;Q++){var ia=L(12),Oa=[0,0,0,0],pa=L(12),Ca=1,sa,Fa=L(b.CBANDS),gb=L(b.CBANDS),va=[0,0,0,
0],fb=L(b.HBLKSIZE),hb=ta([3,b.HBLKSIZE_s]);for(M=0;3>M;M++)ia[M]=q.nsPsy.last_en_subshort[Q][M+6],pa[M]=ia[M]/q.nsPsy.last_en_subshort[Q][M+4],Oa[0]+=ia[M];if(2==Q)for(M=0;576>M;M++){var cb,Ac;cb=T[0][M];Ac=T[1][M];T[0][M]=cb+Ac;T[1][M]=cb-Ac}var $a=T[Q&1],Ib=0;for(M=0;9>M;M++){for(var wb=Ib+64,Ta=1;Ib<wb;Ib++)Ta<Math.abs($a[Ib])&&(Ta=Math.abs($a[Ib]));q.nsPsy.last_en_subshort[Q][M]=ia[M+3]=Ta;Oa[1+M/3]+=Ta;Ta=Ta>ia[M+3-2]?Ta/ia[M+3-2]:ia[M+3-2]>10*Ta?ia[M+3-2]/(10*Ta):0;pa[M+3]=Ta}if(a.analysis){var Pb=
pa[0];for(M=1;12>M;M++)Pb<pa[M]&&(Pb=pa[M]);q.pinfo.ers[e][Q]=q.pinfo.ers_save[Q];q.pinfo.ers_save[Q]=Pb}sa=3==Q?q.nsPsy.attackthre_s:q.nsPsy.attackthre;for(M=0;12>M;M++)0==va[M/3]&&pa[M]>sa&&(va[M/3]=M%3+1);for(M=1;4>M;M++)1.7>(Oa[M-1]>Oa[M]?Oa[M-1]/Oa[M]:Oa[M]/Oa[M-1])&&(va[M]=0,1==M&&(va[0]=0));0!=va[0]&&0!=q.nsPsy.lastAttacks[Q]&&(va[0]=0);if(3==q.nsPsy.lastAttacks[Q]||0!=va[0]+va[1]+va[2]+va[3])Ca=0,0!=va[1]&&0!=va[0]&&(va[1]=0),0!=va[2]&&0!=va[1]&&(va[2]=0),0!=va[3]&&0!=va[2]&&(va[3]=0);2>Q?
aa[Q]=Ca:0==Ca&&(aa[0]=aa[1]=0);C[Q]=q.tot_ener[Q];var R=a,Pa=fb,Qb=hb,Ua=w,xb=Q&1,Ya=y,Va=Q&1,pb=e,Ja=Q,za=c,ob=l,ab=R.internal_flags;if(2>Ja)x.fft_long(ab,Ua[xb],Ja,za,ob),x.fft_short(ab,Ya[Va],Ja,za,ob);else if(2==Ja){for(var ja=b.BLKSIZE-1;0<=ja;--ja){var Rb=Ua[xb+0][ja],Jb=Ua[xb+1][ja];Ua[xb+0][ja]=(Rb+Jb)*X.SQRT2*.5;Ua[xb+1][ja]=(Rb-Jb)*X.SQRT2*.5}for(var Ka=2;0<=Ka;--Ka)for(ja=b.BLKSIZE_s-1;0<=ja;--ja)Rb=Ya[Va+0][Ka][ja],Jb=Ya[Va+1][Ka][ja],Ya[Va+0][Ka][ja]=(Rb+Jb)*X.SQRT2*.5,Ya[Va+1][Ka][ja]=
(Rb-Jb)*X.SQRT2*.5}Pa[0]=Ua[xb+0][0];Pa[0]*=Pa[0];for(ja=b.BLKSIZE/2-1;0<=ja;--ja){var ac=Ua[xb+0][b.BLKSIZE/2-ja],Bb=Ua[xb+0][b.BLKSIZE/2+ja];Pa[b.BLKSIZE/2-ja]=.5*(ac*ac+Bb*Bb)}for(Ka=2;0<=Ka;--Ka)for(Qb[Ka][0]=Ya[Va+0][Ka][0],Qb[Ka][0]*=Qb[Ka][0],ja=b.BLKSIZE_s/2-1;0<=ja;--ja)ac=Ya[Va+0][Ka][b.BLKSIZE_s/2-ja],Bb=Ya[Va+0][Ka][b.BLKSIZE_s/2+ja],Qb[Ka][b.BLKSIZE_s/2-ja]=.5*(ac*ac+Bb*Bb);for(var Da=0,ja=11;ja<b.HBLKSIZE;ja++)Da+=Pa[ja];ab.tot_ener[Ja]=Da;if(R.analysis){for(ja=0;ja<b.HBLKSIZE;ja++)ab.pinfo.energy[pb][Ja][ja]=
ab.pinfo.energy_save[Ja][ja],ab.pinfo.energy_save[Ja][ja]=Pa[ja];ab.pinfo.pe[pb][Ja]=ab.pe[Ja]}2==R.athaa_loudapprox&&2>Ja&&(ab.loudness_sq[pb][Ja]=ab.loudness_sq_save[Ja],ab.loudness_sq_save[Ja]=u(Pa,ab));d(q,fb,G,Fa,gb);n(q,Fa,gb,ga);for(ha=0;3>ha;ha++){for(var pc,Ba,ib=hb,jb=D,Sb=B,Kb=Q,bc=ha,ba=a.internal_flags,qb=void 0,qa=void 0,qa=qb=0;qa<ba.npart_s;++qa){for(var bb=0,kc=0,Gb=ba.numlines_s[qa],kb=0;kb<Gb;++kb,++qb){var qc=ib[bc][qb],bb=bb+qc;kc<qc&&(kc=qc)}jb[qa]=bb}for(qb=qa=0;qa<ba.npart_s;qa++){var rb=
ba.s3ind_s[qa][0],Cb=ba.s3_ss[qb++]*jb[rb];for(++rb;rb<=ba.s3ind_s[qa][1];)Cb+=ba.s3_ss[qb]*jb[rb],++qb,++rb;var Tb=2*ba.nb_s1[Kb][qa];Sb[qa]=Math.min(Cb,Tb);ba.blocktype_old[Kb&1]==b.SHORT_TYPE&&(Tb=16*ba.nb_s2[Kb][qa],Sb[qa]=Math.min(Tb,Sb[qa]));ba.nb_s2[Kb][qa]=ba.nb_s1[Kb][qa];ba.nb_s1[Kb][qa]=Cb}for(;qa<=b.CBANDS;++qa)jb[qa]=0,Sb[qa]=0;E(q,D,B,Q,ha);for(fa=0;fa<b.SBMAX_s;fa++){Ba=q.thm[Q].s[fa][ha];Ba*=.8;if(2<=va[ha]||1==va[ha+1]){var Lb=0!=ha?ha-1:2,Ta=m(q.thm[Q].s[fa][Lb],Ba,.6*P);Ba=Math.min(Ba,
Ta)}if(1==va[ha])Lb=0!=ha?ha-1:2,Ta=m(q.thm[Q].s[fa][Lb],Ba,.3*P),Ba=Math.min(Ba,Ta);else if(0!=ha&&3==va[ha-1]||0==ha&&3==q.nsPsy.lastAttacks[Q])Lb=2!=ha?ha+1:0,Ta=m(q.thm[Q].s[fa][Lb],Ba,.3*P),Ba=Math.min(Ba,Ta);pc=ia[3*ha+3]+ia[3*ha+4]+ia[3*ha+5];6*ia[3*ha+5]<pc&&(Ba*=.5,6*ia[3*ha+4]<pc&&(Ba*=.5));q.thm[Q].s[fa][ha]=Ba}}q.nsPsy.lastAttacks[Q]=va[2];for(Ga=Z=0;Ga<q.npart_l;Ga++){for(var sb=q.s3ind[Ga][0],Ub=G[sb]*t[ga[sb]],tb=q.s3_ll[Z++]*Ub;++sb<=q.s3ind[Ga][1];)Ub=G[sb]*t[ga[sb]],tb=k(tb,q.s3_ll[Z++]*
Ub,sb,sb-Ga,q,0);tb*=.158489319246111;B[Ga]=q.blocktype_old[Q&1]==b.SHORT_TYPE?tb:m(Math.min(tb,Math.min(2*q.nb_1[Q][Ga],16*q.nb_2[Q][Ga])),tb,P);q.nb_2[Q][Ga]=q.nb_1[Q][Ga];q.nb_1[Q][Ga]=tb}for(;Ga<=b.CBANDS;++Ga)G[Ga]=0,B[Ga]=0;A(q,G,B,Q)}if((a.mode==oa.STEREO||a.mode==oa.JOINT_STEREO)&&0<a.interChRatio){var Db=a.interChRatio,ca=a.internal_flags;if(1<ca.channels_out){for(var La=0;La<b.SBMAX_l;La++){var cc=ca.thm[0].l[La],Mb=ca.thm[1].l[La];ca.thm[0].l[La]+=Mb*Db;ca.thm[1].l[La]+=cc*Db}for(La=0;La<
b.SBMAX_s;La++)for(var ub=0;3>ub;ub++)cc=ca.thm[0].s[La][ub],Mb=ca.thm[1].s[La][ub],ca.thm[0].s[La][ub]+=Mb*Db,ca.thm[1].s[La][ub]+=cc*Db}}if(a.mode==oa.JOINT_STEREO){for(var Wa,ka=0;ka<b.SBMAX_l;ka++)if(!(q.thm[0].l[ka]>1.58*q.thm[1].l[ka]||q.thm[1].l[ka]>1.58*q.thm[0].l[ka])){var Za=q.mld_l[ka]*q.en[3].l[ka],vb=Math.max(q.thm[2].l[ka],Math.min(q.thm[3].l[ka],Za)),Za=q.mld_l[ka]*q.en[2].l[ka],rc=Math.max(q.thm[3].l[ka],Math.min(q.thm[2].l[ka],Za));q.thm[2].l[ka]=vb;q.thm[3].l[ka]=rc}for(ka=0;ka<
b.SBMAX_s;ka++)for(var wa=0;3>wa;wa++)q.thm[0].s[ka][wa]>1.58*q.thm[1].s[ka][wa]||q.thm[1].s[ka][wa]>1.58*q.thm[0].s[ka][wa]||(Za=q.mld_s[ka]*q.en[3].s[ka][wa],vb=Math.max(q.thm[2].s[ka][wa],Math.min(q.thm[3].s[ka][wa],Za)),Za=q.mld_s[ka]*q.en[2].s[ka][wa],rc=Math.max(q.thm[3].s[ka][wa],Math.min(q.thm[2].s[ka][wa],Za)),q.thm[2].s[ka][wa]=vb,q.thm[3].s[ka][wa]=rc);Wa=a.msfix;if(0<Math.abs(Wa)){for(var Nb=Wa,lc=Nb,dc=Math.pow(10,a.ATHlower*q.ATH.adjust),Nb=2*Nb,lc=2*lc,Aa=0;Aa<b.SBMAX_l;Aa++){var Vb,
Ra,Ia,db;db=q.ATH.cb_l[q.bm_l[Aa]]*dc;Vb=Math.min(Math.max(q.thm[0].l[Aa],db),Math.max(q.thm[1].l[Aa],db));Ra=Math.max(q.thm[2].l[Aa],db);Ia=Math.max(q.thm[3].l[Aa],db);if(Vb*Nb<Ra+Ia){var ec=Vb*lc/(Ra+Ia);Ra*=ec;Ia*=ec}q.thm[2].l[Aa]=Math.min(Ra,q.thm[2].l[Aa]);q.thm[3].l[Aa]=Math.min(Ia,q.thm[3].l[Aa])}dc*=b.BLKSIZE_s/b.BLKSIZE;for(Aa=0;Aa<b.SBMAX_s;Aa++)for(var xa=0;3>xa;xa++)db=q.ATH.cb_s[q.bm_s[Aa]]*dc,Vb=Math.min(Math.max(q.thm[0].s[Aa][xa],db),Math.max(q.thm[1].s[Aa][xa],db)),Ra=Math.max(q.thm[2].s[Aa][xa],
db),Ia=Math.max(q.thm[3].s[Aa][xa],db),Vb*Nb<Ra+Ia&&(ec=Vb*Nb/(Ra+Ia),Ra*=ec,Ia*=ec),q.thm[2].s[Aa][xa]=Math.min(q.thm[2].s[Aa][xa],Ra),q.thm[3].s[Aa][xa]=Math.min(q.thm[3].s[Aa][xa],Ia)}}var lb=a.internal_flags;a.short_blocks!=la.short_block_coupled||0!=aa[0]&&0!=aa[1]||(aa[0]=aa[1]=0);for(var Na=0;Na<lb.channels_out;Na++)z[Na]=b.NORM_TYPE,a.short_blocks==la.short_block_dispensed&&(aa[Na]=1),a.short_blocks==la.short_block_forced&&(aa[Na]=0),0!=aa[Na]?lb.blocktype_old[Na]==b.SHORT_TYPE&&(z[Na]=b.STOP_TYPE):
(z[Na]=b.SHORT_TYPE,lb.blocktype_old[Na]==b.NORM_TYPE&&(lb.blocktype_old[Na]=b.START_TYPE),lb.blocktype_old[Na]==b.STOP_TYPE&&(lb.blocktype_old[Na]=b.SHORT_TYPE)),r[Na]=lb.blocktype_old[Na],lb.blocktype_old[Na]=z[Na];for(Q=0;Q<J;Q++){var Wb,mb=0,ea,Eb;if(1<Q){Wb=p;mb=-2;ea=b.NORM_TYPE;if(r[0]==b.SHORT_TYPE||r[1]==b.SHORT_TYPE)ea=b.SHORT_TYPE;Eb=v[e][Q-2]}else Wb=h,mb=0,ea=r[Q],Eb=f[e][Q];Wb[mb+Q]=ea==b.SHORT_TYPE?W(Eb,q.masking_lower):g(Eb,q.masking_lower);a.analysis&&(q.pinfo.pe[e][Q]=Wb[mb+Q])}return 0};
var D=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_vbr=function(c,l,e,f,k,v,h,p,q,C){for(var w=c.internal_flags,y,G,B=L(b.HBLKSIZE),z=ta([3,b.HBLKSIZE_s]),aa=ta([2,b.BLKSIZE]),N=ta([2,3,b.BLKSIZE_s]),J=ta([4,b.CBANDS]),H=ta([4,b.CBANDS]),Q=ta([4,3]),K=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],M=Y(2),T=c.mode==oa.JOINT_STEREO?4:w.channels_out,Z=ta([2,576]),fa=c.internal_flags,ha=fa.channels_out,ga=c.mode==oa.JOINT_STEREO?
4:ha,P=0;P<ha;P++){firbuf=l[P];for(var da=e+576-350-21+192,O=0;576>O;O++){var ra,pa;ra=firbuf[da+O+10];for(var Ha=pa=0;9>Ha;Ha+=2)ra+=D[Ha]*(firbuf[da+O+Ha]+firbuf[da+O+21-Ha]),pa+=D[Ha+1]*(firbuf[da+O+Ha+1]+firbuf[da+O+21-Ha-1]);Z[P][O]=ra+pa}k[f][P].en.assign(fa.en[P]);k[f][P].thm.assign(fa.thm[P]);2<ga&&(v[f][P].en.assign(fa.en[P+2]),v[f][P].thm.assign(fa.thm[P+2]))}for(P=0;P<ga;P++){var Sa=L(12),ia=L(12),Oa=[0,0,0,0],Ca=Z[P&1],sa=0,Qa=3==P?fa.nsPsy.attackthre_s:fa.nsPsy.attackthre,Fa=1;if(2==
P)for(O=0,Ha=576;0<Ha;++O,--Ha){var cb=Z[0][O],va=Z[1][O];Z[0][O]=cb+va;Z[1][O]=cb-va}for(O=0;3>O;O++)ia[O]=fa.nsPsy.last_en_subshort[P][O+6],Sa[O]=ia[O]/fa.nsPsy.last_en_subshort[P][O+4],Oa[0]+=ia[O];for(O=0;9>O;O++){for(var gb=sa+64,hb=1;sa<gb;sa++)hb<Math.abs(Ca[sa])&&(hb=Math.abs(Ca[sa]));fa.nsPsy.last_en_subshort[P][O]=ia[O+3]=hb;Oa[1+O/3]+=hb;hb=hb>ia[O+3-2]?hb/ia[O+3-2]:ia[O+3-2]>10*hb?ia[O+3-2]/(10*hb):0;Sa[O+3]=hb}for(O=0;3>O;++O){var fb=ia[3*O+3]+ia[3*O+4]+ia[3*O+5],$a=1;6*ia[3*O+5]<fb&&
($a*=.5,6*ia[3*O+4]<fb&&($a*=.5));Q[P][O]=$a}if(c.analysis){for(var ob=Sa[0],O=1;12>O;O++)ob<Sa[O]&&(ob=Sa[O]);fa.pinfo.ers[f][P]=fa.pinfo.ers_save[P];fa.pinfo.ers_save[P]=ob}for(O=0;12>O;O++)0==K[P][O/3]&&Sa[O]>Qa&&(K[P][O/3]=O%3+1);for(O=1;4>O;O++){var Ib=Oa[O-1],wb=Oa[O];4E4>Math.max(Ib,wb)&&Ib<1.7*wb&&wb<1.7*Ib&&(1==O&&K[P][0]<=K[P][O]&&(K[P][0]=0),K[P][O]=0)}K[P][0]<=fa.nsPsy.lastAttacks[P]&&(K[P][0]=0);if(3==fa.nsPsy.lastAttacks[P]||0!=K[P][0]+K[P][1]+K[P][2]+K[P][3])Fa=0,0!=K[P][1]&&0!=K[P][0]&&
(K[P][1]=0),0!=K[P][2]&&0!=K[P][1]&&(K[P][2]=0),0!=K[P][3]&&0!=K[P][2]&&(K[P][3]=0);2>P?M[P]=Fa:0==Fa&&(M[0]=M[1]=0);q[P]=fa.tot_ener[P]}var Ta=c.internal_flags;c.short_blocks!=la.short_block_coupled||0!=M[0]&&0!=M[1]||(M[0]=M[1]=0);for(var Pb=0;Pb<Ta.channels_out;Pb++)c.short_blocks==la.short_block_dispensed&&(M[Pb]=1),c.short_blocks==la.short_block_forced&&(M[Pb]=0);for(var R=0;R<T;R++){var Pa=R&1;y=aa;var Qb=c,Ua=R,xb=f,Ya=B,Va=y,pb=Pa,Ja=Qb.internal_flags;if(2>Ua)x.fft_long(Ja,Va[pb],Ua,l,e);
else if(2==Ua)for(var za=b.BLKSIZE-1;0<=za;--za){var Gb=Va[pb+0][za],ab=Va[pb+1][za];Va[pb+0][za]=(Gb+ab)*X.SQRT2*.5;Va[pb+1][za]=(Gb-ab)*X.SQRT2*.5}Ya[0]=Va[pb+0][0];Ya[0]*=Ya[0];for(za=b.BLKSIZE/2-1;0<=za;--za){var ja=Va[pb+0][b.BLKSIZE/2-za],Rb=Va[pb+0][b.BLKSIZE/2+za];Ya[b.BLKSIZE/2-za]=.5*(ja*ja+Rb*Rb)}for(var Jb=0,za=11;za<b.HBLKSIZE;za++)Jb+=Ya[za];Ja.tot_ener[Ua]=Jb;if(Qb.analysis){for(za=0;za<b.HBLKSIZE;za++)Ja.pinfo.energy[xb][Ua][za]=Ja.pinfo.energy_save[Ua][za],Ja.pinfo.energy_save[Ua][za]=
Ya[za];Ja.pinfo.pe[xb][Ua]=Ja.pe[Ua]}var Ka=R,ac=B,Bb=c.internal_flags;2==c.athaa_loudapprox&&2>Ka&&(Bb.loudness_sq[f][Ka]=Bb.loudness_sq_save[Ka],Bb.loudness_sq_save[Ka]=u(ac,Bb));if(0!=M[Pa]){var Da=w,pc=B,Ba=J[R],ib=H[R],jb=R,Sb=L(b.CBANDS),Kb=L(b.CBANDS),bc=Y(b.CBANDS+2),ba=void 0;d(Da,pc,Ba,Sb,Kb);n(Da,Sb,Kb,bc);for(var qb=0,ba=0;ba<Da.npart_l;ba++){var qa,bb,kc,jc,kb=Da.s3ind[ba][0],qc=Da.s3ind[ba][1],rb=0,Cb=0,rb=bc[kb],Cb=Cb+1;bb=Da.s3_ll[qb]*Ba[kb]*t[bc[kb]];++qb;for(++kb;kb<=qc;)rb+=bc[kb],
Cb+=1,qa=Da.s3_ll[qb]*Ba[kb]*t[bc[kb]],bb=jc=r(bb,qa,kb-ba),++qb,++kb;rb=(1+2*rb)/(2*Cb);kc=.5*t[rb];bb*=kc;if(Da.blocktype_old[jb&1]==b.SHORT_TYPE){var Tb=2*Da.nb_1[jb][ba];ib[ba]=0<Tb?Math.min(bb,Tb):Math.min(bb,.3*Ba[ba])}else{var Lb=16*Da.nb_2[jb][ba],sb=2*Da.nb_1[jb][ba];0>=Lb&&(Lb=bb);0>=sb&&(sb=bb);Tb=Da.blocktype_old[jb&1]==b.NORM_TYPE?Math.min(sb,Lb):sb;ib[ba]=Math.min(bb,Tb)}Da.nb_2[jb][ba]=Da.nb_1[jb][ba];Da.nb_1[jb][ba]=bb;qa=Sb[ba];qa*=Da.minval_l[ba];qa*=kc;ib[ba]>qa&&(ib[ba]=qa);1<
Da.masking_lower&&(ib[ba]*=Da.masking_lower);ib[ba]>Ba[ba]&&(ib[ba]=Ba[ba]);1>Da.masking_lower&&(ib[ba]*=Da.masking_lower)}for(;ba<b.CBANDS;++ba)Ba[ba]=0,ib[ba]=0}else for(var Ub=w,tb=R,Db=0;Db<Ub.npart_l;Db++)Ub.nb_2[tb][Db]=Ub.nb_1[tb][Db],Ub.nb_1[tb][Db]=0}2==M[0]+M[1]&&c.mode==oa.JOINT_STEREO&&a(J,H,w.mld_cb_l,w.ATH.cb_l,c.ATHlower*w.ATH.adjust,c.msfix,w.npart_l);for(R=0;R<T;R++)Pa=R&1,0!=M[Pa]&&A(w,J[R],H[R],R);for(var ca=0;3>ca;ca++){for(R=0;R<T;++R)if(Pa=R&1,0!=M[Pa]){var La=w,cc=R;if(0==ca)for(var Mb=
0;Mb<La.npart_s;Mb++)La.nb_s2[cc][Mb]=La.nb_s1[cc][Mb],La.nb_s1[cc][Mb]=0}else{G=N;var ub=R,Wa=ca,ka=z,Za=G,vb=Pa,rc=c.internal_flags;0==Wa&&2>ub&&x.fft_short(rc,Za[vb],ub,l,e);if(2==ub)for(var wa=b.BLKSIZE_s-1;0<=wa;--wa){var Nb=Za[vb+0][Wa][wa],lc=Za[vb+1][Wa][wa];Za[vb+0][Wa][wa]=(Nb+lc)*X.SQRT2*.5;Za[vb+1][Wa][wa]=(Nb-lc)*X.SQRT2*.5}ka[Wa][0]=Za[vb+0][Wa][0];ka[Wa][0]*=ka[Wa][0];for(wa=b.BLKSIZE_s/2-1;0<=wa;--wa){var dc=Za[vb+0][Wa][b.BLKSIZE_s/2-wa],Aa=Za[vb+0][Wa][b.BLKSIZE_s/2+wa];ka[Wa][b.BLKSIZE_s/
2-wa]=.5*(dc*dc+Aa*Aa)}for(var Vb=z,Ra=J[R],Ia=H[R],db=R,ec=ca,xa=c.internal_flags,lb=new float[b.CBANDS],Na=L(b.CBANDS),Wb=void 0,mb=void 0,ea=void 0,Eb=new int[b.CBANDS],ea=mb=0;ea<xa.npart_s;++ea){for(var Hb=0,Zb=0,ic=xa.numlines_s[ea],Wb=0;Wb<ic;++Wb,++mb){var $b=Vb[ec][mb],Hb=Hb+$b;Zb<$b&&(Zb=$b)}Ra[ea]=Hb;lb[ea]=Zb;Na[ea]=Hb/ic}for(;ea<b.CBANDS;++ea)lb[ea]=0,Na[ea]=0;var Xb=xa,yb=lb,fc=Na,mc=Eb,nc=t.length-1,na=0,Xa=fc[na]+fc[na+1];if(0<Xa){var nb=yb[na];nb<yb[na+1]&&(nb=yb[na+1]);var Xa=20*
(2*nb-Xa)/(Xa*(Xb.numlines_s[na]+Xb.numlines_s[na+1]-1)),zb=0|Xa;zb>nc&&(zb=nc);mc[na]=zb}else mc[na]=0;for(na=1;na<Xb.npart_s-1;na++)Xa=fc[na-1]+fc[na]+fc[na+1],0<Xa?(nb=yb[na-1],nb<yb[na]&&(nb=yb[na]),nb<yb[na+1]&&(nb=yb[na+1]),Xa=20*(3*nb-Xa)/(Xa*(Xb.numlines_s[na-1]+Xb.numlines_s[na]+Xb.numlines_s[na+1]-1)),zb=0|Xa,zb>nc&&(zb=nc),mc[na]=zb):mc[na]=0;Xa=fc[na-1]+fc[na];0<Xa?(nb=yb[na-1],nb<yb[na]&&(nb=yb[na]),Xa=20*(2*nb-Xa)/(Xa*(Xb.numlines_s[na-1]+Xb.numlines_s[na]-1)),zb=0|Xa,zb>nc&&(zb=nc),
mc[na]=zb):mc[na]=0;for(mb=ea=0;ea<xa.npart_s;ea++){var Fb=xa.s3ind_s[ea][0],uc=xa.s3ind_s[ea][1],oc,vc,Ob,gc,Bc;oc=Eb[Fb];vc=1;gc=xa.s3_ss[mb]*Ra[Fb]*t[Eb[Fb]];++mb;for(++Fb;Fb<=uc;)oc+=Eb[Fb],vc+=1,Ob=xa.s3_ss[mb]*Ra[Fb]*t[Eb[Fb]],gc=r(gc,Ob,Fb-ea),++mb,++Fb;oc=(1+2*oc)/(2*vc);Bc=.5*t[oc];gc*=Bc;Ia[ea]=gc;xa.nb_s2[db][ea]=xa.nb_s1[db][ea];xa.nb_s1[db][ea]=gc;Ob=lb[ea];Ob*=xa.minval_s[ea];Ob*=Bc;Ia[ea]>Ob&&(Ia[ea]=Ob);1<xa.masking_lower&&(Ia[ea]*=xa.masking_lower);Ia[ea]>Ra[ea]&&(Ia[ea]=Ra[ea]);
1>xa.masking_lower&&(Ia[ea]*=xa.masking_lower)}for(;ea<b.CBANDS;++ea)Ra[ea]=0,Ia[ea]=0}0==M[0]+M[1]&&c.mode==oa.JOINT_STEREO&&a(J,H,w.mld_cb_s,w.ATH.cb_s,c.ATHlower*w.ATH.adjust,c.msfix,w.npart_s);for(R=0;R<T;++R)Pa=R&1,0==M[Pa]&&E(w,J[R],H[R],R,ca)}for(R=0;R<T;R++)if(Pa=R&1,0==M[Pa])for(var hc=0;hc<b.SBMAX_s;hc++){for(var Dc=L(3),ca=0;3>ca;ca++){var eb=w.thm[R].s[hc][ca],eb=.8*eb;if(2<=K[R][ca]||1==K[R][ca+1])var sc=0!=ca?ca-1:2,tc=m(w.thm[R].s[hc][sc],eb,.36),eb=Math.min(eb,tc);else if(1==K[R][ca])sc=
0!=ca?ca-1:2,tc=m(w.thm[R].s[hc][sc],eb,.18),eb=Math.min(eb,tc);else if(0!=ca&&3==K[R][ca-1]||0==ca&&3==w.nsPsy.lastAttacks[R])sc=2!=ca?ca+1:0,tc=m(w.thm[R].s[hc][sc],eb,.18),eb=Math.min(eb,tc);eb*=Q[R][ca];Dc[ca]=eb}for(ca=0;3>ca;ca++)w.thm[R].s[hc][ca]=Dc[ca]}for(R=0;R<T;R++)w.nsPsy.lastAttacks[R]=K[R][2];for(var Yb=c.internal_flags,Ab=0;Ab<Yb.channels_out;Ab++){var Cc=b.NORM_TYPE;0!=M[Ab]?Yb.blocktype_old[Ab]==b.SHORT_TYPE&&(Cc=b.STOP_TYPE):(Cc=b.SHORT_TYPE,Yb.blocktype_old[Ab]==b.NORM_TYPE&&(Yb.blocktype_old[Ab]=
b.START_TYPE),Yb.blocktype_old[Ab]==b.STOP_TYPE&&(Yb.blocktype_old[Ab]=b.SHORT_TYPE));C[Ab]=Yb.blocktype_old[Ab];Yb.blocktype_old[Ab]=Cc}for(R=0;R<T;R++){var wc,xc,yc,zc;if(1<R){wc=p;xc=-2;yc=b.NORM_TYPE;if(C[0]==b.SHORT_TYPE||C[1]==b.SHORT_TYPE)yc=b.SHORT_TYPE;zc=v[f][R-2]}else wc=h,xc=0,yc=C[R],zc=k[f][R];wc[xc+R]=yc==b.SHORT_TYPE?W(zc,w.masking_lower):g(zc,w.masking_lower);c.analysis&&(w.pinfo.pe[f][R]=wc[xc+R])}return 0};this.psymodel_init=function(a){var d=a.internal_flags,l,e=!0,f=13,g=0,k=
0,v=-8.25,m=-4.5,q=L(b.CBANDS),t=L(b.CBANDS),C=L(b.CBANDS),r=a.out_samplerate;switch(a.experimentalZ){default:case 0:e=!0;break;case 1:e=a.VBR==H.vbr_mtrh||a.VBR==H.vbr_mt?!1:!0;break;case 2:e=!1;break;case 3:f=8,g=-1.75,k=-.0125,v=-8.25,m=-2.25}d.ms_ener_ratio_old=.25;d.blocktype_old[0]=d.blocktype_old[1]=b.NORM_TYPE;for(l=0;4>l;++l){for(var n=0;n<b.CBANDS;++n)d.nb_1[l][n]=1E20,d.nb_2[l][n]=1E20,d.nb_s1[l][n]=d.nb_s2[l][n]=1;for(var u=0;u<b.SBMAX_l;u++)d.en[l].l[u]=1E20,d.thm[l].l[u]=1E20;for(n=
0;3>n;++n){for(u=0;u<b.SBMAX_s;u++)d.en[l].s[u][n]=1E20,d.thm[l].s[u][n]=1E20;d.nsPsy.lastAttacks[l]=0}for(n=0;9>n;n++)d.nsPsy.last_en_subshort[l][n]=10}d.loudness_sq_save[0]=d.loudness_sq_save[1]=0;d.npart_l=h(d.numlines_l,d.bo_l,d.bm_l,q,t,d.mld_l,d.PSY.bo_l_weight,r,b.BLKSIZE,d.scalefac_band.l,b.BLKSIZE/1152,b.SBMAX_l);for(l=0;l<d.npart_l;l++)u=g,q[l]>=f&&(u=k*(q[l]-f)/(24-f)+g*(24-q[l])/(24-f)),C[l]=Math.pow(10,u/10),d.rnumlines_l[l]=0<d.numlines_l[l]?1/d.numlines_l[l]:0;d.s3_ll=p(d.s3ind,d.npart_l,
q,t,C,e);for(l=n=0;l<d.npart_l;l++){k=$a.MAX_VALUE;for(u=0;u<d.numlines_l[l];u++,n++)g=r*n/(1E3*b.BLKSIZE),g=this.ATHformula(1E3*g,a)-20,g=Math.pow(10,.1*g),g*=d.numlines_l[l],k>g&&(k=g);d.ATH.cb_l[l]=k;k=-20+20*q[l]/10;6<k&&(k=100);-15>k&&(k=-15);k-=8;d.minval_l[l]=Math.pow(10,k/10)*d.numlines_l[l]}d.npart_s=h(d.numlines_s,d.bo_s,d.bm_s,q,t,d.mld_s,d.PSY.bo_s_weight,r,b.BLKSIZE_s,d.scalefac_band.s,b.BLKSIZE_s/384,b.SBMAX_s);for(l=n=0;l<d.npart_s;l++){u=v;q[l]>=f&&(u=m*(q[l]-f)/(24-f)+v*(24-q[l])/
(24-f));C[l]=Math.pow(10,u/10);k=$a.MAX_VALUE;for(u=0;u<d.numlines_s[l];u++,n++)g=r*n/(1E3*b.BLKSIZE_s),g=this.ATHformula(1E3*g,a)-20,g=Math.pow(10,.1*g),g*=d.numlines_s[l],k>g&&(k=g);d.ATH.cb_s[l]=k;k=-7+7*q[l]/12;12<q[l]&&(k*=1+3.1*Math.log(1+k));12>q[l]&&(k*=1+2.3*Math.log(1-k));-15>k&&(k=-15);k-=8;d.minval_s[l]=Math.pow(10,k/10)*d.numlines_s[l]}d.s3_ss=p(d.s3ind_s,d.npart_s,q,t,C,e);w=Math.pow(10,.5625);z=Math.pow(10,1.5);y=Math.pow(10,1.5);x.init_fft(d);d.decay=Math.exp(-2.302585092994046/(.01*
r/192));l=3.5;0!=(a.exp_nspsytune&2)&&(l=1);0<Math.abs(a.msfix)&&(l=a.msfix);a.msfix=l;for(e=0;e<d.npart_l;e++)d.s3ind[e][1]>d.npart_l-1&&(d.s3ind[e][1]=d.npart_l-1);d.ATH.decay=Math.pow(10,576*d.mode_gr/r*-1.2);d.ATH.adjust=.01;d.ATH.adjustLimit=1;if(-1!=a.ATHtype){n=a.out_samplerate/b.BLKSIZE;for(l=g=e=0;l<b.BLKSIZE/2;++l)g+=n,d.ATH.eql_w[l]=1/Math.pow(10,this.ATHformula(g,a)/10),e+=d.ATH.eql_w[l];e=1/e;for(l=b.BLKSIZE/2;0<=--l;)d.ATH.eql_w[l]*=e}for(e=n=0;e<d.npart_s;++e)for(l=0;l<d.numlines_s[e];++l)++n;
for(e=n=0;e<d.npart_l;++e)for(l=0;l<d.numlines_l[e];++l)++n;for(l=n=0;l<d.npart_l;l++)g=r*(n+d.numlines_l[l]/2)/(1*b.BLKSIZE),d.mld_cb_l[l]=c(g),n+=d.numlines_l[l];for(;l<b.CBANDS;++l)d.mld_cb_l[l]=1;for(l=n=0;l<d.npart_s;l++)g=r*(n+d.numlines_s[l]/2)/(1*b.BLKSIZE_s),d.mld_cb_s[l]=c(g),n+=d.numlines_s[l];for(;l<b.CBANDS;++l)d.mld_cb_s[l]=1;return 0};this.ATHformula=function(a,b){var c;switch(b.ATHtype){case 0:c=f(a,9);break;case 1:c=f(a,-1);break;case 2:c=f(a,0);break;case 3:c=f(a,1)+6;break;case 4:c=
f(a,b.ATHcurve);break;default:c=f(a,0)}return c}}function W(){function V(){this.mask_adjust_short=this.mask_adjust=0;this.bo_l_weight=L(b.SBMAX_l);this.bo_s_weight=L(b.SBMAX_s)}function k(){this.lowerlimit=0}function r(a,b){this.lowpass=b}function E(a){return 1<a?0:0>=a?1:Math.cos(Math.PI/2*a)}function A(a,b){switch(a){case 44100:return b.version=1,0;case 48E3:return b.version=1;case 32E3:return b.version=1,2;case 22050:return b.version=0;case 24E3:return b.version=0,1;case 16E3:return b.version=
0,2;case 11025:return b.version=0;case 12E3:return b.version=0,1;case 8E3:return b.version=0,2;default:return b.version=0,-1}}function m(a,b,c){16E3>c&&(b=2);c=u.bitrate_table[b][1];for(var d=2;14>=d;d++)0<u.bitrate_table[b][d]&&Math.abs(u.bitrate_table[b][d]-a)<Math.abs(c-a)&&(c=u.bitrate_table[b][d]);return c}function T(a,b,c){16E3>c&&(b=2);for(c=0;14>=c;c++)if(0<u.bitrate_table[b][c]&&u.bitrate_table[b][c]==a)return c;return-1}function g(a,b){var c=[new r(8,2E3),new r(16,3700),new r(24,3900),new r(32,
5500),new r(40,7E3),new r(48,7500),new r(56,1E4),new r(64,11E3),new r(80,13500),new r(96,15100),new r(112,15600),new r(128,17E3),new r(160,17500),new r(192,18600),new r(224,19400),new r(256,19700),new r(320,20500)],d=h.nearestBitrateFullIndex(b);a.lowerlimit=c[d].lowpass}function d(a){var c=b.BLKSIZE+a.framesize-b.FFTOFFSET;return c=Math.max(c,512+a.framesize-32)}function n(l,f,g,k,m,q,t){var n=l.internal_flags,r=0,u,w,x=[null,null],y=[null,null];if(4294479419!=n.Class_ID)return-3;if(0==k)return 0;
u=c.copy_buffer(n,m,q,t,0);if(0>u)return u;q+=u;r+=u;y[0]=f;y[1]=g;if(ra.NEQ(l.scale,0)&&ra.NEQ(l.scale,1))for(u=0;u<k;++u)y[0][u]*=l.scale,2==n.channels_out&&(y[1][u]*=l.scale);if(ra.NEQ(l.scale_left,0)&&ra.NEQ(l.scale_left,1))for(u=0;u<k;++u)y[0][u]*=l.scale_left;if(ra.NEQ(l.scale_right,0)&&ra.NEQ(l.scale_right,1))for(u=0;u<k;++u)y[1][u]*=l.scale_right;if(2==l.num_channels&&1==n.channels_out)for(u=0;u<k;++u)y[0][u]=.5*(y[0][u]+y[1][u]),y[1][u]=0;f=d(l);x[0]=n.mfbuf[0];x[1]=n.mfbuf[1];for(g=0;0<
k;){var A=[null,null];u=w=0;A[0]=y[0];A[1]=y[1];u=new a;var z=l;w=x;var E=g,V=k,K=u,H=z.internal_flags;if(.9999>H.resample_ratio||1.0001<H.resample_ratio)for(var T=0;T<H.channels_out;T++){var W=new e,Y=K,X=w[T],ua=H.mf_size,oa=z.framesize,pa=A[T],ta=E,Q=V,Ga=W,M=T,Ma=z.internal_flags,Z=void 0,fa=0,ha=void 0,sa=z.out_samplerate/J(z.out_samplerate,z.in_samplerate);sa>ga.BPC&&(sa=ga.BPC);var P=1E-4>Math.abs(Ma.resample_ratio-Math.floor(.5+Ma.resample_ratio))?1:0,ha=1/Ma.resample_ratio;1<ha&&(ha=1);var la=
31;0==la%2&&--la;la+=P;P=la+1;if(0==Ma.fill_buffer_resample_init){Ma.inbuf_old[0]=L(P);Ma.inbuf_old[1]=L(P);for(Z=0;Z<=2*sa;++Z)Ma.blackfilt[Z]=L(P);Ma.itime[0]=0;for(fa=Ma.itime[1]=0;fa<=2*sa;fa++){for(var O=0,Ca=(fa-sa)/(2*sa),Z=0;Z<=la;Z++){var Fa=Ma.blackfilt[fa],Ha=Z,Sa,ia=Z-Ca;Sa=la;var Oa=Math.PI*ha,ia=ia/Sa;0>ia&&(ia=0);1<ia&&(ia=1);var Qa=ia-.5,ia=.42-.5*Math.cos(2*ia*Math.PI)+.08*Math.cos(4*ia*Math.PI);Sa=1E-9>Math.abs(Qa)?Oa/Math.PI:ia*Math.sin(Sa*Oa*Qa)/(Math.PI*Sa*Qa);O+=Fa[Ha]=Sa}for(Z=
0;Z<=la;Z++)Ma.blackfilt[fa][Z]/=O}Ma.fill_buffer_resample_init=1}O=Ma.inbuf_old[M];for(ha=0;ha<oa;ha++){Z=ha*Ma.resample_ratio;fa=0|Math.floor(Z-Ma.itime[M]);if(la+fa-la/2>=Q)break;Ca=Z-Ma.itime[M]-(fa+la%2*.5);Ca=0|Math.floor(2*Ca*sa+sa+.5);for(Z=Fa=0;Z<=la;++Z)Ha=Z+fa-la/2,Fa+=(0>Ha?O[P+Ha]:pa[ta+Ha])*Ma.blackfilt[Ca][Z];X[ua+ha]=Fa}Ga.num_used=Math.min(Q,la+fa-la/2);Ma.itime[M]+=Ga.num_used-ha*Ma.resample_ratio;if(Ga.num_used>=P)for(Z=0;Z<P;Z++)O[Z]=pa[ta+Ga.num_used+Z-P];else{X=P-Ga.num_used;
for(Z=0;Z<X;++Z)O[Z]=O[Z+Ga.num_used];for(fa=0;Z<P;++Z,++fa)O[Z]=pa[ta+fa]}Y.n_out=ha;K.n_in=W.num_used}else for(K.n_out=Math.min(z.framesize,V),K.n_in=K.n_out,z=0;z<K.n_out;++z)w[0][H.mf_size+z]=A[0][E+z],2==H.channels_out&&(w[1][H.mf_size+z]=A[1][E+z]);w=u.n_in;u=u.n_out;if(n.findReplayGain&&!n.decode_on_the_fly&&p.AnalyzeSamples(n.rgdata,x[0],n.mf_size,x[1],n.mf_size,u,n.channels_out)==da.GAIN_ANALYSIS_ERROR)return-6;k-=w;g+=w;n.mf_size+=u;1>n.mf_samples_to_encode&&(n.mf_samples_to_encode=b.ENCDELAY+
b.POSTDELAY);n.mf_samples_to_encode+=u;if(n.mf_size>=f){w=t-r;0==t&&(w=0);u=l;w=h.enc.lame_encode_mp3_frame(u,x[0],x[1],m,q,w);u.frameNum++;u=w;if(0>u)return u;q+=u;r+=u;n.mf_size-=l.framesize;n.mf_samples_to_encode-=l.framesize;for(w=0;w<n.channels_out;w++)for(u=0;u<n.mf_size;u++)x[w][u]=x[w][u+l.framesize]}}return r}function a(){this.n_out=this.n_in=0}function e(){this.num_used=0}function J(a,b){return 0!=b?J(b,a%b):a}var h=this;W.V9=410;W.V8=420;W.V7=430;W.V6=440;W.V5=450;W.V4=460;W.V3=470;W.V2=
480;W.V1=490;W.V0=500;W.R3MIX=1E3;W.STANDARD=1001;W.EXTREME=1002;W.INSANE=1003;W.STANDARD_FAST=1004;W.EXTREME_FAST=1005;W.MEDIUM=1006;W.MEDIUM_FAST=1007;W.LAME_MAXMP3BUFFER=147456;var p,c,f,x,q,w=new $b,z,y,t;this.enc=new b;this.setModules=function(a,b,d,e,g,k,h,m,n){p=a;c=b;f=d;x=e;q=g;z=k;y=m;t=n;this.enc.setModules(c,w,x,z)};this.lame_init=function(){var a=new Kc,c;a.class_id=4294479419;c=a.internal_flags=new ga;a.mode=oa.NOT_SET;a.original=1;a.in_samplerate=44100;a.num_channels=2;a.num_samples=
-1;a.bWriteVbrTag=!0;a.quality=-1;a.short_blocks=null;c.subblock_gain=-1;a.lowpassfreq=0;a.highpassfreq=0;a.lowpasswidth=-1;a.highpasswidth=-1;a.VBR=H.vbr_off;a.VBR_q=4;a.ATHcurve=-1;a.VBR_mean_bitrate_kbps=128;a.VBR_min_bitrate_kbps=0;a.VBR_max_bitrate_kbps=0;a.VBR_hard_min=0;c.VBR_min_bitrate=1;c.VBR_max_bitrate=13;a.quant_comp=-1;a.quant_comp_short=-1;a.msfix=-1;c.resample_ratio=1;c.OldValue[0]=180;c.OldValue[1]=180;c.CurrentStep[0]=4;c.CurrentStep[1]=4;c.masking_lower=1;c.nsPsy.attackthre=-1;
c.nsPsy.attackthre_s=-1;a.scale=-1;a.athaa_type=-1;a.ATHtype=-1;a.athaa_loudapprox=-1;a.athaa_sensitivity=0;a.useTemporal=null;a.interChRatio=-1;c.mf_samples_to_encode=b.ENCDELAY+b.POSTDELAY;a.encoder_padding=0;c.mf_size=b.ENCDELAY-b.MDCTDELAY;a.findReplayGain=!1;a.decode_on_the_fly=!1;c.decode_on_the_fly=!1;c.findReplayGain=!1;c.findPeakSample=!1;c.RadioGain=0;c.AudiophileGain=0;c.noclipGainChange=0;c.noclipScale=-1;a.preset=0;a.write_id3tag_automatic=!0;a.lame_allocated_gfp=1;return a};this.nearestBitrateFullIndex=
function(a){for(var b=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],c=0,d=0,e=0,f=0,f=b[16],e=16,d=b[16],c=16,g=0;16>g;g++)if(Math.max(a,b[g+1])!=a){f=b[g+1];e=g+1;d=b[g];c=g;break}return f-a>a-d?c:e};this.lame_init_params=function(a){var d=a.internal_flags;d.Class_ID=0;null==d.ATH&&(d.ATH=new Mc);null==d.PSY&&(d.PSY=new V);null==d.rgdata&&(d.rgdata=new Lc);d.channels_in=a.num_channels;1==d.channels_in&&(a.mode=oa.MONO);d.channels_out=a.mode==oa.MONO?1:2;d.mode_ext=b.MPG_MD_MS_LR;a.mode==
oa.MONO&&(a.force_ms=!1);a.VBR==H.vbr_off&&128!=a.VBR_mean_bitrate_kbps&&0==a.brate&&(a.brate=a.VBR_mean_bitrate_kbps);a.VBR!=H.vbr_off&&a.VBR!=H.vbr_mtrh&&a.VBR!=H.vbr_mt&&(a.free_format=!1);a.VBR==H.vbr_off&&0==a.brate&&ra.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025);a.VBR==H.vbr_off&&0<a.compression_ratio&&(0==a.out_samplerate&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|16*a.out_samplerate*d.channels_out/(1E3*a.compression_ratio),d.samplerate_index=A(a.out_samplerate,
a),a.free_format||(a.brate=m(a.brate,a.version,a.out_samplerate)));0!=a.out_samplerate&&(16E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):32E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320)));
if(0==a.lowpassfreq){var e=16E3;switch(a.VBR){case H.vbr_off:e=new k;g(e,a.brate);e=e.lowerlimit;break;case H.vbr_abr:e=new k;g(e,a.VBR_mean_bitrate_kbps);e=e.lowerlimit;break;case H.vbr_rh:var h=[19500,19E3,18600,18E3,17500,16E3,15600,14900,12500,1E4,3950];if(0<=a.VBR_q&&9>=a.VBR_q)var e=h[a.VBR_q],h=h[a.VBR_q+1],n=a.VBR_q_frac,e=linear_int(e,h,n);else e=19500;break;default:h=[19500,19E3,18500,18E3,17500,16500,15500,14500,12500,9500,3950],0<=a.VBR_q&&9>=a.VBR_q?(e=h[a.VBR_q],h=h[a.VBR_q+1],n=a.VBR_q_frac,
e=linear_int(e,h,n)):e=19500}a.mode!=oa.MONO||a.VBR!=H.vbr_off&&a.VBR!=H.vbr_abr||(e*=1.5);a.lowpassfreq=e|0}0==a.out_samplerate&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),e=a.lowpassfreq|0,h=a.in_samplerate,n=44100,48E3<=h?n=48E3:44100<=h?n=44100:32E3<=h?n=32E3:24E3<=h?n=24E3:22050<=h?n=22050:16E3<=h?n=16E3:12E3<=h?n=12E3:11025<=h?n=11025:8E3<=h&&(n=8E3),-1==e?e=n:(15960>=e&&(n=44100),15250>=e&&(n=32E3),11220>=e&&(n=24E3),9970>=e&&(n=22050),7230>=e&&(n=16E3),5420>=e&&(n=
12E3),4510>=e&&(n=11025),3970>=e&&(n=8E3),e=h<n?44100<h?48E3:32E3<h?44100:24E3<h?32E3:22050<h?24E3:16E3<h?22050:12E3<h?16E3:11025<h?12E3:8E3<h?11025:8E3:n),a.out_samplerate=e);a.lowpassfreq=Math.min(20500,a.lowpassfreq);a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq);a.VBR==H.vbr_off&&(a.compression_ratio=16*a.out_samplerate*d.channels_out/(1E3*a.brate));a.VBR==H.vbr_abr&&(a.compression_ratio=16*a.out_samplerate*d.channels_out/(1E3*a.VBR_mean_bitrate_kbps));a.bWriteVbrTag||(a.findReplayGain=
!1,a.decode_on_the_fly=!1,d.findPeakSample=!1);d.findReplayGain=a.findReplayGain;d.decode_on_the_fly=a.decode_on_the_fly;d.decode_on_the_fly&&(d.findPeakSample=!0);if(d.findReplayGain&&p.InitGainAnalysis(d.rgdata,a.out_samplerate)==da.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;d.decode_on_the_fly&&!a.decode_only&&(null!=d.hip&&t.hip_decode_exit(d.hip),d.hip=t.hip_decode_init());d.mode_gr=24E3>=a.out_samplerate?1:2;a.framesize=576*d.mode_gr;a.encoder_delay=b.ENCDELAY;d.resample_ratio=
a.in_samplerate/a.out_samplerate;switch(a.VBR){case H.vbr_mt:case H.vbr_rh:case H.vbr_mtrh:a.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][a.VBR_q];break;case H.vbr_abr:a.compression_ratio=16*a.out_samplerate*d.channels_out/(1E3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=16*a.out_samplerate*d.channels_out/(1E3*a.brate)}a.mode==oa.NOT_SET&&(a.mode=oa.JOINT_STEREO);0<a.highpassfreq?(d.highpass1=2*a.highpassfreq,d.highpass2=0<=a.highpasswidth?2*(a.highpassfreq+a.highpasswidth):
2*a.highpassfreq,d.highpass1/=a.out_samplerate,d.highpass2/=a.out_samplerate):(d.highpass1=0,d.highpass2=0);0<a.lowpassfreq?(d.lowpass2=2*a.lowpassfreq,0<=a.lowpasswidth?(d.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),0>d.lowpass1&&(d.lowpass1=0)):d.lowpass1=2*a.lowpassfreq,d.lowpass1/=a.out_samplerate,d.lowpass2/=a.out_samplerate):(d.lowpass1=0,d.lowpass2=0);var e=a.internal_flags,r=32,N=-1;if(0<e.lowpass1){for(var D=999,h=0;31>=h;h++)n=h/31,n>=e.lowpass2&&(r=Math.min(r,h)),e.lowpass1<n&&n<e.lowpass2&&
(D=Math.min(D,h));e.lowpass1=999==D?(r-.75)/31:(D-.75)/31;e.lowpass2=r/31}0<e.highpass2&&e.highpass2<.75/31*.9&&(e.highpass1=0,e.highpass2=0,K.err.println("Warning: highpass filter disabled.  highpass frequency too small\n"));if(0<e.highpass2){r=-1;for(h=0;31>=h;h++)n=h/31,n<=e.highpass1&&(N=Math.max(N,h)),e.highpass1<n&&n<e.highpass2&&(r=Math.max(r,h));e.highpass1=N/31;e.highpass2=-1==r?(N+.75)/31:(r+.75)/31}for(h=0;32>h;h++)n=h/31,N=e.highpass2>e.highpass1?E((e.highpass2-n)/(e.highpass2-e.highpass1+
1E-20)):1,n=e.lowpass2>e.lowpass1?E((n-e.lowpass1)/(e.lowpass2-e.lowpass1+1E-20)):1,e.amp_filter[h]=N*n;d.samplerate_index=A(a.out_samplerate,a);if(0>d.samplerate_index)return a.internal_flags=null,-1;if(a.VBR==H.vbr_off)if(a.free_format)d.bitrate_index=0;else{if(a.brate=m(a.brate,a.version,a.out_samplerate),d.bitrate_index=T(a.brate,a.version,a.out_samplerate),0>=d.bitrate_index)return a.internal_flags=null,-1}else d.bitrate_index=1;a.analysis&&(a.bWriteVbrTag=!1);null!=d.pinfo&&(a.bWriteVbrTag=
!1);c.init_bit_stream_w(d);e=d.samplerate_index+3*a.version+6*(16E3>a.out_samplerate?1:0);for(h=0;h<b.SBMAX_l+1;h++)d.scalefac_band.l[h]=x.sfBandIndex[e].l[h];for(h=0;h<b.PSFB21+1;h++)n=(d.scalefac_band.l[22]-d.scalefac_band.l[21])/b.PSFB21,n=d.scalefac_band.l[21]+h*n,d.scalefac_band.psfb21[h]=n;d.scalefac_band.psfb21[b.PSFB21]=576;for(h=0;h<b.SBMAX_s+1;h++)d.scalefac_band.s[h]=x.sfBandIndex[e].s[h];for(h=0;h<b.PSFB12+1;h++)n=(d.scalefac_band.s[13]-d.scalefac_band.s[12])/b.PSFB12,n=d.scalefac_band.s[12]+
h*n,d.scalefac_band.psfb12[h]=n;d.scalefac_band.psfb12[b.PSFB12]=192;d.sideinfo_len=1==a.version?1==d.channels_out?21:36:1==d.channels_out?13:21;a.error_protection&&(d.sideinfo_len+=2);e=a.internal_flags;a.frameNum=0;a.write_id3tag_automatic&&y.id3tag_write_v2(a);e.bitrate_stereoMode_Hist=fb([16,5]);e.bitrate_blockType_Hist=fb([16,6]);e.PeakSample=0;a.bWriteVbrTag&&z.InitVbrTag(a);d.Class_ID=4294479419;for(e=0;19>e;e++)d.nsPsy.pefirbuf[e]=700*d.mode_gr*d.channels_out;-1==a.ATHtype&&(a.ATHtype=4);
switch(a.VBR){case H.vbr_mt:a.VBR=H.vbr_mtrh;case H.vbr_mtrh:null==a.useTemporal&&(a.useTemporal=!1);f.apply_preset(a,500-10*a.VBR_q,0);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);5>a.quality&&(a.quality=0);5<a.quality&&(a.quality=5);d.PSY.mask_adjust=a.maskingadjust;d.PSY.mask_adjust_short=a.maskingadjust_short;d.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;d.iteration_loop=new VBRNewIterationLoop(q);break;case H.vbr_rh:f.apply_preset(a,500-10*a.VBR_q,0);d.PSY.mask_adjust=a.maskingadjust;
d.PSY.mask_adjust_short=a.maskingadjust_short;d.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;6<a.quality&&(a.quality=6);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);d.iteration_loop=new VBROldIterationLoop(q);break;default:d.sfb21_extra=!1,0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY),e=a.VBR,e==H.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),f.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=e,d.PSY.mask_adjust=a.maskingadjust,d.PSY.mask_adjust_short=a.maskingadjust_short,d.iteration_loop=e==
H.vbr_off?new Nc(q):new ABRIterationLoop(q)}if(a.VBR!=H.vbr_off){d.VBR_min_bitrate=1;d.VBR_max_bitrate=14;16E3>a.out_samplerate&&(d.VBR_max_bitrate=8);if(0!=a.VBR_min_bitrate_kbps&&(a.VBR_min_bitrate_kbps=m(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),d.VBR_min_bitrate=T(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),0>d.VBR_min_bitrate)||0!=a.VBR_max_bitrate_kbps&&(a.VBR_max_bitrate_kbps=m(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),d.VBR_max_bitrate=T(a.VBR_max_bitrate_kbps,a.version,
a.out_samplerate),0>d.VBR_max_bitrate))return-1;a.VBR_min_bitrate_kbps=u.bitrate_table[a.version][d.VBR_min_bitrate];a.VBR_max_bitrate_kbps=u.bitrate_table[a.version][d.VBR_max_bitrate];a.VBR_mean_bitrate_kbps=Math.min(u.bitrate_table[a.version][d.VBR_max_bitrate],a.VBR_mean_bitrate_kbps);a.VBR_mean_bitrate_kbps=Math.max(u.bitrate_table[a.version][d.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}a.tune&&(d.PSY.mask_adjust+=a.tune_value_a,d.PSY.mask_adjust_short+=a.tune_value_a);e=a.internal_flags;switch(a.quality){default:case 9:e.psymodel=
0;e.noise_shaping=0;e.noise_shaping_amp=0;e.noise_shaping_stop=0;e.use_best_huffman=0;e.full_outer_loop=0;break;case 8:a.quality=7;case 7:e.psymodel=1;e.noise_shaping=0;e.noise_shaping_amp=0;e.noise_shaping_stop=0;e.use_best_huffman=0;e.full_outer_loop=0;break;case 6:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=0;e.full_outer_loop=0;break;case 5:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=
1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=0;e.full_outer_loop=0;break;case 4:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=0;e.noise_shaping_stop=0;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 3:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);e.noise_shaping_amp=1;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=
0;break;case 2:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);0==e.substep_shaping&&(e.substep_shaping=2);e.noise_shaping_amp=1;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 1:e.psymodel=1;0==e.noise_shaping&&(e.noise_shaping=1);0==e.substep_shaping&&(e.substep_shaping=2);e.noise_shaping_amp=2;e.noise_shaping_stop=1;-1==e.subblock_gain&&(e.subblock_gain=1);e.use_best_huffman=1;e.full_outer_loop=0;break;case 0:e.psymodel=1,
0==e.noise_shaping&&(e.noise_shaping=1),0==e.substep_shaping&&(e.substep_shaping=2),e.noise_shaping_amp=2,e.noise_shaping_stop=1,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0}d.ATH.useAdjust=0>a.athaa_type?3:a.athaa_type;d.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10);null==a.short_blocks&&(a.short_blocks=la.short_block_allowed);a.short_blocks!=la.short_block_allowed||a.mode!=oa.JOINT_STEREO&&a.mode!=oa.STEREO||(a.short_blocks=la.short_block_coupled);
0>a.quant_comp&&(a.quant_comp=1);0>a.quant_comp_short&&(a.quant_comp_short=0);0>a.msfix&&(a.msfix=0);a.exp_nspsytune|=1;0>a.internal_flags.nsPsy.attackthre&&(a.internal_flags.nsPsy.attackthre=$b.NSATTACKTHRE);0>a.internal_flags.nsPsy.attackthre_s&&(a.internal_flags.nsPsy.attackthre_s=$b.NSATTACKTHRE_S);0>a.scale&&(a.scale=1);0>a.ATHtype&&(a.ATHtype=4);0>a.ATHcurve&&(a.ATHcurve=4);0>a.athaa_loudapprox&&(a.athaa_loudapprox=2);0>a.interChRatio&&(a.interChRatio=0);null==a.useTemporal&&(a.useTemporal=
!0);d.slot_lag=d.frac_SpF=0;a.VBR==H.vbr_off&&(d.slot_lag=d.frac_SpF=72E3*(a.version+1)*a.brate%a.out_samplerate|0);x.iteration_init(a);w.psymodel_init(a);return 0};this.lame_encode_flush=function(a,e,f,g){var h=a.internal_flags,k=uc([2,1152]),m=0,n,p,q=h.mf_samples_to_encode-b.POSTDELAY,t=d(a);if(1>h.mf_samples_to_encode)return 0;n=0;a.in_samplerate!=a.out_samplerate&&(q+=16*a.out_samplerate/a.in_samplerate);p=a.framesize-q%a.framesize;576>p&&(p+=a.framesize);a.encoder_padding=p;for(p=(q+p)/a.framesize;0<
p&&0<=m;){var r=t-h.mf_size,q=a.frameNum,r=r*a.in_samplerate,r=r/a.out_samplerate;1152<r&&(r=1152);1>r&&(r=1);m=g-n;0==g&&(m=0);m=this.lame_encode_buffer(a,k[0],k[1],r,e,f,m);f+=m;n+=m;p-=q!=a.frameNum?1:0}h.mf_samples_to_encode=0;if(0>m)return m;m=g-n;0==g&&(m=0);c.flush_bitstream(a);m=c.copy_buffer(h,e,f,m,1);if(0>m)return m;f+=m;n+=m;m=g-n;0==g&&(m=0);if(a.write_id3tag_automatic){y.id3tag_write_v1(a);m=c.copy_buffer(h,e,f,m,0);if(0>m)return m;n+=m}return n};this.lame_encode_buffer=function(a,b,
c,d,e,f,g){var h=a.internal_flags,k=[null,null];if(4294479419!=h.Class_ID)return-3;if(0==d)return 0;if(null==h.in_buffer_0||h.in_buffer_nsamples<d)h.in_buffer_0=L(d),h.in_buffer_1=L(d),h.in_buffer_nsamples=d;k[0]=h.in_buffer_0;k[1]=h.in_buffer_1;for(var m=0;m<d;m++)k[0][m]=b[m],1<h.channels_in&&(k[1][m]=c[m]);return n(a,k[0],k[1],d,e,f,g)}}function Tc(){this.setModules=function(b,k){}}function Uc(){this.setModules=function(b,k,r){}}function Vc(){}function Wc(){this.setModules=function(b,k){}}function sa(){this.sampleRate=
this.channels=this.dataLen=this.dataOffset=0}function Zb(b){return b.charCodeAt(0)<<24|b.charCodeAt(1)<<16|b.charCodeAt(2)<<8|b.charCodeAt(3)}var Qa={fill:function(b,k,r,u){if(2==arguments.length)for(var A=0;A<b.length;A++)b[A]=arguments[1];else for(A=k;A<r;A++)b[A]=u}},K={arraycopy:function(b,k,r,u,A){for(A=k+A;k<A;)r[u++]=b[k++]}},X={SQRT2:1.4142135623730951,FAST_LOG10:function(b){return Math.log10(b)},FAST_LOG10_X:function(b,k){return Math.log10(b)*k}};la.short_block_allowed=new la(0);la.short_block_coupled=
new la(1);la.short_block_dispensed=new la(2);la.short_block_forced=new la(3);var $a={MAX_VALUE:3.4028235E38};H.vbr_off=new H(0);H.vbr_mt=new H(1);H.vbr_rh=new H(2);H.vbr_abr=new H(3);H.vbr_mtrh=new H(4);H.vbr_default=H.vbr_mtrh;oa.STEREO=new oa(0);oa.JOINT_STEREO=new oa(1);oa.DUAL_CHANNEL=new oa(2);oa.MONO=new oa(3);oa.NOT_SET=new oa(4);da.STEPS_per_dB=100;da.MAX_dB=120;da.GAIN_NOT_ENOUGH_SAMPLES=-24601;da.GAIN_ANALYSIS_ERROR=0;da.GAIN_ANALYSIS_OK=1;da.INIT_GAIN_ANALYSIS_ERROR=0;da.INIT_GAIN_ANALYSIS_OK=
1;da.YULE_ORDER=10;da.MAX_ORDER=da.YULE_ORDER;ra.EQ=function(b,k){return Math.abs(b)>Math.abs(k)?Math.abs(b-k)<=1E-6*Math.abs(b):Math.abs(b-k)<=1E-6*Math.abs(k)};ra.NEQ=function(b,k){return!ra.EQ(b,k)};ob.NUMTOCENTRIES=100;ob.MAXFRAMESIZE=2880;var u={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,
12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,
6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,
90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,
122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,
70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,
30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,
379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,
281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,
361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,
11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],
t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,
13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,
12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,
13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,
12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,
13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,
14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,
10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};u.ht=[new T(0,
0,null,null),new T(2,0,u.t1HB,u.t1l),new T(3,0,u.t2HB,u.t2l),new T(3,0,u.t3HB,u.t3l),new T(0,0,null,null),new T(4,0,u.t5HB,u.t5l),new T(4,0,u.t6HB,u.t6l),new T(6,0,u.t7HB,u.t7l),new T(6,0,u.t8HB,u.t8l),new T(6,0,u.t9HB,u.t9l),new T(8,0,u.t10HB,u.t10l),new T(8,0,u.t11HB,u.t11l),new T(8,0,u.t12HB,u.t12l),new T(16,0,u.t13HB,u.t13l),new T(0,0,null,u.t16_5l),new T(16,0,u.t15HB,u.t15l),new T(1,1,u.t16HB,u.t16l),new T(2,3,u.t16HB,u.t16l),new T(3,7,u.t16HB,u.t16l),new T(4,15,u.t16HB,u.t16l),new T(6,63,u.t16HB,
u.t16l),new T(8,255,u.t16HB,u.t16l),new T(10,1023,u.t16HB,u.t16l),new T(13,8191,u.t16HB,u.t16l),new T(4,15,u.t24HB,u.t24l),new T(5,31,u.t24HB,u.t24l),new T(6,63,u.t24HB,u.t24l),new T(7,127,u.t24HB,u.t24l),new T(8,255,u.t24HB,u.t24l),new T(9,511,u.t24HB,u.t24l),new T(11,2047,u.t24HB,u.t24l),new T(13,8191,u.t24HB,u.t24l),new T(0,0,u.t32HB,u.t32l),new T(0,0,u.t33HB,u.t33l)];u.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,
393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,
917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,
786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,
1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];u.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];u.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];u.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,
128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];u.samplerate_table=[[22050,24E3,16E3,-1],[44100,48E3,32E3,-1],[11025,12E3,8E3,-1]];u.scfsi_band=[0,6,11,16,21];var Ca={};Ca.SFBMAX=3*b.SBMAX_s;b.ENCDELAY=576;b.POSTDELAY=1152;b.MDCTDELAY=48;b.FFTOFFSET=224+b.MDCTDELAY;b.DECDELAY=528;b.SBLIMIT=32;b.CBANDS=64;b.SBPSY_l=21;b.SBPSY_s=12;b.SBMAX_l=22;b.SBMAX_s=13;b.PSFB21=6;b.PSFB12=6;b.BLKSIZE=1024;b.HBLKSIZE=b.BLKSIZE/2+1;b.BLKSIZE_s=256;b.HBLKSIZE_s=b.BLKSIZE_s/2+1;b.NORM_TYPE=
0;b.START_TYPE=1;b.SHORT_TYPE=2;b.STOP_TYPE=3;b.MPG_MD_LR_LR=0;b.MPG_MD_LR_I=1;b.MPG_MD_MS_LR=2;b.MPG_MD_MS_I=3;b.fircoef=[-.1039435,-.1892065,-.0432472*5,-.155915,3.898045E-17,.0467745*5,.50455,.756825,.187098*5];ga.MFSIZE=3456+b.ENCDELAY-b.MDCTDELAY;ga.MAX_HEADER_BUF=256;ga.MAX_BITS_PER_CHANNEL=4095;ga.MAX_BITS_PER_GRANULE=7680;ga.BPC=320;pa.Q_MAX=257;pa.Q_MAX2=116;pa.LARGE_BITS=1E5;pa.IXMAX_VAL=8206;sa.RIFF=Zb("RIFF");sa.WAVE=Zb("WAVE");sa.fmt_=Zb("fmt ");sa.data=Zb("data");sa.readHeader=function(b){var k=
new sa,r=b.getUint32(0,!1);if(sa.RIFF==r&&(b.getUint32(4,!0),sa.WAVE==b.getUint32(8,!1)&&sa.fmt_==b.getUint32(12,!1))){var u=b.getUint32(16,!0),A=20;switch(u){case 16:case 18:k.channels=b.getUint16(A+2,!0);k.sampleRate=b.getUint32(A+4,!0);break;default:throw"extended fmt chunk not implemented";}for(var A=A+u,u=sa.data,m=0;u!=r;){r=b.getUint32(A,!1);m=b.getUint32(A+4,!0);if(u==r)break;A+=m+8}k.dataLen=m;k.dataOffset=A+8;return k}};Ca.SFBMAX=3*b.SBMAX_s;this.Mp3Encoder=function(b,k,r){3!=arguments.length&&
(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),b=1,k=44100,r=128);var u=new W,A=new Tc,m=new da,H=new ra,g=new Fc,d=new pa,n=new Jc,a=new ob,e=new Ec,J=new Wc,h=new Gc,p=new wb,c=new Uc,f=new Vc;u.setModules(m,H,g,d,n,a,e,J,f);H.setModules(m,f,e,a);J.setModules(H,e);g.setModules(u);n.setModules(H,h,d,p);d.setModules(p,h,u.enc.psy);h.setModules(H);p.setModules(d);a.setModules(u,H,e);A.setModules(c,f);c.setModules(e,J,g);var x=u.lame_init();x.num_channels=b;x.in_samplerate=
k;x.brate=r;x.mode=oa.STEREO;x.quality=3;x.bWriteVbrTag=!1;x.disable_reservoir=!0;x.write_id3tag_automatic=!1;u.lame_init_params(x);var q=1152,w=0|1.25*q+7200,z=new Int8Array(w);this.encodeBuffer=function(a,c){1==b&&(c=a);a.length>q&&(q=a.length,w=0|1.25*q+7200,z=new Int8Array(w));var d=u.lame_encode_buffer(x,a,c,a.length,z,0,w);return z.subarray(0,d)};this.flush=function(){var a=u.lame_encode_flush(x,z,0,w);return z.subarray(0,a)}};this.WavHeader=sa};
